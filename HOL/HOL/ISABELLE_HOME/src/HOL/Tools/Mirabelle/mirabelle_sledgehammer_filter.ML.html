<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>File ‹Tools/Mirabelle/mirabelle_sledgehammer_filter.ML›</title>
</head>


<body>
<div class="head">
<h1>File ‹Tools/Mirabelle/mirabelle_sledgehammer_filter.ML›</h1>
</div>

<pre class="source"><span class="comment1"><span>(*  Title:      HOL/Tools/Mirabelle/mirabelle_sledgehammer_filter.ML
    Author:     Jasmin Blanchette, TU Munich
    Author:     Makarius
    Author:     Martin Desharnais, UniBw Munich

Mirabelle action: "sledgehammer_filter".
*)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Mirabelle_Sledgehammer_Filter</span></span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>MIRABELLE_ACTION</span></span><span> </span><span class="main"><span>=</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="entity"><span>default_value</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>AList.lookup</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
    </span><span>SOME</span><span> </span><span class="entity"><span>value</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Value.parse_real</span><span> </span><span class="entity"><span>value</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>default_value</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>extract_relevance_fudge</span></span><span> </span><span class="entity"><span>args</span></span><span>
      </span><span class="main"><span>{</span></span><span class="entity"><span>local_const_multiplier</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>worse_irrel_freq</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>higher_order_irrel_weight</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>abs_rel_weight</span></span><span class="main"><span>,</span></span><span>
       </span><span class="entity"><span>abs_irrel_weight</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>theory_const_rel_weight</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>theory_const_irrel_weight</span></span><span class="main"><span>,</span></span><span>
       </span><span class="entity"><span>chained_const_irrel_weight</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>intro_bonus</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>elim_bonus</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>simp_bonus</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>local_bonus</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>assum_bonus</span></span><span class="main"><span>,</span></span><span>
       </span><span class="entity"><span>chained_bonus</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>max_imperfect</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>max_imperfect_exp</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>threshold_divisor</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ridiculous_threshold</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>{</span></span><span>local_const_multiplier</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"local_const_multiplier"</span></span><span> </span><span class="entity"><span>local_const_multiplier</span></span><span class="main"><span>,</span></span><span>
   </span><span>worse_irrel_freq</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"worse_irrel_freq"</span></span><span> </span><span class="entity"><span>worse_irrel_freq</span></span><span class="main"><span>,</span></span><span>
   </span><span>higher_order_irrel_weight</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"higher_order_irrel_weight"</span></span><span> </span><span class="entity"><span>higher_order_irrel_weight</span></span><span class="main"><span>,</span></span><span>
   </span><span>abs_rel_weight</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"abs_rel_weight"</span></span><span> </span><span class="entity"><span>abs_rel_weight</span></span><span class="main"><span>,</span></span><span>
   </span><span>abs_irrel_weight</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"abs_irrel_weight"</span></span><span> </span><span class="entity"><span>abs_irrel_weight</span></span><span class="main"><span>,</span></span><span>
   </span><span>theory_const_rel_weight</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"theory_const_rel_weight"</span></span><span> </span><span class="entity"><span>theory_const_rel_weight</span></span><span class="main"><span>,</span></span><span>
   </span><span>theory_const_irrel_weight</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"theory_const_irrel_weight"</span></span><span> </span><span class="entity"><span>theory_const_irrel_weight</span></span><span class="main"><span>,</span></span><span>
   </span><span>chained_const_irrel_weight</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"chained_const_irrel_weight"</span></span><span> </span><span class="entity"><span>chained_const_irrel_weight</span></span><span class="main"><span>,</span></span><span>
   </span><span>intro_bonus</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"intro_bonus"</span></span><span> </span><span class="entity"><span>intro_bonus</span></span><span class="main"><span>,</span></span><span>
   </span><span>elim_bonus</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"elim_bonus"</span></span><span> </span><span class="entity"><span>elim_bonus</span></span><span class="main"><span>,</span></span><span>
   </span><span>simp_bonus</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"simp_bonus"</span></span><span> </span><span class="entity"><span>simp_bonus</span></span><span class="main"><span>,</span></span><span>
   </span><span>local_bonus</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"local_bonus"</span></span><span> </span><span class="entity"><span>local_bonus</span></span><span class="main"><span>,</span></span><span>
   </span><span>assum_bonus</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"assum_bonus"</span></span><span> </span><span class="entity"><span>assum_bonus</span></span><span class="main"><span>,</span></span><span>
   </span><span>chained_bonus</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"chained_bonus"</span></span><span> </span><span class="entity"><span>chained_bonus</span></span><span class="main"><span>,</span></span><span>
   </span><span>max_imperfect</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"max_imperfect"</span></span><span> </span><span class="entity"><span>max_imperfect</span></span><span class="main"><span>,</span></span><span>
   </span><span>max_imperfect_exp</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"max_imperfect_exp"</span></span><span> </span><span class="entity"><span>max_imperfect_exp</span></span><span class="main"><span>,</span></span><span>
   </span><span>threshold_divisor</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"threshold_divisor"</span></span><span> </span><span class="entity"><span>threshold_divisor</span></span><span class="main"><span>,</span></span><span>
   </span><span>ridiculous_threshold</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"ridiculous_threshold"</span></span><span> </span><span class="entity"><span>ridiculous_threshold</span></span><span class="main"><span>}</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Prooftab</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Table</span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>key</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>int</span><span> * </span><span>int</span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ord</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prod_ord</span><span> </span><span>int_ord</span><span> </span><span>int_ord</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>print_int</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Value.print_int</span><span> </span><span class="main"><span>(</span></span><span>Synchronized.value</span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>percentage</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="inner_quoted"><span>"N/A"</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>Value.print_int</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span> </span><span>*</span><span> </span><span class="inner_numeral"><span>100</span></span><span> </span><span>div</span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>percentage_alt</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>percentage</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span> </span><span>+</span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>default_prover</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ATP_Proof.eN</span></span><span> </span><span class="comment1"><span>(* arbitrary ATP *)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>with_index</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>"@"</span></span><span> </span><span>^</span><span> </span><span>Value.print_int</span><span> </span><span class="entity"><span>i</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>proof_fileK</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"proof_file"</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>make_action</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="entity"><span>arguments</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Mirabelle.action_context</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>proof_table</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>pf_args</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>other_args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
          </span><span>List.partition</span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>proof_fileK</span></span><span> </span><span>o</span><span> </span><span>fst</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>arguments</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>proof_file</span></span><span> </span><span class="main"><span>=</span></span><span>
          </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>pf_args</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
            </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>error</span><span> </span><span class="inner_quoted"><span>"No \"proof_file\" specified"</span></span><span>
          </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span>::</span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>do_line</span></span><span> </span><span class="entity"><span>line</span></span><span> </span><span class="main"><span>=</span></span><span>
          </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>space_explode</span><span> </span><span class="inner_quoted"><span>":"</span></span><span> </span><span class="entity"><span>line</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
            </span><span class="main"><span>[</span></span><span class="entity"><span>line_num</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>offset</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>proof</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
              </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span>apply2</span><span> </span><span class="main"><span>(</span></span><span>the</span><span> </span><span>o</span><span> </span><span>Int.fromString</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>line_num</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>offset</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
                </span><span class="entity"><span>proof</span></span><span> </span><span>|&gt;</span><span> </span><span>space_explode</span><span> </span><span class="inner_quoted"><span>" "</span></span><span> </span><span>|&gt;</span><span> </span><span>filter_out</span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="inner_quoted"><span>""</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>NONE</span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>proof_table</span></span><span> </span><span class="main"><span>=</span></span><span>
          </span><span>File.read</span><span> </span><span class="main"><span>(</span></span><span>Path.explode</span><span> </span><span class="entity"><span>proof_file</span></span><span class="main"><span>)</span></span><span>
          </span><span>|&gt;</span><span> </span><span>space_explode</span><span> </span><span class="inner_quoted"><span>"\n"</span></span><span>
          </span><span>|&gt;</span><span> </span><span>map_filter</span><span> </span><span class="entity"><span>do_line</span></span><span>
          </span><span>|&gt;</span><span> </span><span>AList.coalesce</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span>
          </span><span>|&gt;</span><span> </span><span>Prooftab.make</span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>proof_table</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>other_args</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>num_successes</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Synchronized.var</span><span> </span><span class="inner_quoted"><span>"num_successes"</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>num_failures</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Synchronized.var</span><span> </span><span class="inner_quoted"><span>"num_failures"</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>num_found_proofs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Synchronized.var</span><span> </span><span class="inner_quoted"><span>"num_found_proofs"</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>num_lost_proofs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Synchronized.var</span><span> </span><span class="inner_quoted"><span>"num_lost_proofs"</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>num_found_facts</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Synchronized.var</span><span> </span><span class="inner_quoted"><span>"num_found_facts"</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>num_lost_facts</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Synchronized.var</span><span> </span><span class="inner_quoted"><span>"num_lost_facts"</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>run</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="entity"><span>pos</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>pre</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Mirabelle.command</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>results</span></span><span> </span><span class="main"><span>=</span></span><span>
          </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Position.line_of</span><span> </span><span class="entity"><span>pos</span></span><span class="main"><span>,</span></span><span> </span><span>Position.offset_of</span><span> </span><span class="entity"><span>pos</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
            </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span class="entity"><span>line_num</span></span><span class="main"><span>,</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>offset</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
              </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Prooftab.lookup</span><span> </span><span class="entity"><span>proof_table</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>line_num</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>offset</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
                </span><span>SOME</span><span> </span><span class="entity"><span>proofs</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
                  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.theory_of</span></span><span> </span><span class="entity"><span>pre</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>{</span></span><span>context</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>,</span></span><span> </span><span>facts</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>chained_ths</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>goal</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.goal</span></span><span> </span><span class="entity"><span>pre</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>prover</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>AList.lookup</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_quoted"><span>"prover"</span></span><span> </span><span>|&gt;</span><span> </span><span>the_default</span><span> </span><span class="entity"><span>default_prover</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>params</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span class="main"><span>{</span></span><span class="entity"><span>max_facts</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Sledgehammer_Commands.default_params</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>args</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>default_max_facts</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_numeral"><span>256</span></span><span> </span><span class="comment1"><span>(* FUDGE *)</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>relevance_fudge</span></span><span> </span><span class="main"><span>=</span></span><span>
                      </span><span class="entity"><span>extract_relevance_fudge</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>Sledgehammer_MePo.default_relevance_fudge</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>subgoal</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_numeral"><span>1</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>hyp_ts</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>concl_t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ATP_Util.strip_subgoal</span></span><span> </span><span class="entity"><span>goal</span></span><span> </span><span class="entity"><span>subgoal</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>keywords</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thy_Header.get_keywords'</span><span> </span><span class="entity"><span>ctxt</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>css_table</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Sledgehammer_Fact.clasimpset_rule_table_of</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>facts</span></span><span> </span><span class="main"><span>=</span></span><span>
                      </span><span class="entity"><span>Sledgehammer_Fact.nearly_all_facts</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>false</span><span>
                        </span><span class="entity"><span>Sledgehammer_Fact.no_fact_override</span></span><span> </span><span class="entity"><span>keywords</span></span><span> </span><span class="entity"><span>css_table</span></span><span> </span><span class="entity"><span>chained_ths</span></span><span>
                        </span><span class="entity"><span>hyp_ts</span></span><span> </span><span class="entity"><span>concl_t</span></span><span>
                      </span><span>|&gt;</span><span> </span><span class="entity"><span>Sledgehammer_Fact.drop_duplicate_facts</span></span><span>
                      </span><span>|&gt;</span><span> </span><span class="entity"><span>Sledgehammer_MePo.mepo_suggested_facts</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>params</span></span><span>
                          </span><span class="main"><span>(</span></span><span>the_default</span><span> </span><span class="entity"><span>default_max_facts</span></span><span> </span><span class="entity"><span>max_facts</span></span><span class="main"><span>)</span></span><span>
                          </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span class="entity"><span>relevance_fudge</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>hyp_ts</span></span><span> </span><span class="entity"><span>concl_t</span></span><span>
                      </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span>o</span><span> </span><span>fst</span><span class="main"><span>)</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>found_facts</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lost_facts</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
                      </span><span>flat</span><span> </span><span class="entity"><span>proofs</span></span><span> </span><span>|&gt;</span><span> </span><span>sort_distinct</span><span> </span><span>string_ord</span><span>
                      </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>fact</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span>find_index</span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>fact</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>facts</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>fact</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                      </span><span>|&gt;</span><span> </span><span>List.partition</span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span>&lt;=</span><span class="main"><span>)</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span> </span><span>o</span><span> </span><span>fst</span><span class="main"><span>)</span></span><span>
                      </span><span>|&gt;&gt;</span><span> </span><span>sort</span><span> </span><span class="main"><span>(</span></span><span>prod_ord</span><span> </span><span>int_ord</span><span> </span><span>string_ord</span><span class="main"><span>)</span></span><span> </span><span>||&gt;</span><span> </span><span>map</span><span> </span><span>snd</span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>found_proofs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>filter</span><span> </span><span class="main"><span>(</span></span><span>forall</span><span> </span><span class="main"><span>(</span></span><span>member</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>facts</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>proofs</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="entity"><span>found_proofs</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Int.div</span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Synchronized.change</span><span> </span><span class="entity"><span>num_failures</span></span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span>+</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>log1</span></span><span> </span><span class="main"><span>=</span></span><span>
                      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
                        </span><span class="main"><span>(</span></span><span>Synchronized.change</span><span> </span><span class="entity"><span>num_failures</span></span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span>+</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="inner_quoted"><span>"Failure"</span></span><span class="main"><span>)</span></span><span>
                      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
                        </span><span class="main"><span>(</span></span><span>Synchronized.change</span><span> </span><span class="entity"><span>num_successes</span></span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span>+</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
                         </span><span>Synchronized.change</span><span> </span><span class="entity"><span>num_found_proofs</span></span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span>+</span><span> </span><span class="entity"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
                         </span><span class="inner_quoted"><span>"Success ("</span></span><span> </span><span>^</span><span> </span><span>Value.print_int</span><span> </span><span class="entity"><span>n</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>" of "</span></span><span> </span><span>^</span><span>
                           </span><span>Value.print_int</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="entity"><span>proofs</span></span><span class="main"><span>)</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>" proofs)"</span></span><span class="main"><span>)</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Synchronized.change</span><span> </span><span class="entity"><span>num_lost_proofs</span></span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span>+</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="entity"><span>proofs</span></span><span> </span><span>-</span><span> </span><span class="entity"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Synchronized.change</span><span> </span><span class="entity"><span>num_found_facts</span></span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span>+</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="entity"><span>found_facts</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Synchronized.change</span><span> </span><span class="entity"><span>num_lost_facts</span></span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span>+</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="entity"><span>lost_facts</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>log2</span></span><span> </span><span class="main"><span>=</span></span><span>
                      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>null</span><span> </span><span class="entity"><span>found_facts</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
                        </span><span class="inner_quoted"><span>""</span></span><span>
                      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
                        </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
                          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>found_weight</span></span><span> </span><span class="main"><span>=</span></span><span>
                            </span><span>Real.fromInt</span><span> </span><span class="main"><span>(</span></span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Integer.add</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>n</span></span><span> </span><span>*</span><span> </span><span class="entity"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>found_facts</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span class="main"><span>)</span></span><span>
                              </span><span>/</span><span> </span><span>Real.fromInt</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="entity"><span>found_facts</span></span><span class="main"><span>)</span></span><span>
                            </span><span>|&gt;</span><span> </span><span>Math.sqrt</span><span> </span><span>|&gt;</span><span> </span><span>Real.ceil</span><span>
                        </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
                          </span><span class="inner_quoted"><span>"Found facts (among "</span></span><span> </span><span>^</span><span> </span><span>Value.print_int</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="entity"><span>facts</span></span><span class="main"><span>)</span></span><span> </span><span>^</span><span>
                          </span><span class="inner_quoted"><span>", weight "</span></span><span> </span><span>^</span><span> </span><span>Value.print_int</span><span> </span><span class="entity"><span>found_weight</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>"): "</span></span><span> </span><span>^</span><span>
                          </span><span>commas</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="entity"><span>with_index</span></span><span> </span><span class="entity"><span>found_facts</span></span><span class="main"><span>)</span></span><span>
                        </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
                    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>log3</span></span><span> </span><span class="main"><span>=</span></span><span>
                      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>null</span><span> </span><span class="entity"><span>lost_facts</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
                        </span><span class="inner_quoted"><span>""</span></span><span>
                      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
                        </span><span class="inner_quoted"><span>"Lost facts (among "</span></span><span> </span><span>^</span><span> </span><span>Value.print_int</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="entity"><span>facts</span></span><span class="main"><span>)</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>"): "</span></span><span> </span><span>^</span><span>
                         </span><span>commas</span><span> </span><span class="entity"><span>lost_facts</span></span><span>
                  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>cat_lines</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>log1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>log2</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>log3</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
              </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="inner_quoted"><span>"No known proof"</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="inner_quoted"><span>""</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
        </span><span class="entity"><span>results</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>finalize</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>Synchronized.value</span><span> </span><span class="entity"><span>num_successes</span></span><span> </span><span>+</span><span> </span><span>Synchronized.value</span><span> </span><span class="entity"><span>num_failures</span></span><span> </span><span>&gt;</span><span> </span><span class="inner_numeral"><span>0</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
        </span><span class="inner_quoted"><span>"\nNumber of overall successes: "</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>print_int</span></span><span> </span><span class="entity"><span>num_successes</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"\nNumber of overall failures: "</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>print_int</span></span><span> </span><span class="entity"><span>num_failures</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"\nOverall success rate: "</span></span><span> </span><span>^</span><span>
          </span><span class="entity"><span>percentage_alt</span></span><span> </span><span class="main"><span>(</span></span><span>Synchronized.value</span><span> </span><span class="entity"><span>num_successes</span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>(</span></span><span>Synchronized.value</span><span> </span><span class="entity"><span>num_failures</span></span><span class="main"><span>)</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>"%"</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"\nNumber of found proofs: "</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>print_int</span></span><span> </span><span class="entity"><span>num_found_proofs</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"\nNumber of lost proofs: "</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>print_int</span></span><span> </span><span class="entity"><span>num_lost_proofs</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"\nProof found rate: "</span></span><span> </span><span>^</span><span>
          </span><span class="entity"><span>percentage_alt</span></span><span> </span><span class="main"><span>(</span></span><span>Synchronized.value</span><span> </span><span class="entity"><span>num_found_proofs</span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>(</span></span><span>Synchronized.value</span><span> </span><span class="entity"><span>num_lost_proofs</span></span><span class="main"><span>)</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>"%"</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"\nNumber of found facts: "</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>print_int</span></span><span> </span><span class="entity"><span>num_found_facts</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"\nNumber of lost facts: "</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>print_int</span></span><span> </span><span class="entity"><span>num_lost_facts</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"\nFact found rate: "</span></span><span> </span><span>^</span><span>
          </span><span class="entity"><span>percentage_alt</span></span><span> </span><span class="main"><span>(</span></span><span>Synchronized.value</span><span> </span><span class="entity"><span>num_found_facts</span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>(</span></span><span>Synchronized.value</span><span> </span><span class="entity"><span>num_lost_facts</span></span><span class="main"><span>)</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>"%"</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
        </span><span class="inner_quoted"><span>""</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>""</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>{</span></span><span>run</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>run</span></span><span class="main"><span>,</span></span><span> </span><span>finalize</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>finalize</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Mirabelle.register_action</span></span><span> </span><span class="inner_quoted"><span>"sledgehammer_filter"</span></span><span> </span><span class="entity"><span>make_action</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>