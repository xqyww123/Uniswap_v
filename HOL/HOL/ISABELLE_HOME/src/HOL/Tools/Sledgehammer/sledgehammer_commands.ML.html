<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>File ‹Tools/Sledgehammer/sledgehammer_commands.ML›</title>
</head>


<body>
<div class="head">
<h1>File ‹Tools/Sledgehammer/sledgehammer_commands.ML›</h1>
</div>

<pre class="source"><span class="comment1"><span>(*  Title:      HOL/Tools/Sledgehammer/sledgehammer_commands.ML
    Author:     Jasmin Blanchette, TU Muenchen

Adds "sledgehammer" and related commands to Isabelle/Isar's outer syntax.
*)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>signature</span></span></span><span> </span><span class="entity"><span>SLEDGEHAMMER_COMMANDS</span></span><span> </span><span class="main"><span>=</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>sig</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>params</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Sledgehammer_Prover.params</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> provers </span><span class="main"><span>:</span></span><span> </span><span>string</span><span> </span><span>Unsynchronized.ref</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> default_params </span><span class="main"><span>:</span></span><span> </span><span>theory</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="main"><span>(</span></span><span>string</span><span> * </span><span>string</span><span class="main"><span>)</span></span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>params</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> parse_params</span><span class="main"><span>:</span></span><span> </span><span class="main"><span>(</span></span><span>string</span><span> * </span><span>string</span><span class="main"><span>)</span></span><span> </span><span>list</span><span> </span><span>parser</span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Sledgehammer_Commands</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>SLEDGEHAMMER_COMMANDS</span></span><span> </span><span class="main"><span>=</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>

</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>ATP_Util</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>ATP_Problem_Generate</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>ATP_Proof</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>ATP_Proof_Reconstruct</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Sledgehammer_Util</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Sledgehammer_Fact</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Sledgehammer_ATP_Systems</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Sledgehammer_Prover</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Sledgehammer_Prover_SMT</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Sledgehammer_Prover_Minimize</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Sledgehammer_MaSh</span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Sledgehammer</span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>runN</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"run"</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>supported_proversN</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"supported_provers"</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>refresh_tptpN</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"refresh_tptp"</span></span><span>

</span><span class="comment1"><span>(** Sledgehammer commands **)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>add_fact_override</span></span><span> </span><span class="entity"><span>ns</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>fact_override</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>add</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ns</span></span><span class="main"><span>,</span></span><span> </span><span>del</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span>only</span><span> </span><span class="main"><span>=</span></span><span> </span><span>false</span><span class="main"><span>}</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>del_fact_override</span></span><span> </span><span class="entity"><span>ns</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>fact_override</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>add</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span>del</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ns</span></span><span class="main"><span>,</span></span><span> </span><span>only</span><span> </span><span class="main"><span>=</span></span><span> </span><span>false</span><span class="main"><span>}</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>only_fact_override</span></span><span> </span><span class="entity"><span>ns</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>fact_override</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>add</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ns</span></span><span class="main"><span>,</span></span><span> </span><span>del</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span>only</span><span> </span><span class="main"><span>=</span></span><span> </span><span>true</span><span class="main"><span>}</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>merge_fact_override_pairwise</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>r1</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>fact_override</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>r2</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>fact_override</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>{</span></span><span>add</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>#</span></span><span>add</span><span> </span><span class="entity"><span>r1</span></span><span> </span><span>@</span><span> </span><span class="main"><span>#</span></span><span>add</span><span> </span><span class="entity"><span>r2</span></span><span class="main"><span>,</span></span><span> </span><span>del</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>#</span></span><span>del</span><span> </span><span class="entity"><span>r1</span></span><span> </span><span>@</span><span> </span><span class="main"><span>#</span></span><span>del</span><span> </span><span class="entity"><span>r2</span></span><span class="main"><span>,</span></span><span> </span><span>only</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>#</span></span><span>only</span><span> </span><span class="entity"><span>r1</span></span><span> </span><span class="keyword1"><span class="keyword"><span>andalso</span></span></span><span> </span><span class="main"><span>#</span></span><span>only</span><span> </span><span class="entity"><span>r2</span></span><span class="main"><span>}</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>merge_fact_overrides</span></span><span> </span><span class="entity"><span>rs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>fold</span><span> </span><span class="entity"><span>merge_fact_override_pairwise</span></span><span> </span><span class="entity"><span>rs</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>only_fact_override</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(*** parameters ***)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>provers</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Unsynchronized.ref</span><span> </span><span class="inner_quoted"><span>""</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>raw_param</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>string</span><span> * </span><span>string</span><span> </span><span>list</span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>default_default_params</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"debug"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"verbose"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"overlord"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"spy"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"type_enc"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"strict"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"lam_trans"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"uncurried_aliases"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"learn"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"true"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"fact_filter"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"induction_rules"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"max_facts"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"fact_thresholds"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"0.45 0.85"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"max_mono_iters"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"max_new_mono_instances"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"max_proofs"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"4"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"isar_proofs"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"compress"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"try0"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"true"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"smt_proofs"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"true"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"minimize"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"true"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"slices"</span></span><span class="main"><span>,</span></span><span> </span><span>string_of_int</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>12</span></span><span> </span><span>*</span><span> </span><span>Multithreading.max_threads</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"preplay_timeout"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"1"</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>alias_params</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"prover"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"provers"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="comment1"><span>(* undocumented *)</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"dont_preplay"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"preplay_timeout"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"0"</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"dont_compress"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"compress"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"1"</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"dont_slice"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"slices"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"1"</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"isar_proof"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"isar_proofs"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(* legacy *)</span></span><span class="main"><span>]</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>negated_alias_params</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"no_debug"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"debug"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"quiet"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"verbose"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"no_overlord"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"overlord"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"dont_spy"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"spy"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"non_strict"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"strict"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"no_uncurried_aliases"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"uncurried_aliases"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"dont_learn"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"learn"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"no_isar_proofs"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"isar_proofs"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"dont_minimize"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"minimize"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"dont_try0"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"try0"</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
   </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"no_smt_proofs"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"smt_proofs"</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>property_dependent_params</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"provers"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"timeout"</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>is_known_raw_param</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>AList.defined</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>default_default_params</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span>
  </span><span>AList.defined</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>alias_params</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span>
  </span><span>AList.defined</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>negated_alias_params</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span>
  </span><span>member</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>property_dependent_params</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"expect"</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>is_prover_list</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>space_explode</span><span> </span><span class="inner_quoted"><span>" "</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
    </span><span class="entity"><span>ss</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span>::</span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>forall</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>is_prover_supported</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ss</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>false</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>unalias_raw_param</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>value</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>AList.lookup</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>alias_params</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
    </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name'</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name'</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>value</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>param'</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name'</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>value</span></span><span> </span><span>&lt;&gt;</span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
      </span><span class="entity"><span>param'</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
      </span><span>error</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"Parameter "</span></span><span> </span><span>^</span><span> </span><span>quote</span><span> </span><span class="entity"><span>name</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>" cannot be set to \"false\" (cf. "</span></span><span> </span><span>^</span><span> </span><span>quote</span><span> </span><span class="entity"><span>name'</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>")"</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>AList.lookup</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>negated_alias_params</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
      </span><span>SOME</span><span> </span><span class="entity"><span>name'</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name'</span></span><span class="main"><span>,</span></span><span>
        </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>value</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
          </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"true"</span></span><span class="main"><span>]</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"true"</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>]</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>]</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>value</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>value</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>any_type_enc</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>type_enc_of_string</span></span><span> </span><span class="entity"><span>Strict</span></span><span> </span><span class="inner_quoted"><span>"erased"</span></span><span>

</span><span class="comment1"><span>(* "provers =", "type_enc =", "lam_trans =", "fact_filter =", and "max_facts ="
   can be omitted. For the last four, this is a secret feature. *)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>normalize_raw_param</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>unalias_raw_param</span></span><span>
  </span><span>#&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>value</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
         </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>is_known_raw_param</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
           </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>value</span></span><span class="main"><span>)</span></span><span>
         </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>null</span><span> </span><span class="entity"><span>value</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
           </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>is_prover_list</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
             </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"provers"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>name</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
           </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>can</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>type_enc_of_string</span></span><span> </span><span class="entity"><span>Strict</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
             </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"type_enc"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>name</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
           </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>can</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trans_lams_of_string</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>any_type_enc</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
             </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"lam_trans"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>name</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
           </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>member</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>fact_filters</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
             </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"fact_filter"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>name</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
           </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>is_some</span><span> </span><span class="main"><span>(</span></span><span>Int.fromString</span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
             </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"max_facts"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>name</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
           </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
             </span><span>error</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"Unknown parameter: "</span></span><span> </span><span>^</span><span> </span><span>quote</span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span>
         </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
           </span><span>error</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"Unknown parameter: "</span></span><span> </span><span>^</span><span> </span><span>quote</span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(* Ensures that type encodings such as "mono_native?" and "poly_guards!!" are
   read correctly. *)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>implode_param</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>strip_spaces_except_between_idents</span></span><span> </span><span>o</span><span> </span><span>space_implode</span><span> </span><span class="inner_quoted"><span>" "</span></span><span>

</span><span class="comment1"><span>(* FIXME: use "Generic_Data" *)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Data</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Theory_Data</span><span>
</span><span class="main"><span>(</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>T</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>raw_param</span></span><span> </span><span>list</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>empty</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>default_default_params</span></span><span> </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span>apsnd</span><span> </span><span>single</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>merge</span></span><span> </span><span class="entity"><span>data</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>T</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>AList.merge</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>true</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>data</span></span><span>
</span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(* The first ATP of the list is used by Auto Sledgehammer. *)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>default_provers_param_value</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="comment1"><span>― </span><span class="quoted"><span class="plain_text"><span>‹</span><span>see also </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">system_option</span><span class="hidden">&gt;</span></span></span><span>‹</span><span>sledgehammer_provers</span><span>›</span></span><span>›</span></span></span></span><span>
  </span><span>filter</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>is_prover_installed</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>smts</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>@</span><span> </span><span class="entity"><span>non_dummy_atps</span></span><span class="main"><span>)</span></span><span>
  </span><span>|&gt;</span><span> </span><span class="entity"><span>implode_param</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>set_default_raw_param</span></span><span> </span><span class="entity"><span>param</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Proof_Context.init_global</span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="entity"><span>thy</span></span><span> </span><span>|&gt;</span><span> </span><span>Data.map</span><span> </span><span class="main"><span>(</span></span><span>AList.update</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>normalize_raw_param</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>param</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>default_raw_params</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Proof_Context.init_global</span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span>Data.get</span><span> </span><span class="entity"><span>thy</span></span><span>
    </span><span>|&gt;</span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span>AList.default</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"provers"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>!</span><span class="entity"><span>provers</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span class="inner_quoted"><span>""</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>default_provers_param_value</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
        </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"timeout"</span></span><span class="main"><span>,</span></span><span>
         </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>timeout</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Options.default_int</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">system_option</span><span class="hidden">&gt;</span></span></span><span>‹</span><span>sledgehammer_timeout</span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
           </span><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>timeout</span></span><span> </span><span>&lt;=</span><span> </span><span class="inner_numeral"><span>0</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="inner_quoted"><span>"none"</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>string_of_int</span><span> </span><span class="entity"><span>timeout</span></span><span class="main"><span>]</span></span><span>
         </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>extract_params</span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="entity"><span>default_params</span></span><span> </span><span class="entity"><span>override_params</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>raw_params</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>rev</span><span> </span><span class="entity"><span>override_params</span></span><span> </span><span>@</span><span> </span><span>rev</span><span> </span><span class="entity"><span>default_params</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>lookup</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Option.map</span><span> </span><span class="entity"><span>implode_param</span></span><span> </span><span>o</span><span> </span><span>AList.lookup</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>raw_params</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>lookup_string</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>the_default</span><span> </span><span class="inner_quoted"><span>""</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>lookup</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>general_lookup_bool</span></span><span> </span><span class="entity"><span>option</span></span><span> </span><span class="entity"><span>default_value</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>lookup</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span>SOME</span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>parse_bool_option</span></span><span> </span><span class="entity"><span>option</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="entity"><span>s</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>default_value</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>the</span><span> </span><span>o</span><span> </span><span class="entity"><span>general_lookup_bool</span></span><span> </span><span>false</span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span>false</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>lookup_time</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>lookup</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span>SOME</span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>parse_time</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="entity"><span>s</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Time.zeroTime</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>lookup_int</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>lookup</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Int.fromString</span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
          </span><span>SOME</span><span> </span><span class="entity"><span>n</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>n</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>error</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"Parameter "</span></span><span> </span><span>^</span><span> </span><span>quote</span><span> </span><span class="entity"><span>name</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>" must be assigned an integer value"</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>lookup_real</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>lookup</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="inner_numeral"><span>0.0</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Real.fromString</span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
          </span><span>SOME</span><span> </span><span class="entity"><span>n</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>n</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>error</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"Parameter "</span></span><span> </span><span>^</span><span> </span><span>quote</span><span> </span><span class="entity"><span>name</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>" must be assigned a real value"</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>lookup_real_pair</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>lookup</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>0.0</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_numeral"><span>0.0</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span>|&gt;</span><span> </span><span>space_explode</span><span> </span><span class="inner_quoted"><span>" "</span></span><span> </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span>Real.fromString</span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
          </span><span class="main"><span>[</span></span><span>SOME</span><span> </span><span class="entity"><span>r1</span></span><span class="main"><span>,</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>r2</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>r1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r2</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>error</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"Parameter "</span></span><span> </span><span>^</span><span> </span><span>quote</span><span> </span><span class="entity"><span>name</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>" must be assigned a pair of floating-point \
                 \values (e.g., \"0.6 0.95\")"</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>lookup_option</span></span><span> </span><span class="entity"><span>lookup'</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>lookup</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span>SOME</span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>NONE</span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>lookup'</span></span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>debug</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span>&lt;&gt;</span><span> </span><span class="entity"><span>Auto_Try</span></span><span> </span><span class="keyword1"><span class="keyword"><span>andalso</span></span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"debug"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>verbose</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>debug</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>mode</span></span><span> </span><span>&lt;&gt;</span><span> </span><span class="entity"><span>Auto_Try</span></span><span> </span><span class="keyword1"><span class="keyword"><span>andalso</span></span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"verbose"</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>overlord</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"overlord"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>spy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>getenv</span><span> </span><span class="inner_quoted"><span>"SLEDGEHAMMER_SPY"</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"yes"</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"spy"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>provers</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_string</span></span><span> </span><span class="inner_quoted"><span>"provers"</span></span><span> </span><span>|&gt;</span><span> </span><span>space_explode</span><span> </span><span class="inner_quoted"><span>" "</span></span><span> </span><span>|&gt;</span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Auto_Try</span></span><span> </span><span>?</span><span> </span><span>single</span><span> </span><span>o</span><span> </span><span>hd</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>type_enc</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Auto_Try</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
        </span><span>NONE</span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
        </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>lookup_string</span></span><span> </span><span class="inner_quoted"><span>"type_enc"</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
          </span><span class="inner_quoted"><span>"smart"</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>NONE</span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>type_enc_of_string</span></span><span> </span><span class="entity"><span>Strict</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>strict</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Auto_Try</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"strict"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>lam_trans</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_option</span></span><span> </span><span class="entity"><span>lookup_string</span></span><span> </span><span class="inner_quoted"><span>"lam_trans"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>uncurried_aliases</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_option</span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"uncurried_aliases"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>learn</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"learn"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>fact_filter</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>lookup_option</span></span><span> </span><span class="entity"><span>lookup_string</span></span><span> </span><span class="inner_quoted"><span>"fact_filter"</span></span><span>
      </span><span>|&gt;</span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Auto_Try</span></span><span> </span><span>?</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>mepoN</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>sf</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>sf</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>induction_rules</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>lookup_option</span></span><span> </span><span class="main"><span>(</span></span><span>the</span><span> </span><span>o</span><span> </span><span class="entity"><span>induction_rules_of_string</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>lookup_string</span></span><span class="main"><span>)</span></span><span> </span><span class="inner_quoted"><span>"induction_rules"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>max_facts</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_option</span></span><span> </span><span class="entity"><span>lookup_int</span></span><span> </span><span class="inner_quoted"><span>"max_facts"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>fact_thresholds</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_real_pair</span></span><span> </span><span class="inner_quoted"><span>"fact_thresholds"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>max_mono_iters</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_option</span></span><span> </span><span class="entity"><span>lookup_int</span></span><span> </span><span class="inner_quoted"><span>"max_mono_iters"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>max_new_mono_instances</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>lookup_option</span></span><span> </span><span class="entity"><span>lookup_int</span></span><span> </span><span class="inner_quoted"><span>"max_new_mono_instances"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>max_proofs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_int</span></span><span> </span><span class="inner_quoted"><span>"max_proofs"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>isar_proofs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_option</span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"isar_proofs"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>compress</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Option.map</span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span>Real.max</span><span> </span><span class="inner_numeral"><span>1.0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>lookup_option</span></span><span> </span><span class="entity"><span>lookup_real</span></span><span> </span><span class="inner_quoted"><span>"compress"</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>try0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"try0"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>smt_proofs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"smt_proofs"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>minimize</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span>&lt;&gt;</span><span> </span><span class="entity"><span>Auto_Try</span></span><span> </span><span class="keyword1"><span class="keyword"><span>andalso</span></span></span><span> </span><span class="entity"><span>lookup_bool</span></span><span> </span><span class="inner_quoted"><span>"minimize"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>slices</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Auto_Try</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="inner_numeral"><span>1</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>Int.max</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lookup_int</span></span><span> </span><span class="inner_quoted"><span>"slices"</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>timeout</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_time</span></span><span> </span><span class="inner_quoted"><span>"timeout"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>preplay_timeout</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_time</span></span><span> </span><span class="inner_quoted"><span>"preplay_timeout"</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>expect</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup_string</span></span><span> </span><span class="inner_quoted"><span>"expect"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="main"><span>{</span></span><span>debug</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>debug</span></span><span class="main"><span>,</span></span><span> </span><span>verbose</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>verbose</span></span><span class="main"><span>,</span></span><span> </span><span>overlord</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>overlord</span></span><span class="main"><span>,</span></span><span> </span><span>spy</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>spy</span></span><span class="main"><span>,</span></span><span> </span><span>provers</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>provers</span></span><span class="main"><span>,</span></span><span>
     </span><span>type_enc</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>type_enc</span></span><span class="main"><span>,</span></span><span> </span><span>strict</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>strict</span></span><span class="main"><span>,</span></span><span> </span><span>lam_trans</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lam_trans</span></span><span class="main"><span>,</span></span><span>
     </span><span>uncurried_aliases</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>uncurried_aliases</span></span><span class="main"><span>,</span></span><span> </span><span>learn</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>learn</span></span><span class="main"><span>,</span></span><span> </span><span>fact_filter</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>fact_filter</span></span><span class="main"><span>,</span></span><span>
     </span><span>induction_rules</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>induction_rules</span></span><span class="main"><span>,</span></span><span> </span><span>max_facts</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>max_facts</span></span><span class="main"><span>,</span></span><span> </span><span>fact_thresholds</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>fact_thresholds</span></span><span class="main"><span>,</span></span><span>
     </span><span>max_mono_iters</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>max_mono_iters</span></span><span class="main"><span>,</span></span><span> </span><span>max_new_mono_instances</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>max_new_mono_instances</span></span><span class="main"><span>,</span></span><span>
     </span><span>max_proofs</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>max_proofs</span></span><span class="main"><span>,</span></span><span> </span><span>isar_proofs</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>isar_proofs</span></span><span class="main"><span>,</span></span><span> </span><span>compress</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>compress</span></span><span class="main"><span>,</span></span><span> </span><span>try0</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>try0</span></span><span class="main"><span>,</span></span><span>
     </span><span>smt_proofs</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>smt_proofs</span></span><span class="main"><span>,</span></span><span> </span><span>minimize</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>minimize</span></span><span class="main"><span>,</span></span><span> </span><span>slices</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>slices</span></span><span class="main"><span>,</span></span><span> </span><span>timeout</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>timeout</span></span><span class="main"><span>,</span></span><span>
     </span><span>preplay_timeout</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>preplay_timeout</span></span><span class="main"><span>,</span></span><span> </span><span>expect</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>expect</span></span><span class="main"><span>}</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>get_params</span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>extract_params</span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>default_raw_params</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>default_params</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get_params</span></span><span> </span><span class="entity"><span>Normal</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span>o</span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span>apsnd</span><span> </span><span>single</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>silence_state</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Proof.map_contexts</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Try0.silence_methods</span></span><span> </span><span>false</span><span> </span><span>#&gt;</span><span> </span><span>Config.put</span><span> </span><span class="entity"><span>SMT_Config.verbose</span></span><span> </span><span>false</span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(* Sledgehammer the given subgoal *)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>default_learn_prover_timeout</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_numeral"><span>2.0</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>hammer_away</span></span><span> </span><span class="entity"><span>override_params</span></span><span> </span><span class="entity"><span>writeln_result</span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="entity"><span>opt_i</span></span><span> </span><span class="entity"><span>fact_override</span></span><span> </span><span class="entity"><span>state0</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="comment1"><span>(* We generally want chained facts to be picked up by the relevance filter, because it can then
       give it a proper name, which is useful for a variety of reasons (minimization, Isar proofs,
       verbose output, machine learning). However, if the fact is available by no other means (not
       even backticks), as "f" would be in "using f unfolding f'" after unfolding, we have no choice
       but to insert it into the state as an additional hypothesis. *)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>{</span></span><span>facts</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>chained0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.goal</span></span><span> </span><span class="entity"><span>state0</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>inserts</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>keep_chained</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>null</span><span> </span><span class="entity"><span>chained0</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="main"><span>#</span></span><span>only</span><span> </span><span class="entity"><span>fact_override</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
        </span><span class="main"><span>(</span></span><span class="entity"><span>chained0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.context_of</span></span><span> </span><span class="entity"><span>state0</span></span><span> </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
          </span><span>List.partition</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>is_useful_unnamed_local_fact</span></span><span> </span><span class="entity"><span>ctxt0</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>chained0</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>state0</span></span><span>
      </span><span>|&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>null</span><span> </span><span class="entity"><span>inserts</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span>I</span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>Proof.refine_insert</span></span><span> </span><span class="entity"><span>inserts</span></span><span> </span><span>#&gt;</span><span> </span><span class="entity"><span>Proof.set_facts</span></span><span> </span><span class="entity"><span>keep_chained</span></span><span class="main"><span>)</span></span><span>
      </span><span>|&gt;</span><span> </span><span class="entity"><span>silence_state</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.theory_of</span></span><span> </span><span class="entity"><span>state</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.context_of</span></span><span> </span><span class="entity"><span>state</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>override_params</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>override_params</span></span><span> </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>normalize_raw_param</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>runN</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>the_default</span><span> </span><span class="inner_numeral"><span>1</span></span><span> </span><span class="entity"><span>opt_i</span></span><span> </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
        </span><span>ignore</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>run_sledgehammer</span></span><span>
          </span><span class="main"><span>(</span></span><span class="entity"><span>get_params</span></span><span> </span><span class="entity"><span>Normal</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>override_params</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>Normal</span></span><span> </span><span class="entity"><span>writeln_result</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>fact_override</span></span><span> </span><span class="entity"><span>state</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>supported_proversN</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
      </span><span class="entity"><span>supported_provers</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>unlearnN</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
      </span><span class="entity"><span>mash_unlearn</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>learn_isarN</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>learn_proverN</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span>
            </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>relearn_isarN</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>relearn_proverN</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>relearn_isarN</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>relearn_proverN</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>mash_unlearn</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
       </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
       </span><span class="entity"><span>mash_learn</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
           </span><span class="comment1"><span>(* TODO: Use MaSh mode instead and have the special defaults hardcoded in "get_params" *)</span></span><span>
           </span><span class="main"><span>(</span></span><span class="entity"><span>get_params</span></span><span> </span><span class="entity"><span>Normal</span></span><span> </span><span class="entity"><span>thy</span></span><span>
                </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"timeout"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span>string_of_real</span><span> </span><span class="entity"><span>default_learn_prover_timeout</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
                  </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"slice"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span>@</span><span>
                 </span><span class="entity"><span>override_params</span></span><span> </span><span>@</span><span>
                 </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"preplay_timeout"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"0"</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
           </span><span class="entity"><span>fact_override</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>#</span></span><span>facts</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Proof.goal</span></span><span> </span><span class="entity"><span>state</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
           </span><span class="main"><span>(</span></span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>learn_proverN</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>relearn_proverN</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>refresh_tptpN</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
      </span><span class="entity"><span>refresh_systems_on_tptp</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
      </span><span>error</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"Unknown subcommand: "</span></span><span> </span><span>^</span><span> </span><span>quote</span><span> </span><span class="entity"><span>subcommand</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>string_of_raw_param</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>key</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>values</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>key</span></span><span> </span><span>^</span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>implode_param</span></span><span> </span><span class="entity"><span>values</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span class="inner_quoted"><span>""</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="inner_quoted"><span>""</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>value</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="inner_quoted"><span>" = "</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>value</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>parse_query_bang</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>?</span></span><span>›</span></span></span><span> </span><span>||</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>!</span></span><span>›</span></span></span><span> </span><span>||</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>!!</span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>parse_key</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Scan.repeat1</span><span> </span><span class="main"><span>(</span></span><span>Parse.embedded</span><span> </span><span>||</span><span> </span><span class="entity"><span>parse_query_bang</span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>implode_param</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>parse_value</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Scan.repeat1</span><span> </span><span class="main"><span>(</span></span><span>Parse.name</span><span> </span><span>||</span><span> </span><span>Parse.float_number</span><span> </span><span>||</span><span> </span><span class="entity"><span>parse_query_bang</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>parse_param</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>parse_key</span></span><span> </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span class="entity"><span>parse_value</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>parse_raw_params</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span>Args.bracks</span><span> </span><span class="main"><span>(</span></span><span>Parse.list</span><span> </span><span class="entity"><span>parse_param</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>parse_params</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>parse_raw_params</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span>apsnd</span><span> </span><span class="entity"><span>implode_param</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>parse_fact_refs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Scan.repeat1</span><span> </span><span class="main"><span>(</span></span><span>Scan.unless</span><span> </span><span class="main"><span>(</span></span><span>Parse.name</span><span> </span><span>--</span><span> </span><span>Args.colon</span><span class="main"><span>)</span></span><span> </span><span>Parse.thm</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>parse_fact_override_chunk</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span>Args.add</span><span> </span><span>|--</span><span> </span><span>Args.colon</span><span> </span><span>|--</span><span> </span><span class="entity"><span>parse_fact_refs</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>add_fact_override</span></span><span class="main"><span>)</span></span><span>
  </span><span>||</span><span> </span><span class="main"><span>(</span></span><span>Args.add</span><span> </span><span>|--</span><span> </span><span>Args.colon</span><span> </span><span>|--</span><span> </span><span>Scan.succeed</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>add_fact_override</span></span><span class="main"><span>)</span></span><span>
  </span><span>||</span><span> </span><span class="main"><span>(</span></span><span>Args.del</span><span> </span><span>|--</span><span> </span><span>Args.colon</span><span> </span><span>|--</span><span> </span><span class="entity"><span>parse_fact_refs</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>del_fact_override</span></span><span class="main"><span>)</span></span><span>
  </span><span>||</span><span> </span><span class="main"><span>(</span></span><span>Args.del</span><span> </span><span>|--</span><span> </span><span>Args.colon</span><span> </span><span>|--</span><span> </span><span>Scan.succeed</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>del_fact_override</span></span><span class="main"><span>)</span></span><span>
  </span><span>||</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>parse_fact_refs</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>only_fact_override</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>parse_fact_override</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span>Args.parens</span><span> </span><span class="main"><span>(</span></span><span>Scan.repeat</span><span> </span><span class="entity"><span>parse_fact_override_chunk</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>merge_fact_overrides</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="entity"><span>no_fact_override</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>sledgehammer</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"search for first-order proof using automatic theorem provers"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.optional</span><span> </span><span>Parse.name</span><span> </span><span class="entity"><span>runN</span></span><span> </span><span>--</span><span> </span><span class="entity"><span>parse_raw_params</span></span><span>
      </span><span>--</span><span> </span><span class="entity"><span>parse_fact_override</span></span><span> </span><span>--</span><span> </span><span>Scan.option</span><span> </span><span>Parse.nat</span><span> </span><span>&gt;&gt;</span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>subcommand</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>params</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>fact_override</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>opt_i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Toplevel.keep_proof</span></span><span>
          </span><span class="main"><span>(</span></span><span class="entity"><span>hammer_away</span></span><span> </span><span class="entity"><span>params</span></span><span> </span><span>NONE</span><span> </span><span class="entity"><span>subcommand</span></span><span> </span><span class="entity"><span>opt_i</span></span><span> </span><span class="entity"><span>fact_override</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.proof_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>sledgehammer_params</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"set and display the default parameters for Sledgehammer"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>parse_raw_params</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>params</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span class="main"><span>(</span></span><span>fold</span><span> </span><span class="entity"><span>set_default_raw_param</span></span><span> </span><span class="entity"><span>params</span></span><span> </span><span>#&gt;</span><span> </span><span>tap</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span>writeln</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"Default parameters for Sledgehammer:\n"</span></span><span> </span><span>^</span><span>
          </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>rev</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>default_raw_params</span></span><span> </span><span class="entity"><span>thy</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
            </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="inner_quoted"><span>"none"</span></span><span>
          </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>params</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>params</span></span><span> </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="entity"><span>string_of_raw_param</span></span><span> </span><span>|&gt;</span><span> </span><span>sort_strings</span><span> </span><span>|&gt;</span><span> </span><span>cat_lines</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Try.tool_setup</span></span><span>
   </span><span class="main"><span>{</span></span><span>name</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>sledgehammerN</span></span><span class="main"><span>,</span></span><span> </span><span>weight</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_numeral"><span>40</span></span><span class="main"><span>,</span></span><span> </span><span>auto_option</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">system_option</span><span class="hidden">&gt;</span></span></span><span>‹</span><span>auto_sledgehammer</span><span>›</span></span></span><span class="main"><span>,</span></span><span>
    </span><span>body</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>auto</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.theory_of</span></span><span> </span><span class="entity"><span>state</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>auto</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>Auto_Try</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>Try</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_numeral"><span>1</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
        </span><span class="entity"><span>run_sledgehammer</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>get_params</span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span>NONE</span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>no_fact_override</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>silence_state</span></span><span> </span><span class="entity"><span>state</span></span><span class="main"><span>)</span></span><span>
        </span><span>|&gt;</span><span> </span><span>apsnd</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>map_prod</span></span><span> </span><span class="entity"><span>short_string_of_sledgehammer_outcome</span></span><span> </span><span>single</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>}</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Query_Operation.register</span></span><span> </span><span class="main"><span>{</span></span><span>name</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>sledgehammerN</span></span><span class="main"><span>,</span></span><span> </span><span>pri</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span class="main"><span>}</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>{</span></span><span>state</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>writeln_result</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>try</span><span> </span><span class="entity"><span>Toplevel.proof_of</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span>SOME</span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>provers_arg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>isar_proofs_arg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>try0_arg</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>args</span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>override_params</span></span><span> </span><span class="main"><span>=</span></span><span>
              </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>provers_arg</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>""</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"provers"</span></span><span class="main"><span>,</span></span><span> </span><span>space_explode</span><span> </span><span class="inner_quoted"><span>" "</span></span><span> </span><span class="entity"><span>provers_arg</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span>@</span><span>
                </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"isar_proofs"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>isar_proofs_arg</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"true"</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="inner_quoted"><span>"true"</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="inner_quoted"><span>"smart"</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
                 </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"try0"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>try0_arg</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
                 </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"debug"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
                 </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"verbose"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
                 </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"overlord"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"false"</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="entity"><span>hammer_away</span></span><span> </span><span class="entity"><span>override_params</span></span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span class="entity"><span>writeln_result</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>runN</span></span><span> </span><span>NONE</span><span> </span><span class="entity"><span>no_fact_override</span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>error</span><span> </span><span class="inner_quoted"><span>"Unknown proof context"</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span>
</span></pre>
</body>

</html>