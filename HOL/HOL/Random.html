<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Random</title>
</head>


<body>
<div class="head">
<h1>Theory Random</h1>
</div>

<pre class="source"><span class="comment1"><span>(</span><span>*</span><span> Author: Florian Haftmann, TU Muenchen </span><span>*</span><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>A HOL random engine</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Random.html"><span>Random</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="List.html"><span>List</span></a><span> </span><a href="Groups_List.html"><span>Groups_List</span></a><span> </span><a href="Code_Numeral.html"><span>Code_Numeral</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Auxiliary functions</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Random.log.elims|fact"><span class="entity_def" id="Random.log.induct|fact"><span class="entity_def" id="Random.log.simps|fact"><span class="entity_def" id="Random.log.pelims|fact"><span class="entity_def" id="Random.log.cases|fact"><span class="entity_def" id="Random.log.termination|fact"><span class="entity_def" id="Random.log.pinduct|fact"><span class="entity_def" id="Random.log.psimps|fact"><span class="entity_def" id="Random.log_rel.inducts|fact"><span class="entity_def" id="Random.log_rel.simps|fact"><span class="entity_def" id="Random.log_rel.induct|fact"><span class="entity_def" id="Random.log_rel.cases|fact"><span class="entity_def" id="Random.log_rel.intros|fact"><span class="entity_def" id="Random.log_graph.inducts|fact"><span class="entity_def" id="Random.log_graph.simps|fact"><span class="entity_def" id="Random.log_graph.induct|fact"><span class="entity_def" id="Random.log_graph.cases|fact"><span class="entity_def" id="Random.log_graph.intros|fact"><span class="entity_def" id="Random.log.elims|thm"><span class="entity_def" id="Random.log.induct|thm"><span class="entity_def" id="Random.log.simps|thm"><span class="entity_def" id="Random.log.pelims|thm"><span class="entity_def" id="Random.log.cases|thm"><span class="entity_def" id="Random.log.termination|thm"><span class="entity_def" id="Random.log.pinduct|thm"><span class="entity_def" id="Random.log.psimps|thm"><span class="entity_def" id="Random.log_rel.inducts|thm"><span class="entity_def" id="Random.log_rel.simps|thm"><span class="entity_def" id="Random.log_rel.induct|thm"><span class="entity_def" id="Random.log_rel.cases|thm"><span class="entity_def" id="Random.log_rel.intros|thm"><span class="entity_def" id="Random.log_graph.inducts|thm"><span class="entity_def" id="Random.log_graph.simps|thm"><span class="entity_def" id="Random.log_graph.induct|thm"><span class="entity_def" id="Random.log_graph.cases|thm"><span class="entity_def" id="Random.log_graph.intros|thm"><span class="entity_def" id="Random.log_def|axiom"><span class="entity_def" id="Random.log_rel_def|axiom"><span class="entity_def" id="Random.log_sumC_def|axiom"><span class="entity_def" id="Random.log_graph_def|axiom"><span class="entity_def" id="Random.log_dom|const"><span class="entity_def" id="Random.log_rel|const"><span class="entity_def" id="Random.log_sumC|const"><span class="entity_def" id="Random.log_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Random.log|const"><span>log</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>log</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span>log</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Random.inc_shift_def|fact"><span class="entity_def" id="Random.inc_shift_def|thm"><span class="entity_def" id="Random.inc_shift_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Random.inc_shift|const"><span>inc_shift</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>inc_shift</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Random.minus_shift_def|fact"><span class="entity_def" id="Random.minus_shift_def|thm"><span class="entity_def" id="Random.minus_shift_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Random.minus_shift|const"><span>minus_shift</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>minus_shift</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>r</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>r</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Random seeds</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>type_synonym</span></span></span><span> </span><span class="entity_def" id="Random.seed|type"><span>seed</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Random.next.simps|fact"><span class="entity_def" id="Random.next_def|fact"><span class="entity_def" id="Random.next.simps|thm"><span class="entity_def" id="Random.next_def|thm"><span class="entity_def" id="Random.next_def|axiom"><span>primrec</span></span></span></span></span></span></span></span><span> </span><span class="quoted"><span>"</span><span class="entity"><span class="entity_def" id="Random.next|const"><span>next</span></span></span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>next</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>w</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span>
     </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>53668</span></span><span class="main"><span>;</span></span><span>
     </span><span class="bound"><span>v'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Random.html#Random.minus_shift|const"><span>minus_shift</span></a><span> </span><span class="numeral"><span>2147483563</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="numeral"><span>53668</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>40014</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>12211</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
     </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="free"><span class="bound"><span class="entity"><span>w</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>52774</span></span><span class="main"><span>;</span></span><span>
     </span><span class="bound"><span>w'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Random.html#Random.minus_shift|const"><span>minus_shift</span></a><span> </span><span class="numeral"><span>2147483399</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>w</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="numeral"><span>52774</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>40692</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>3791</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
     </span><span class="bound"><span>z</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><a class="entity_ref" href="Random.html#Random.minus_shift|const"><span>minus_shift</span></a><span> </span><span class="numeral"><span>2147483562</span></span><span> </span><span class="bound"><span>v'</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>w'</span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>
   </span><span class="keyword1"><span>in</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>v'</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>w'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Random.split_seed_def|fact"><span class="entity_def" id="Random.split_seed_def|thm"><span class="entity_def" id="Random.split_seed_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Random.split_seed|const"><span>split_seed</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>split_seed</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span>
     </span><span class="main"><span>(</span></span><span class="bound"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>w</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>;</span></span><span>
     </span><span class="main"><span>(</span></span><span class="bound"><span>v'</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>w'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.next|const"><span>next</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
     </span><span class="bound"><span>v''</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Random.html#Random.inc_shift|const"><span>inc_shift</span></a><span> </span><span class="numeral"><span>2147483562</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>;</span></span><span>
     </span><span class="bound"><span>w''</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Random.html#Random.inc_shift|const"><span>inc_shift</span></a><span> </span><span class="numeral"><span>2147483398</span></span><span> </span><span class="bound"><span>w</span></span><span>
   </span><span class="keyword1"><span>in</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>v''</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>w'</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>v'</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>w''</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Base selectors</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>includes</span></span></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.state_combinator_syntax|bundle"><span>state_combinator_syntax</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Random.iterate.elims|fact"><span class="entity_def" id="Random.iterate.induct|fact"><span class="entity_def" id="Random.iterate.simps|fact"><span class="entity_def" id="Random.iterate.pelims|fact"><span class="entity_def" id="Random.iterate.cases|fact"><span class="entity_def" id="Random.iterate.termination|fact"><span class="entity_def" id="Random.iterate.pinduct|fact"><span class="entity_def" id="Random.iterate.psimps|fact"><span class="entity_def" id="Random.iterate_rel.inducts|fact"><span class="entity_def" id="Random.iterate_rel.simps|fact"><span class="entity_def" id="Random.iterate_rel.induct|fact"><span class="entity_def" id="Random.iterate_rel.cases|fact"><span class="entity_def" id="Random.iterate_rel.intros|fact"><span class="entity_def" id="Random.iterate_graph.inducts|fact"><span class="entity_def" id="Random.iterate_graph.simps|fact"><span class="entity_def" id="Random.iterate_graph.induct|fact"><span class="entity_def" id="Random.iterate_graph.cases|fact"><span class="entity_def" id="Random.iterate_graph.intros|fact"><span class="entity_def" id="Random.iterate.elims|thm"><span class="entity_def" id="Random.iterate.induct|thm"><span class="entity_def" id="Random.iterate.simps|thm"><span class="entity_def" id="Random.iterate.pelims|thm"><span class="entity_def" id="Random.iterate.cases|thm"><span class="entity_def" id="Random.iterate.termination|thm"><span class="entity_def" id="Random.iterate.pinduct|thm"><span class="entity_def" id="Random.iterate.psimps|thm"><span class="entity_def" id="Random.iterate_rel.inducts|thm"><span class="entity_def" id="Random.iterate_rel.simps|thm"><span class="entity_def" id="Random.iterate_rel.induct|thm"><span class="entity_def" id="Random.iterate_rel.cases|thm"><span class="entity_def" id="Random.iterate_rel.intros|thm"><span class="entity_def" id="Random.iterate_graph.inducts|thm"><span class="entity_def" id="Random.iterate_graph.simps|thm"><span class="entity_def" id="Random.iterate_graph.induct|thm"><span class="entity_def" id="Random.iterate_graph.cases|thm"><span class="entity_def" id="Random.iterate_graph.intros|thm"><span class="entity_def" id="Random.iterate_def|axiom"><span class="entity_def" id="Random.iterate_rel_def|axiom"><span class="entity_def" id="Random.iterate_sumC_def|axiom"><span class="entity_def" id="Random.iterate_graph_def|axiom"><span class="entity_def" id="Random.iterate_dom|const"><span class="entity_def" id="Random.iterate_rel|const"><span class="entity_def" id="Random.iterate_sumC|const"><span class="entity_def" id="Random.iterate_graph|const"><span class="entity_def" id="offset_1226..1229">fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Random.iterate|const"><span>iterate</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>iterate</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.Pair|const"><span>Pair</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.scomp|const"><span>∘→</span></a></span><span> </span><span class="free"><span>iterate</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Random.range_def|fact"><span class="entity_def" id="Random.range_def|thm"><span class="entity_def" id="Random.range_def_raw|axiom"><span class="entity_def" id="offset_1373..1383">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Random.range|const"><span>range</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>range</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.iterate|const"><span>iterate</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.log|const"><span>log</span></a><span> </span><span class="numeral"><span>2147483561</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>l</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Random.html#Random.next|const"><span>next</span></a><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.scomp|const"><span>∘→</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.Pair|const"><span>Pair</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>2147483561</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>
    </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.scomp|const"><span>∘→</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.Pair|const"><span>Pair</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>v</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Random.range|fact"><span class="entity_def" id="Random.range|thm"><span class="entity_def" id="offset_1563..1568">range</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.range|const"><span>range</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Random.html#offset_1373..1383"><span>range_def</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.split_def|fact"><span>split_def</span></a><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.less_natural_def|fact"><span>less_natural_def</span></a><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Random.html#Random.log.simps|fact"><span>log.simps</span></a><span> </span><a class="entity_ref" href="Random.html#offset_1226..1229"><span>iterate.simps</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Random.select_def|fact"><span class="entity_def" id="Random.select_def|thm"><span class="entity_def" id="Random.select_def_raw|axiom"><span class="entity_def" id="offset_1686..1696">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Random.select|const"><span>select</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="List.html#List.list|type"><span>list</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>select</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.range|const"><span>range</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.natural_of_nat|const"><span>natural_of_nat</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.scomp|const"><span>∘→</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.Pair|const"><span>Pair</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.nth|const"><span>nth</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.nat_of_natural|const"><span>nat_of_natural</span></a><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
     
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1845..1850">lemma</span></span></span><span> </span><span class="entity_def" id="Random.select|fact"><span class="entity_def" id="Random.select|thm"><span>select</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="List.html#List.list.Nil|const"><span>[]</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.select|const"><span>select</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="List.html#List.list.set|const"><span>set</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Random.html#offset_1845..1850"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.natural_of_nat|const"><span>natural_of_nat</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.less_natural_def|fact"><span>less_natural_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Random.html#offset_1563..1568"><span>range</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.range|const"><span>range</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.natural_of_nat|const"><span>natural_of_nat</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.natural_of_nat|const"><span>natural_of_nat</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="ISABELLE_HOME/src/Provers/classical.ML.html#HOL.best|method"><span class="operator"><span>best</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.nat_of_natural|const"><span>nat_of_natural</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.range|const"><span>range</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.natural_of_nat|const"><span>natural_of_nat</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.less_natural_def|fact"><span>less_natural_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.split_beta|fact"><span>split_beta</span></a><span> </span><a class="entity_ref" href="Random.html#offset_1686..1696"><span>select_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Random.pick.simps|fact"><span class="entity_def" id="Random.pick_def|fact"><span class="entity_def" id="Random.pick.simps|thm"><span class="entity_def" id="Random.pick_def|thm"><span class="entity_def" id="Random.pick_def|axiom"><span>primrec</span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Random.pick|const"><span>pick</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="List.html#List.list|type"><span>list</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>pick</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="List.html#List.list.Cons|const"><span>#</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>pick</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Random.pick_member|fact"><span class="entity_def" id="Random.pick_member|thm"><span class="entity_def" id="offset_2438..2449">pick_member</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Groups_List.html#Groups_List.monoid_add_class.sum_list|const"><span>sum_list</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Random.html#Random.pick|const"><span>pick</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>i</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.less_natural_def|fact"><span>less_natural_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Random.pick_drop_zero|fact"><span class="entity_def" id="Random.pick_drop_zero|thm"><span class="entity_def" id="offset_2582..2596">pick_drop_zero</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Random.html#Random.pick|const"><span>pick</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.filter|const"><span>filter</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.pick|const"><span>pick</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="HOL.html#HOL.fun_eq_iff|fact"><span>fun_eq_iff</span></a><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.less_natural_def|fact"><span>less_natural_def</span></a><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.minus_natural_def|fact"><span>minus_natural_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Random.pick_same|fact"><span class="entity_def" id="Random.pick_same|thm"><span class="entity_def" id="offset_2733..2742">pick_same</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Random.html#Random.pick|const"><span>Random.pick</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_Type.html#Product_Type.Pair|const"><span>Pair</span></a><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.natural_of_nat|const"><span>natural_of_nat</span></a><span> </span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="List.html#List.nth|const"><span>nth</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>l</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>Nil</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Cons</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>l</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.less_natural_def|fact"><span>less_natural_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Random.select_weight_def|fact"><span class="entity_def" id="Random.select_weight_def|thm"><span class="entity_def" id="Random.select_weight_def_raw|axiom"><span class="entity_def" id="offset_2981..2991">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Random.select_weight|const"><span>select_weight</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural|type"><span>natural</span></a><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="List.html#List.list|type"><span>list</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>select_weight</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.range|const"><span>range</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Groups_List.html#Groups_List.monoid_add_class.sum_list|const"><span>sum_list</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
   </span><span class="main"><a class="entity_ref" href="Product_Type.html#Product_Type.scomp|const"><span>∘→</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.Pair|const"><span>Pair</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.pick|const"><span>pick</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3139..3144">lemma</span></span></span><span> </span><span class="entity_def" id="Random.select_weight_member|fact"><span class="entity_def" id="Random.select_weight_member|thm"><span>select_weight_member</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Groups_List.html#Groups_List.monoid_add_class.sum_list|const"><span>sum_list</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.select_weight|const"><span>select_weight</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Random.html#offset_1563..1568"><span>range</span></a><span> </span><a class="entity_ref" href="Random.html#offset_3139..3144"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.range|const"><span>range</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Groups_List.html#Groups_List.monoid_add_class.sum_list|const"><span>sum_list</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Groups_List.html#Groups_List.monoid_add_class.sum_list|const"><span>sum_list</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Random.html#offset_2438..2449"><span>pick_member</span></a><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Random.html#Random.pick|const"><span>pick</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.range|const"><span>range</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Groups_List.html#Groups_List.monoid_add_class.sum_list|const"><span>sum_list</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Random.html#offset_2981..2991"><span>select_weight_def</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.scomp_def|fact"><span>scomp_def</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.split_def|fact"><span>split_def</span></a><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Random.select_weight_cons_zero|fact"><span class="entity_def" id="Random.select_weight_cons_zero|thm"><span>select_weight_cons_zero</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Random.html#Random.select_weight|const"><span>select_weight</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="List.html#List.list.Cons|const"><span>#</span></a></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.select_weight|const"><span>select_weight</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Random.html#offset_2981..2991"><span>select_weight_def</span></a><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.less_natural_def|fact"><span>less_natural_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Random.select_weight_drop_zero|fact"><span class="entity_def" id="Random.select_weight_drop_zero|thm"><span>select_weight_drop_zero</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Random.html#Random.select_weight|const"><span>select_weight</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.filter|const"><span>filter</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.select_weight|const"><span>select_weight</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Groups_List.html#Groups_List.monoid_add_class.sum_list|const"><span>sum_list</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>←</span></span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Groups_List.html#Groups_List.monoid_add_class.sum_list|const"><span>sum_list</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.less_natural_def|fact"><span>less_natural_def</span></a><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural_eq_iff|fact"><span>natural_eq_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Random.html#offset_2981..2991"><span>select_weight_def</span></a><span> </span><a class="entity_ref" href="Random.html#offset_2582..2596"><span>pick_drop_zero</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3993..3998">lemma</span></span></span><span> </span><span class="entity_def" id="Random.select_weight_select|fact"><span class="entity_def" id="Random.select_weight_select|thm"><span>select_weight_select</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="List.html#List.list.Nil|const"><span>[]</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Random.html#Random.select_weight|const"><span>select_weight</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_Type.html#Product_Type.Pair|const"><span>Pair</span></a><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Random.html#Random.select|const"><span>select</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>less</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Random.html#Random.range|const"><span>range</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.natural_of_nat|const"><span>natural_of_nat</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.natural_of_nat|const"><span>natural_of_nat</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Random.html#offset_3993..3998"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Random.html#offset_1563..1568"><span>range</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.less_natural_def|fact"><span>less_natural_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Groups_List.html#Groups_List.monoid_add_class.sum_list|const"><span>sum_list</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.list.map|const"><span>map</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_Type.html#Product_Type.Pair|const"><span>Pair</span></a><span> </span><span class="main"><a class="entity_ref" href="Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.natural.natural_of_nat|const"><span>natural_of_nat</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Random.html#offset_2981..2991"><span>select_weight_def</span></a><span> </span><a class="entity_ref" href="Random.html#offset_1686..1696"><span>select_def</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.scomp_def|fact"><span>scomp_def</span></a><span> </span><a class="entity_ref" href="Product_Type.html#Product_Type.split_def|fact"><span>split_def</span></a><span>
      </span><a class="entity_ref" href="HOL.html#HOL.fun_eq_iff|fact"><span>fun_eq_iff</span></a><span> </span><a class="entity_ref" href="Random.html#offset_2733..2742"><span>pick_same</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Code_Numeral.html#Code_Numeral.less_natural_def|fact"><span>less_natural_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>ML›</span></span></span><span> interface</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>code_reflect</span></span></span><span> Random_Engine
  </span><span class="keyword2"><span class="keyword"><span>functions</span></span></span><span> range select select_weight</span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Random_Engine</span></span><span> </span><span class="main"><span>=</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>

</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Random_Engine</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>seed</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Code_Numeral.natural</span><span> * </span><span>Code_Numeral.natural</span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>seed</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Unsynchronized.ref</span><span> 
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>now</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Time.toMilliseconds</span><span> </span><span class="main"><span>(</span></span><span>Time.now</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>q</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>IntInf.divMod</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>now</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_numeral"><span>2147483562</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>s2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>q</span></span><span> </span><span>mod</span><span> </span><span class="inner_numeral"><span>2147483398</span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>apply2</span><span> </span><span>Code_Numeral.natural_of_integer</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>s1</span></span><span> </span><span>+</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s2</span></span><span> </span><span>+</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>next_seed</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>seed1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>seed'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>code</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Random.html#Random.split_seed|const"><span>split_seed</span></a></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>!</span><span> </span><span class="entity"><span>seed</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>seed</span></span><span> </span><span>:=</span><span> </span><span class="entity"><span>seed'</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="entity"><span>seed1</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>run</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>seed'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>!</span><span> </span><span class="entity"><span>seed</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>seed</span></span><span> </span><span>:=</span><span> </span><span class="entity"><span>seed'</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span>
</span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>hide_type</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>open</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Random.html#Random.seed|type"><span>seed</span></a><span>
</span><span class="keyword1"><span class="command"><span>hide_const</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>open</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Random.html#Random.inc_shift|const"><span>inc_shift</span></a><span> </span><a class="entity_ref" href="Random.html#Random.minus_shift|const"><span>minus_shift</span></a><span> </span><a class="entity_ref" href="Random.html#Random.log|const"><span>log</span></a><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Random.html#Random.next|const"><span>next</span></a><span>"</span></span><span> </span><a class="entity_ref" href="Random.html#Random.split_seed|const"><span>split_seed</span></a><span>
  </span><a class="entity_ref" href="Random.html#Random.iterate|const"><span>iterate</span></a><span> </span><a class="entity_ref" href="Random.html#Random.range|const"><span>range</span></a><span> </span><a class="entity_ref" href="Random.html#Random.select|const"><span>select</span></a><span> </span><a class="entity_ref" href="Random.html#Random.pick|const"><span>pick</span></a><span> </span><a class="entity_ref" href="Random.html#Random.select_weight|const"><span>select_weight</span></a><span>
</span><span class="keyword1"><span class="command"><span>hide_fact</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>open</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Random.html#Random.range_def|fact"><span>range_def</span></a><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>