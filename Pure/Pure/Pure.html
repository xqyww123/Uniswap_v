<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Pure</title>
</head>


<body>
<div class="head">
<h1>Theory Pure</h1>
</div>

<pre class="source"><span class="comment1"><span>(</span><span>*</span><span>  Title:      Pure/Pure.thy
    Author:     Makarius

The Pure theory, with definitions of Isar commands and some lemmas.
</span><span>*</span><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Pure.html"><span>Pure</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>keywords</span></span></span><span>
    </span><span class="quoted"><span>"</span><span>!!</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>!</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>+</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>:</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>;</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>&lt;</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>&lt;=</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>==</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>=&gt;</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>?</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>[</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>―</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>≡</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>↽</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>⇀</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>⇌</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>⊆</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>]</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>binder</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>by</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>in</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>infix</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>infixl</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>infixr</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>is</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>open</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>output</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>overloaded</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>pervasive</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>premises</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>structure</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>unchecked</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>private</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>qualified</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> before_command
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>assumes</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>constrains</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>defines</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>fixes</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>for</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>if</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>includes</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>notes</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>rewrites</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>obtains</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>shows</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>when</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>where</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>|</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> quasi_command
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>text</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>txt</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> document_body
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>text_raw</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> document_raw
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>default_sort</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>typedecl</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>nonterminal</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>judgment</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>consts</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>syntax</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>no_syntax</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>translations</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>no_translations</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>type_notation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>no_type_notation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>notation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>no_notation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>alias</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>type_alias</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>declare</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>hide_class</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>hide_type</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>hide_const</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>hide_fact</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>type_synonym</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>definition</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>abbreviation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>lemmas</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_defn
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>axiomatization</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_stmt
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>external_file</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>bibtex_file</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>ROOTS_file</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_load
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>generate_file</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>export_generated_files</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> diag
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>scala_build_generated_files</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> diag
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>compile_generated_files</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> diag </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>external_files</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>export_files</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>export_prefix</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>export_classpath</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>ML_file</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>ML_file_debug</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>ML_file_no_debug</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_load </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>ML</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>SML_file</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>SML_file_debug</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>SML_file_no_debug</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_load </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>ML</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>SML_import</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>SML_export</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>ML_export</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>ML</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>ML_prf</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_decl </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>  </span><span class="comment1"><span>(</span><span>*</span><span> FIXME % "ML" ?? </span><span>*</span><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>ML_val</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>ML_command</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> diag </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>ML</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>simproc_setup</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>ML</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>setup</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>local_setup</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>attribute_setup</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>method_setup</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>declaration</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>syntax_declaration</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>parse_ast_translation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>parse_translation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_translation</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>typed_print_translation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_ast_translation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>oracle</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>ML</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>bundle</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl_block
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>unbundle</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>include</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>including</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_decl
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>print_bundles</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> diag
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>context</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>locale</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>experiment</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl_block
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>interpret</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_goal </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>interpretation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>global_interpretation</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>sublocale</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_goal
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>class</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl_block
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>subclass</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_goal
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>instantiation</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl_block
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>instance</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_goal
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>overloading</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl_block
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>opening</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> quasi_command
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>code_datatype</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>theorem</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>lemma</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>corollary</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>proposition</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_goal_stmt
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>schematic_goal</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_goal_stmt
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>notepad</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl_block
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>have</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_goal </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>hence</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_goal </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>show</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_asm_goal </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>thus</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_asm_goal </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>then</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>from</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>with</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_chain </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>note</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_decl </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>supply</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_script </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>using</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>unfolding</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_decl </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>fix</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>assume</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>presume</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>define</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_asm </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>consider</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_goal </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>obtain</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_asm_goal </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>let</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>write</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_decl </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>case</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_asm </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>{</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_open </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>}</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_close </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>next</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> next_block </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>qed</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> qed_block </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>by</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>..</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>.</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>sorry</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>\&lt;proof&gt;</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>"</span><span>qed</span><span>"</span></span><span> </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>done</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>"</span><span>qed_script</span><span>"</span></span><span> </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>oops</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> qed_global </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>defer</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>prefer</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>apply</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_script </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>apply_end</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_script </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>subgoal</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_script_goal </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_block </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>also</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>moreover</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_decl </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>finally</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>ultimately</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_chain </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>back</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> prf_script </span><span class="main"><span>%</span></span><span> </span><span class="quoted"><span>"</span><span>proof</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>help</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_commands</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_options</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_context</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_theory</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>print_definitions</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_syntax</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_abbrevs</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_defn_rules</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>print_theorems</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_locales</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_classes</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_locale</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>print_interps</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_attributes</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>print_simpset</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_rules</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_trans_rules</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_methods</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>print_antiquotations</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_ML_antiquotations</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>thy_deps</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>locale_deps</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>class_deps</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>thm_deps</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>thm_oracles</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_term_bindings</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>print_facts</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_cases</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_statement</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>thm</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>prf</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>full_prf</span><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>term</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>typ</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>print_codesetup</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>unused_thms</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> diag
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>print_state</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> diag
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>welcome</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> diag
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>end</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_end
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>realizers</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>realizability</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>extract_type</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>extract</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>find_theorems</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>find_consts</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> diag
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>named_theorems</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl
</span><span class="keyword2"><span class="keyword"><span>abbrevs</span></span></span><span> </span><span class="quoted"><span>"</span><span>\</span><span>\tag</span><span>"</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span>"</span><span>✐‹tag ›</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>===&gt;</span><span>"</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span>"</span><span>===&gt;</span><span>"</span></span><span>  </span><span class="comment1"><span>(</span><span>*</span><span>prevent replacement of very long arrows</span><span>*</span><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>---&gt;</span><span>"</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span>"</span><span>─→</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>hence</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>thus</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>default_sort</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>simproc_setup</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>apply_end</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>realizers</span><span>"</span></span><span> </span><span class="quoted"><span>"</span><span>realizability</span><span>"</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span>"</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>hence</span><span>"</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span>"</span><span>then have</span><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span>"</span><span>thus</span><span>"</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span>"</span><span>then show</span><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Isar commands</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Other files</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>external_file</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"formal dependency on external file"</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.provide_parse_file</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>get_file</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>get_file</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>bibtex_file</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"check bibtex database file in Prover IDE"</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.provide_parse_file</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>get_file</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="entity"><span>lines</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>pos</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>thy'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get_file</span></span><span> </span><span class="entity"><span>thy</span></span><span class="main"><span>;</span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Bibtex.check_database_output</span></span><span> </span><span class="entity"><span>pos</span></span><span> </span><span class="main"><span>(</span></span><span>cat_lines</span><span> </span><span class="entity"><span>lines</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="entity"><span>thy'</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>ROOTS_file</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"session ROOTS file"</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.provide_parse_file</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>get_file</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="entity"><span>src_path</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lines</span></span><span class="main"><span>,</span></span><span> </span><span>pos</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>pos0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>thy'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get_file</span></span><span> </span><span class="entity"><span>thy</span></span><span class="main"><span>;</span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Proof_Context.init_global</span><span> </span><span class="entity"><span>thy'</span></span><span class="main"><span>;</span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>dir</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Path.dir</span><span> </span><span class="main"><span>(</span></span><span>Path.expand</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.master_directory</span></span><span> </span><span class="entity"><span>thy'</span></span><span> </span><span>+</span><span> </span><span class="entity"><span>src_path</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
              </span><span class="main"><span>(</span></span><span class="entity"><span>lines</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>pos0</span></span><span class="main"><span>)</span></span><span> </span><span>|-&gt;</span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>line</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>pos1</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
                </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
                  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>pos2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Position.symbol_explode</span><span> </span><span class="entity"><span>line</span></span><span> </span><span class="entity"><span>pos1</span></span><span class="main"><span>;</span></span><span>
                  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>range</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Position.range</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>pos1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>pos2</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
                  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>source</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Input.source</span><span> </span><span>true</span><span> </span><span class="entity"><span>line</span></span><span> </span><span class="entity"><span>range</span></span><span class="main"><span>;</span></span><span>
                  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
                    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>line</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>""</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span>
                    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>String.isPrefix</span><span> </span><span class="inner_quoted"><span>"#"</span></span><span> </span><span class="entity"><span>line</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
                      </span><span>Context_Position.report</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>#</span></span><span class="inner_numeral"><span>1</span></span><span> </span><span class="entity"><span>range</span></span><span class="main"><span>)</span></span><span> </span><span>Markup.comment</span><span>
                    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
                      </span><span class="main"><span>(</span></span><span>ignore</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.check_session_dir</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span class="entity"><span>dir</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>source</span></span><span class="main"><span>)</span></span><span>
                        </span><span class="keyword3"><span class="keyword"><span>handle</span></span></span><span> </span><span>ERROR</span><span> </span><span class="entity"><span>msg</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Output.error_message</span><span> </span><span class="entity"><span>msg</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
                </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="entity"><span>pos2</span></span><span> </span><span>|&gt;</span><span> </span><span>Position.symbol</span><span> </span><span class="inner_quoted"><span>"\n"</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="entity"><span>thy'</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>generate_file</span></span><span>›</span></span></span><span>
      </span><span class="inner_quoted"><span>"generate source file, with antiquotations"</span></span><span>
      </span><span class="main"><span>(</span></span><span>Parse.path_binding</span><span> </span><span>--</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.embedded_input</span><span class="main"><span>)</span></span><span>
        </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Generated_Files.generate_file_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>


  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>files_in_theory</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.underscore</span><span> </span><span>&gt;&gt;</span><span> </span><span>K</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span>||</span><span> </span><span>Scan.repeat1</span><span> </span><span>Parse.path_binding</span><span class="main"><span>)</span></span><span> </span><span>--</span><span>
      </span><span>Scan.option</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>in</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.theory_name</span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>export_generated_files</span></span><span>›</span></span></span><span>
      </span><span class="inner_quoted"><span>"export generated files from given theories"</span></span><span>
      </span><span class="main"><span>(</span></span><span>Parse.and_list1</span><span> </span><span class="entity"><span>files_in_theory</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="entity"><span>Generated_Files.export_generated_files_cmd</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>


  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>base_dir</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span>
      </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>in</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.path_input</span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Input.string</span><span> </span><span class="inner_quoted"><span>""</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>external_files</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Scan.repeat1</span><span> </span><span>Parse.path_input</span><span> </span><span>--</span><span> </span><span class="entity"><span>base_dir</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>exe</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Parse.reserved</span><span> </span><span class="inner_quoted"><span>"exe"</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>K</span><span> </span><span>true</span><span> </span><span>||</span><span> </span><span>Parse.reserved</span><span> </span><span class="inner_quoted"><span>"executable"</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>K</span><span> </span><span>false</span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>executable</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>exe</span></span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>SOME</span><span> </span><span>||</span><span> </span><span>Scan.succeed</span><span> </span><span>NONE</span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>export_files</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Scan.repeat1</span><span> </span><span>Parse.path_binding</span><span> </span><span>--</span><span> </span><span class="entity"><span>executable</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>compile_generated_files</span></span><span>›</span></span></span><span>
      </span><span class="inner_quoted"><span>"compile generated files and export results"</span></span><span>
      </span><span class="main"><span>(</span></span><span>Parse.and_list</span><span> </span><span class="entity"><span>files_in_theory</span></span><span> </span><span>--</span><span>
        </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>external_files</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span>Parse.and_list1</span><span> </span><span class="entity"><span>external_files</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span>--</span><span>
        </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>export_files</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span>Parse.and_list1</span><span> </span><span class="entity"><span>export_files</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span>--</span><span>
        </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>export_prefix</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.path_binding</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>""</span></span><span class="main"><span>,</span></span><span> </span><span>Position.none</span><span class="main"><span>)</span></span><span> </span><span>--</span><span>
        </span><span class="main"><span>(</span></span><span>Parse.where_</span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span>Parse.ML_source</span><span class="main"><span>)</span></span><span>
        </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>args</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>external</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>export</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>export_prefix</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>source</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
            </span><span class="entity"><span>Generated_Files.compile_generated_files_cmd</span></span><span>
              </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>external</span></span><span> </span><span class="entity"><span>export</span></span><span> </span><span class="entity"><span>export_prefix</span></span><span> </span><span class="entity"><span>source</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>scala_build_generated_files</span></span><span>›</span></span></span><span>
      </span><span class="inner_quoted"><span>"build and export Isabelle/Scala/Java module"</span></span><span>
      </span><span class="main"><span>(</span></span><span>Parse.and_list</span><span> </span><span class="entity"><span>files_in_theory</span></span><span> </span><span>--</span><span>
        </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>external_files</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span>Parse.and_list1</span><span> </span><span class="entity"><span>external_files</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>
        </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>args</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>external</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
            </span><span class="entity"><span>Generated_Files.scala_build_generated_files_cmd</span></span><span>
              </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>external</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>external_file</span></span></span><span> </span><span class="quoted"><a href="ISABELLE_HOME/src/Pure/ROOT0.ML.html"><span>"</span><span>ROOT0.ML</span><span>"</span></a></span><span>
</span><span class="keyword1"><span class="command"><span>external_file</span></span></span><span> </span><span class="quoted"><a href="ISABELLE_HOME/src/Pure/ROOT.ML.html"><span>"</span><span>ROOT.ML</span><span>"</span></a></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Embedded ML text</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>semi</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Scan.option</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>;</span></span><span>›</span></span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>ML_file</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"read and evaluate Isabelle/ML file"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.parse_file</span></span><span> </span><span>--|</span><span> </span><span class="entity"><span>semi</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>ML_File.ML</span></span><span> </span><span>NONE</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>ML_file_debug</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"read and evaluate Isabelle/ML file (with debugger information)"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.parse_file</span></span><span> </span><span>--|</span><span> </span><span class="entity"><span>semi</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>ML_File.ML</span></span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span>true</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>ML_file_no_debug</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"read and evaluate Isabelle/ML file (no debugger information)"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.parse_file</span></span><span> </span><span>--|</span><span> </span><span class="entity"><span>semi</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>ML_File.ML</span></span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span>false</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>SML_file</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"read and evaluate Standard ML file"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.parse_file</span></span><span> </span><span>--|</span><span> </span><span class="entity"><span>semi</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>ML_File.SML</span></span><span> </span><span>NONE</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>SML_file_debug</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"read and evaluate Standard ML file (with debugger information)"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.parse_file</span></span><span> </span><span>--|</span><span> </span><span class="entity"><span>semi</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>ML_File.SML</span></span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span>true</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>SML_file_no_debug</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"read and evaluate Standard ML file (no debugger information)"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Resources.parse_file</span></span><span> </span><span>--|</span><span> </span><span class="entity"><span>semi</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>ML_File.SML</span></span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span>false</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>SML_export</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"evaluate SML within Isabelle/ML environment"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>source</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>flags</span></span><span class="main"><span>:</span></span><span> </span><span>ML_Compiler.flags</span><span> </span><span class="main"><span>=</span></span><span>
          </span><span class="main"><span>{</span></span><span>environment</span><span> </span><span class="main"><span>=</span></span><span> </span><span>ML_Env.SML_export</span><span class="main"><span>,</span></span><span> </span><span>redirect</span><span> </span><span class="main"><span>=</span></span><span> </span><span>false</span><span class="main"><span>,</span></span><span> </span><span>verbose</span><span> </span><span class="main"><span>=</span></span><span> </span><span>true</span><span class="main"><span>,</span></span><span>
            </span><span>debug</span><span> </span><span class="main"><span>=</span></span><span> </span><span>NONE</span><span class="main"><span>,</span></span><span> </span><span>writeln</span><span> </span><span class="main"><span>=</span></span><span> </span><span>writeln</span><span class="main"><span>,</span></span><span> </span><span>warning</span><span> </span><span class="main"><span>=</span></span><span> </span><span>warning</span><span class="main"><span>}</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
        </span><span class="entity"><span>Toplevel.theory</span></span><span>
          </span><span class="main"><span>(</span></span><span>Context.theory_map</span><span> </span><span class="main"><span>(</span></span><span>ML_Context.exec</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>ML_Context.eval_source</span><span> </span><span class="entity"><span>flags</span></span><span> </span><span class="entity"><span>source</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>SML_import</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"evaluate Isabelle/ML within SML environment"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>source</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>flags</span></span><span class="main"><span>:</span></span><span> </span><span>ML_Compiler.flags</span><span> </span><span class="main"><span>=</span></span><span>
          </span><span class="main"><span>{</span></span><span>environment</span><span> </span><span class="main"><span>=</span></span><span> </span><span>ML_Env.SML_import</span><span class="main"><span>,</span></span><span> </span><span>redirect</span><span> </span><span class="main"><span>=</span></span><span> </span><span>false</span><span class="main"><span>,</span></span><span> </span><span>verbose</span><span> </span><span class="main"><span>=</span></span><span> </span><span>true</span><span class="main"><span>,</span></span><span>
            </span><span>debug</span><span> </span><span class="main"><span>=</span></span><span> </span><span>NONE</span><span class="main"><span>,</span></span><span> </span><span>writeln</span><span> </span><span class="main"><span>=</span></span><span> </span><span>writeln</span><span class="main"><span>,</span></span><span> </span><span>warning</span><span> </span><span class="main"><span>=</span></span><span> </span><span>warning</span><span class="main"><span>}</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
        </span><span class="entity"><span>Toplevel.generic_theory</span></span><span>
          </span><span class="main"><span>(</span></span><span>ML_Context.exec</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>ML_Context.eval_source</span><span> </span><span class="entity"><span>flags</span></span><span> </span><span class="entity"><span>source</span></span><span class="main"><span>)</span></span><span> </span><span>#&gt;</span><span>
            </span><span>Local_Theory.propagate_ml_env</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"ML_export"</span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="operator"><span class="entity"><span>⌂</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="inner_quoted"><span>"ML text within theory or local theory, and export to bootstrap environment"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>source</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.generic_theory</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>context</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>context</span></span><span>
        </span><span>|&gt;</span><span> </span><span>Config.put_generic</span><span> </span><span>ML_Env.ML_environment</span><span> </span><span>ML_Env.Isabelle</span><span>
        </span><span>|&gt;</span><span> </span><span>Config.put_generic</span><span> </span><span>ML_Env.ML_write_global</span><span> </span><span>true</span><span>
        </span><span>|&gt;</span><span> </span><span>ML_Context.exec</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
            </span><span>ML_Context.eval_source</span><span> </span><span class="main"><span>(</span></span><span>ML_Compiler.verbose</span><span> </span><span>true</span><span> </span><span>ML_Compiler.flags</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>source</span></span><span class="main"><span>)</span></span><span>
        </span><span>|&gt;</span><span> </span><span>Config.restore_generic</span><span> </span><span>ML_Env.ML_write_global</span><span> </span><span class="entity"><span>context</span></span><span>
        </span><span>|&gt;</span><span> </span><span>Config.restore_generic</span><span> </span><span>ML_Env.ML_environment</span><span> </span><span class="entity"><span>context</span></span><span>
        </span><span>|&gt;</span><span> </span><span>Local_Theory.propagate_ml_env</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>ML_prf</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"ML text within proof"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>source</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Proof.map_context</span></span><span> </span><span class="main"><span>(</span></span><span>Context.proof_map</span><span>
        </span><span class="main"><span>(</span></span><span>ML_Context.exec</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
            </span><span>ML_Context.eval_source</span><span> </span><span class="main"><span>(</span></span><span>ML_Compiler.verbose</span><span> </span><span>true</span><span> </span><span>ML_Compiler.flags</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>source</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>#&gt;</span><span>
          </span><span class="entity"><span>Proof.propagate_ml_env</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>ML_val</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"diagnostic ML text"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Isar_Cmd.ml_diag</span></span><span> </span><span>true</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>ML_command</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"diagnostic ML text (silent)"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Isar_Cmd.ml_diag</span></span><span> </span><span>false</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>setup</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"ML setup for global theory"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Isar_Cmd.setup</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>local_setup</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"ML setup for local theory"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Isar_Cmd.local_setup</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>oracle</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"declare oracle"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.range</span><span> </span><span>Parse.name</span><span> </span><span>--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.ML_source</span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Isar_Cmd.oracle</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>attribute_setup</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"define attribute in ML"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.name_position</span><span> </span><span>--</span><span>
        </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.ML_source</span><span> </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span>Parse.embedded</span><span> </span><span class="inner_quoted"><span>""</span></span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>txt</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>cmt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Attrib.attribute_setup</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="entity"><span>txt</span></span><span> </span><span class="entity"><span>cmt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>method_setup</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"define proof method in ML"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.name_position</span><span> </span><span>--</span><span>
        </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.ML_source</span><span> </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span>Parse.embedded</span><span> </span><span class="inner_quoted"><span>""</span></span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>txt</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>cmt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Method.method_setup</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="entity"><span>txt</span></span><span> </span><span class="entity"><span>cmt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>declaration</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"generic ML declaration"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_keyword</span><span> </span><span class="inner_quoted"><span>"pervasive"</span></span><span> </span><span>--</span><span> </span><span>Parse.ML_source</span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>pervasive</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>txt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Isar_Cmd.declaration</span></span><span> </span><span class="main"><span>{</span></span><span>syntax</span><span> </span><span class="main"><span>=</span></span><span> </span><span>false</span><span class="main"><span>,</span></span><span> </span><span>pervasive</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>pervasive</span></span><span class="main"><span>}</span></span><span> </span><span class="entity"><span>txt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>syntax_declaration</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"generic ML syntax declaration"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_keyword</span><span> </span><span class="inner_quoted"><span>"pervasive"</span></span><span> </span><span>--</span><span> </span><span>Parse.ML_source</span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>pervasive</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>txt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Isar_Cmd.declaration</span></span><span> </span><span class="main"><span>{</span></span><span>syntax</span><span> </span><span class="main"><span>=</span></span><span> </span><span>true</span><span class="main"><span>,</span></span><span> </span><span>pervasive</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>pervasive</span></span><span class="main"><span>}</span></span><span> </span><span class="entity"><span>txt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>simproc_setup</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"define simproc in ML"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.name_position</span><span> </span><span>--</span><span>
      </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.enum1</span><span> </span><span class="inner_quoted"><span>"|"</span></span><span> </span><span>Parse.term</span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>--</span><span>
      </span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Isar_Cmd.simproc_setup</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Theory commands</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Sorts and types</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>default_sort</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"declare default sort for explicit type variables"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.sort</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>lthy</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Local_Theory.set_defsort</span><span> </span><span class="main"><span>(</span></span><span>Syntax.read_sort</span><span> </span><span class="entity"><span>lthy</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>lthy</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>typedecl</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"type declaration"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.type_args</span><span> </span><span>--</span><span> </span><span>Parse.binding</span><span> </span><span>--</span><span> </span><span>Parse.opt_mixfix</span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>args</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>mx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="entity"><span>Typedecl.typedecl</span></span><span> </span><span class="main"><span>{</span></span><span>final</span><span> </span><span class="main"><span>=</span></span><span> </span><span>true</span><span class="main"><span>}</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span>rpair</span><span> </span><span>dummyS</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>mx</span></span><span class="main"><span>)</span></span><span> </span><span>#&gt;</span><span> </span><span>snd</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>type_synonym</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"declare type abbreviation"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.type_args</span><span> </span><span>--</span><span> </span><span>Parse.binding</span><span> </span><span>--</span><span>
      </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span>Parse.typ</span><span> </span><span>--</span><span> </span><span>Parse.opt_mixfix'</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>args</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rhs</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>mx</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>snd</span><span> </span><span>o</span><span> </span><span class="entity"><span>Typedecl.abbrev_cmd</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>mx</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>rhs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Consts</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>judgment</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"declare object-logic judgment"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.const_binding</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span>Object_Logic.add_judgment_cmd</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>consts</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"declare constants"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span>Parse.const_binding</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span>Sign.add_consts_cmd</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Syntax and translations</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>nonterminal</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"declare syntactic type constructors (grammar nonterminal symbols)"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.and_list1</span><span> </span><span>Parse.binding</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span>Sign.add_nonterminals_global</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>syntax</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"add raw syntax clauses"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.syntax_mode</span><span> </span><span>--</span><span> </span><span>Scan.repeat1</span><span> </span><span>Parse.const_decl</span><span>
      </span><span>&gt;&gt;</span><span> </span><span>uncurry</span><span> </span><span class="main"><span>(</span></span><span>Local_Theory.syntax_cmd</span><span> </span><span>true</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>no_syntax</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"delete raw syntax clauses"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.syntax_mode</span><span> </span><span>--</span><span> </span><span>Scan.repeat1</span><span> </span><span>Parse.const_decl</span><span>
      </span><span>&gt;&gt;</span><span> </span><span>uncurry</span><span> </span><span class="main"><span>(</span></span><span>Local_Theory.syntax_cmd</span><span> </span><span>false</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>trans_pat</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Scan.optional</span><span>
    </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span>Parse.inner_syntax</span><span> </span><span>Parse.name</span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="inner_quoted"><span>"logic"</span></span><span>
    </span><span>--</span><span> </span><span>Parse.inner_syntax</span><span> </span><span>Parse.string</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trans_arrow</span></span><span> </span><span class="entity"><span>toks</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>⇀</span></span><span>›</span></span></span><span> </span><span>||</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=&gt;</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>K</span><span> </span><span>Syntax.Parse_Rule</span><span> </span><span>||</span><span>
    </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>↽</span></span><span>›</span></span></span><span> </span><span>||</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>&lt;=</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>K</span><span> </span><span>Syntax.Print_Rule</span><span> </span><span>||</span><span>
    </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>⇌</span></span><span>›</span></span></span><span> </span><span>||</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>==</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>K</span><span> </span><span>Syntax.Parse_Print_Rule</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>toks</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>trans_line</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>trans_pat</span></span><span> </span><span>--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trans_arrow</span></span><span> </span><span>--</span><span> </span><span class="entity"><span>trans_pat</span></span><span class="main"><span>)</span></span><span>
    </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>left</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>arr</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>right</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>arr</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>left</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>right</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>translations</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"add syntax translation rules"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span class="entity"><span>trans_line</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Isar_Cmd.translations</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>no_translations</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"delete syntax translation rules"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span class="entity"><span>trans_line</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Isar_Cmd.no_translations</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Translation functions</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>parse_ast_translation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"install parse ast translation functions"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Isar_Cmd.parse_ast_translation</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>parse_translation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"install parse translation functions"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Isar_Cmd.parse_translation</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_translation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"install print translation functions"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Isar_Cmd.print_translation</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>typed_print_translation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"install typed print translation functions"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Isar_Cmd.typed_print_translation</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_ast_translation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"install print ast translation functions"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.ML_source</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Isar_Cmd.print_ast_translation</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Specifications</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory'</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>definition</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"constant definition"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.option</span><span> </span><span class="entity"><span>Parse_Spec.constdecl</span></span><span> </span><span>--</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.opt_thm_name</span></span><span> </span><span class="inner_quoted"><span>":"</span></span><span> </span><span>--</span><span> </span><span>Parse.prop</span><span class="main"><span>)</span></span><span> </span><span>--</span><span>
      </span><span class="entity"><span>Parse_Spec.if_assumes</span></span><span> </span><span>--</span><span> </span><span>Parse.for_fixes</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>decl</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>spec</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>prems</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>params</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span> </span><span>oo</span><span> </span><span class="entity"><span>Specification.definition_cmd</span></span><span> </span><span class="entity"><span>decl</span></span><span> </span><span class="entity"><span>params</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="entity"><span>spec</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory'</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>abbreviation</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"constant abbreviation"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.syntax_mode</span><span> </span><span>--</span><span> </span><span>Scan.option</span><span> </span><span class="entity"><span>Parse_Spec.constdecl</span></span><span> </span><span>--</span><span> </span><span>Parse.prop</span><span> </span><span>--</span><span> </span><span>Parse.for_fixes</span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>mode</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>decl</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>spec</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>params</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Specification.abbreviation_cmd</span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="entity"><span>decl</span></span><span> </span><span class="entity"><span>params</span></span><span> </span><span class="entity"><span>spec</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>axiomatization</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Parse.and_list1</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.thm_name</span></span><span> </span><span class="inner_quoted"><span>":"</span></span><span> </span><span>--</span><span> </span><span>Parse.prop</span><span class="main"><span>)</span></span><span> </span><span>--</span><span>
  </span><span class="entity"><span>Parse_Spec.if_assumes</span></span><span> </span><span>--</span><span> </span><span>Parse.for_fixes</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>axiomatization</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"axiomatic constant specification"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.optional</span><span> </span><span>Parse.vars</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span>--</span><span>
      </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span>Parse.where_</span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="entity"><span>axiomatization</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Specification.axiomatization_cmd</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>alias</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"name-space alias for constant"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.binding</span><span> </span><span>--</span><span> </span><span class="main"><span>(</span></span><span>Parse.!!!</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.name_position</span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Specification.alias_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>type_alias</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"name-space alias for type constructor"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.binding</span><span> </span><span>--</span><span> </span><span class="main"><span>(</span></span><span>Parse.!!!</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.name_position</span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Specification.type_alias_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Notation</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>type_notation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"add concrete syntax for type constructors"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.syntax_mode</span><span> </span><span>--</span><span> </span><span>Parse.and_list1</span><span> </span><span class="main"><span>(</span></span><span>Parse.type_const</span><span> </span><span>--</span><span> </span><span>Parse.mixfix</span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>mode</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Local_Theory.type_notation_cmd</span><span> </span><span>true</span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>no_type_notation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"delete concrete syntax for type constructors"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.syntax_mode</span><span> </span><span>--</span><span> </span><span>Parse.and_list1</span><span> </span><span class="main"><span>(</span></span><span>Parse.type_const</span><span> </span><span>--</span><span> </span><span>Parse.mixfix</span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>mode</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Local_Theory.type_notation_cmd</span><span> </span><span>false</span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>notation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"add concrete syntax for constants / fixed variables"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.syntax_mode</span><span> </span><span>--</span><span> </span><span>Parse.and_list1</span><span> </span><span class="main"><span>(</span></span><span>Parse.const</span><span> </span><span>--</span><span> </span><span>Parse.mixfix</span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>mode</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Local_Theory.notation_cmd</span><span> </span><span>true</span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>no_notation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"delete concrete syntax for constants / fixed variables"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.syntax_mode</span><span> </span><span>--</span><span> </span><span>Parse.and_list1</span><span> </span><span class="main"><span>(</span></span><span>Parse.const</span><span> </span><span>--</span><span> </span><span>Parse.mixfix</span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>mode</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Local_Theory.notation_cmd</span><span> </span><span>false</span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Theorems</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>long_keyword</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Parse_Spec.includes</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>K</span><span> </span><span class="inner_quoted"><span>""</span></span><span> </span><span>||</span><span>
  </span><span class="entity"><span>Parse_Spec.long_statement_keyword</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>long_statement</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.opt_thm_name</span></span><span> </span><span class="inner_quoted"><span>":"</span></span><span> </span><span>--|</span><span> </span><span>Scan.ahead</span><span> </span><span class="entity"><span>long_keyword</span></span><span class="main"><span>)</span></span><span> </span><span>Binding.empty_atts</span><span> </span><span>--</span><span>
  </span><span>Scan.optional</span><span> </span><span class="entity"><span>Parse_Spec.includes</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span>--</span><span> </span><span class="entity"><span>Parse_Spec.long_statement</span></span><span>
    </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>binding</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>includes</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>elems</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>concl</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>binding</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>includes</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>elems</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>concl</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>short_statement</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Parse_Spec.statement</span></span><span> </span><span>--</span><span> </span><span class="entity"><span>Parse_Spec.if_statement</span></span><span> </span><span>--</span><span> </span><span>Parse.for_fixes</span><span>
    </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>shows</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>assumes</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>fixes</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span>Binding.empty_atts</span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>Element.Fixes</span></span><span> </span><span class="entity"><span>fixes</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Element.Assumes</span></span><span> </span><span class="entity"><span>assumes</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Element.Shows</span></span><span> </span><span class="entity"><span>shows</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>theorem</span></span><span> </span><span class="entity"><span>spec</span></span><span> </span><span class="entity"><span>schematic</span></span><span> </span><span class="entity"><span>descr</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory_to_proof'</span></span><span> </span><span class="entity"><span>spec</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"state "</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>descr</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>long_statement</span></span><span> </span><span>||</span><span> </span><span class="entity"><span>short_statement</span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>long</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>binding</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>includes</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>elems</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>concl</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>schematic</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>Specification.schematic_theorem_cmd</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>Specification.theorem_cmd</span></span><span class="main"><span>)</span></span><span>
        </span><span class="entity"><span>long</span></span><span> </span><span>Thm.theoremK</span><span> </span><span>NONE</span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>I</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>binding</span></span><span> </span><span class="entity"><span>includes</span></span><span> </span><span class="entity"><span>elems</span></span><span> </span><span class="entity"><span>concl</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>theorem</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>theorem</span></span><span>›</span></span></span><span> </span><span>false</span><span> </span><span class="inner_quoted"><span>"theorem"</span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>theorem</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>lemma</span></span><span>›</span></span></span><span> </span><span>false</span><span> </span><span class="inner_quoted"><span>"lemma"</span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>theorem</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>corollary</span></span><span>›</span></span></span><span> </span><span>false</span><span> </span><span class="inner_quoted"><span>"corollary"</span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>theorem</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>proposition</span></span><span>›</span></span></span><span> </span><span>false</span><span> </span><span class="inner_quoted"><span>"proposition"</span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>theorem</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>schematic_goal</span></span><span>›</span></span></span><span> </span><span>true</span><span> </span><span class="inner_quoted"><span>"schematic goal"</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory'</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>lemmas</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"define theorems"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.name_facts</span></span><span> </span><span>--</span><span> </span><span>Parse.for_fixes</span><span> </span><span>&gt;&gt;</span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>facts</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>fixes</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span> </span><span>oo</span><span> </span><span class="entity"><span>Specification.theorems_cmd</span></span><span> </span><span>Thm.theoremK</span><span> </span><span class="entity"><span>facts</span></span><span> </span><span class="entity"><span>fixes</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory'</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>declare</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"declare theorems"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.and_list1</span><span> </span><span>Parse.thms1</span><span> </span><span>--</span><span> </span><span>Parse.for_fixes</span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>facts</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>fixes</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span> </span><span>oo</span><span> </span><span class="entity"><span>Specification.theorems_cmd</span></span><span> </span><span class="inner_quoted"><span>""</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span>Binding.empty_atts</span><span class="main"><span>,</span></span><span> </span><span>flat</span><span> </span><span class="entity"><span>facts</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>fixes</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>named_theorems</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"declare named collection of theorems"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.and_list1</span><span> </span><span class="main"><span>(</span></span><span>Parse.binding</span><span> </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span>Parse.embedded</span><span> </span><span class="inner_quoted"><span>""</span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span>
      </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>descr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>snd</span><span> </span><span>o</span><span> </span><span class="entity"><span>Named_Theorems.declare</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>descr</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Hide names</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>hide_names</span></span><span> </span><span class="entity"><span>command_keyword</span></span><span> </span><span class="entity"><span>what</span></span><span> </span><span class="entity"><span>hide</span></span><span> </span><span class="entity"><span>parse</span></span><span> </span><span class="entity"><span>prep</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="entity"><span>command_keyword</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"hide "</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>what</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>" from name space"</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Parse.opt_keyword</span><span> </span><span class="inner_quoted"><span>"open"</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>not</span><span class="main"><span>)</span></span><span> </span><span>--</span><span> </span><span>Scan.repeat1</span><span> </span><span class="entity"><span>parse</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>fully</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Proof_Context.init_global</span><span> </span><span class="entity"><span>thy</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>hide</span></span><span> </span><span class="entity"><span>fully</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>prep</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>hide_names</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>hide_class</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"classes"</span></span><span> </span><span>Sign.hide_class</span><span> </span><span>Parse.class</span><span>
    </span><span>Proof_Context.read_class</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>hide_names</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>hide_type</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"types"</span></span><span> </span><span>Sign.hide_type</span><span> </span><span>Parse.type_const</span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>#</span></span><span class="inner_numeral"><span>1</span></span><span> </span><span>o</span><span> </span><span>dest_Type</span><span class="main"><span>)</span></span><span> </span><span>oo</span><span> </span><span>Proof_Context.read_type_name</span><span> </span><span class="main"><span>{</span></span><span>proper</span><span> </span><span class="main"><span>=</span></span><span> </span><span>true</span><span class="main"><span>,</span></span><span> </span><span>strict</span><span> </span><span class="main"><span>=</span></span><span> </span><span>false</span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>hide_names</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>hide_const</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"consts"</span></span><span> </span><span>Sign.hide_const</span><span> </span><span>Parse.const</span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>#</span></span><span class="inner_numeral"><span>1</span></span><span> </span><span>o</span><span> </span><span>dest_Const</span><span class="main"><span>)</span></span><span> </span><span>oo</span><span> </span><span>Proof_Context.read_const</span><span> </span><span class="main"><span>{</span></span><span>proper</span><span> </span><span class="main"><span>=</span></span><span> </span><span>true</span><span class="main"><span>,</span></span><span> </span><span>strict</span><span> </span><span class="main"><span>=</span></span><span> </span><span>false</span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>hide_names</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>hide_fact</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"facts"</span></span><span> </span><span>Global_Theory.hide_fact</span><span>
    </span><span>Parse.name_position</span><span> </span><span class="main"><span>(</span></span><span>Global_Theory.check_fact</span><span> </span><span>o</span><span> </span><span>Proof_Context.theory_of</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Bundled declarations</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.maybe_begin_local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>bundle</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"define bundle of declarations"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Parse.binding</span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>--</span><span> </span><span>Parse.thms1</span><span> </span><span>--</span><span> </span><span>Parse.for_fixes</span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span>uncurry</span><span> </span><span class="entity"><span>Bundle.bundle_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.binding</span><span> </span><span>--|</span><span> </span><span>Parse.begin</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Bundle.init</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>unbundle</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"activate declarations from bundle in local theory"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span>Parse.name_position</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Bundle.unbundle_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>include</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"activate declarations from bundle in proof body"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span>Parse.name_position</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Bundle.include_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>including</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"activate declarations from bundle in goal refinement"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span>Parse.name_position</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Bundle.including_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_bundles</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print bundles of declarations"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Bundle.print_bundles</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Local theory specifications</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Specification context</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>context</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"begin local theory context"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Parse.name_position</span><span> </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span class="entity"><span>Parse_Spec.opening</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
        </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>incls</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.begin_main_target</span></span><span> </span><span>true</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Target_Context.context_begin_named_cmd</span></span><span> </span><span class="entity"><span>incls</span></span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>||</span><span>
      </span><span>Scan.optional</span><span> </span><span class="entity"><span>Parse_Spec.includes</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span>--</span><span> </span><span>Scan.repeat</span><span> </span><span class="entity"><span>Parse_Spec.context_element</span></span><span>
        </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>incls</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>elems</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.begin_nested_target</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Target_Context.context_begin_nested_cmd</span></span><span> </span><span class="entity"><span>incls</span></span><span> </span><span class="entity"><span>elems</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span>--|</span><span> </span><span>Parse.begin</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>end</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"end context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.exit</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.end_main_target</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.end_nested_target</span></span><span> </span><span>o</span><span>
        </span><span class="entity"><span>Toplevel.end_proof</span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="entity"><span>Proof.end_notepad</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Locales and interpretation</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>locale_context_elements</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Scan.repeat1</span><span> </span><span class="entity"><span>Parse_Spec.context_element</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>locale_val</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.locale_expression</span></span><span> </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span class="entity"><span>Parse_Spec.opening</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
    </span><span>||</span><span> </span><span class="entity"><span>Parse_Spec.opening</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>pair</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>+</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="entity"><span>locale_context_elements</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>
  </span><span>||</span><span> </span><span class="entity"><span>locale_context_elements</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>pair</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>locale</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"define named specification context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.binding</span><span> </span><span>--</span><span>
      </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="entity"><span>locale_val</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span>--</span><span> </span><span>Parse.opt_begin</span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>expr</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>includes</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>elems</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>begin</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="entity"><span>Toplevel.begin_main_target</span></span><span> </span><span class="entity"><span>begin</span></span><span>
            </span><span class="main"><span>(</span></span><span class="entity"><span>Expression.add_locale_cmd</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span>Binding.empty</span><span> </span><span class="entity"><span>includes</span></span><span> </span><span class="entity"><span>expr</span></span><span> </span><span class="entity"><span>elems</span></span><span> </span><span>#&gt;</span><span> </span><span>snd</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>experiment</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"open private specification context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat</span><span> </span><span class="entity"><span>Parse_Spec.context_element</span></span><span> </span><span>--|</span><span> </span><span>Parse.begin</span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>elems</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="entity"><span>Toplevel.begin_main_target</span></span><span> </span><span>true</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Experiment.experiment_cmd</span></span><span> </span><span class="entity"><span>elems</span></span><span> </span><span>#&gt;</span><span> </span><span>snd</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>interpret</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"prove interpretation of locale expression in proof context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.!!!</span><span> </span><span class="entity"><span>Parse_Spec.locale_expression</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>expr</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Interpretation.interpret_cmd</span></span><span> </span><span class="entity"><span>expr</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>interpretation_args_with_defs</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Parse.!!!</span><span> </span><span class="entity"><span>Parse_Spec.locale_expression</span></span><span> </span><span>--</span><span>
    </span><span class="main"><span>(</span></span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>defines</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.and_list1</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.opt_thm_name</span></span><span> </span><span class="inner_quoted"><span>":"</span></span><span>
      </span><span>--</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Parse.binding</span><span> </span><span>--</span><span> </span><span>Parse.opt_mixfix'</span><span class="main"><span>)</span></span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>--</span><span> </span><span>Parse.term</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory_to_proof</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>global_interpretation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"prove interpretation of locale expression into global theory"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>interpretation_args_with_defs</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>expr</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>defs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Interpretation.global_interpretation_cmd</span></span><span> </span><span class="entity"><span>expr</span></span><span> </span><span class="entity"><span>defs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>sublocale</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"prove sublocale relation between a locale and a locale expression"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Parse.name_position</span><span> </span><span>--|</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>⊆</span></span><span>›</span></span></span><span> </span><span>||</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>&lt;</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>--</span><span>
      </span><span class="entity"><span>interpretation_args_with_defs</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>loc</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>expr</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>defs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Toplevel.theory_to_proof</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Interpretation.global_sublocale_cmd</span></span><span> </span><span class="entity"><span>loc</span></span><span> </span><span class="entity"><span>expr</span></span><span> </span><span class="entity"><span>defs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span>||</span><span> </span><span class="entity"><span>interpretation_args_with_defs</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>expr</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>defs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Toplevel.local_theory_to_proof</span></span><span> </span><span>NONE</span><span> </span><span>NONE</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Interpretation.sublocale_cmd</span></span><span> </span><span class="entity"><span>expr</span></span><span> </span><span class="entity"><span>defs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>interpretation</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"prove interpretation of locale expression in local theory or into global theory"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.!!!</span><span> </span><span class="entity"><span>Parse_Spec.locale_expression</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>expr</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.local_theory_to_proof</span></span><span> </span><span>NONE</span><span> </span><span>NONE</span><span>
        </span><span class="main"><span>(</span></span><span class="entity"><span>Interpretation.isar_interpretation_cmd</span></span><span> </span><span class="entity"><span>expr</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Type classes</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>class_context_elements</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Scan.repeat1</span><span> </span><span class="entity"><span>Parse_Spec.context_element</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>class_val</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.class_expression</span></span><span> </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span class="entity"><span>Parse_Spec.opening</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
    </span><span>||</span><span> </span><span class="entity"><span>Parse_Spec.opening</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>pair</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
  </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>+</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="entity"><span>class_context_elements</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span>||</span><span>
  </span><span class="entity"><span>class_context_elements</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>pair</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>class</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"define type class"</span></span><span>
   </span><span class="main"><span>(</span></span><span>Parse.binding</span><span> </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span class="entity"><span>class_val</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span>--</span><span> </span><span>Parse.opt_begin</span><span>
    </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>supclasses</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>includes</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>elems</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>begin</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Toplevel.begin_main_target</span></span><span> </span><span class="entity"><span>begin</span></span><span>
          </span><span class="main"><span>(</span></span><span class="entity"><span>Class_Declaration.class_cmd</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="entity"><span>includes</span></span><span> </span><span class="entity"><span>supclasses</span></span><span> </span><span class="entity"><span>elems</span></span><span> </span><span>#&gt;</span><span> </span><span>snd</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory_to_proof</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>subclass</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"prove a subclass relation"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.class</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Class_Declaration.subclass_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>instantiation</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"instantiate and prove type arity"</span></span><span>
   </span><span class="main"><span>(</span></span><span>Parse.multi_arity</span><span> </span><span>--|</span><span> </span><span>Parse.begin</span><span>
     </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>arities</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.begin_main_target</span></span><span> </span><span>true</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Class.instantiation_cmd</span></span><span> </span><span class="entity"><span>arities</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>instance</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"prove type arity or subclass relation"</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Parse.class</span><span> </span><span>--</span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>⊆</span></span><span>›</span></span></span><span> </span><span>||</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>&lt;</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span>Parse.class</span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Class.classrel_cmd</span></span><span> </span><span>||</span><span>
    </span><span>Parse.multi_arity</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Class.instance_arity_cmd</span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Toplevel.theory_to_proof</span></span><span> </span><span>||</span><span>
    </span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.local_theory_to_proof</span></span><span> </span><span>NONE</span><span> </span><span>NONE</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Class.instantiation_instance</span></span><span> </span><span>I</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Arbitrary overloading</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>overloading</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"overloaded definitions"</span></span><span>
   </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span class="main"><span>(</span></span><span>Parse.name</span><span> </span><span>--|</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>==</span></span><span>›</span></span></span><span> </span><span>||</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>≡</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>--</span><span> </span><span>Parse.term</span><span> </span><span>--</span><span>
      </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>unchecked</span></span><span>›</span></span></span><span> </span><span>&gt;&gt;</span><span> </span><span>K</span><span> </span><span>false</span><span class="main"><span>)</span></span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>true</span><span>
      </span><span>&gt;&gt;</span><span> </span><span>Scan.triple1</span><span class="main"><span>)</span></span><span> </span><span>--|</span><span> </span><span>Parse.begin</span><span>
   </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>operations</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.begin_main_target</span></span><span> </span><span>true</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Overloading.overloading_cmd</span></span><span> </span><span class="entity"><span>operations</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Proof commands</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory_to_proof</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>notepad</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"begin proof context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.begin</span><span> </span><span>&gt;&gt;</span><span> </span><span>K</span><span> </span><span class="entity"><span>Proof.begin_notepad</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Statements</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>structured_statement</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Parse_Spec.statement</span></span><span> </span><span>--</span><span> </span><span class="entity"><span>Parse_Spec.cond_statement</span></span><span> </span><span>--</span><span> </span><span>Parse.for_fixes</span><span>
    </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>shows</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>strict</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>assumes</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>fixes</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>strict</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>fixes</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>assumes</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>shows</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>have</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"state local goal"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>structured_statement</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.proof'</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>int</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Proof.have_cmd</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>I</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>d</span></span><span> </span><span class="entity"><span>int</span></span><span> </span><span>#&gt;</span><span> </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>show</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"state local goal, to refine pending subgoals"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>structured_statement</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.proof'</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>int</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Proof.show_cmd</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>I</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>d</span></span><span> </span><span class="entity"><span>int</span></span><span> </span><span>#&gt;</span><span> </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>hence</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"old-style alias of \"then have\""</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>structured_statement</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.proof'</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>int</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Proof.chain</span></span><span> </span><span>#&gt;</span><span> </span><span class="entity"><span>Proof.have_cmd</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>I</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>d</span></span><span> </span><span class="entity"><span>int</span></span><span> </span><span>#&gt;</span><span> </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>thus</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"old-style alias of  \"then show\""</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>structured_statement</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.proof'</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>int</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Proof.chain</span></span><span> </span><span>#&gt;</span><span> </span><span class="entity"><span>Proof.show_cmd</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>I</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>d</span></span><span> </span><span class="entity"><span>int</span></span><span> </span><span>#&gt;</span><span> </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Local facts</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>facts</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Parse.and_list1</span><span> </span><span>Parse.thms1</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>then</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"forward chaining"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="entity"><span>Proof.chain</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>from</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"forward chaining from given facts"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>facts</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.from_thmss_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>with</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"forward chaining from given and current facts"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>facts</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.with_thmss_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>note</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"define facts"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.name_facts</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.note_thmss_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>supply</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"define facts during goal refinement (unstructured)"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.name_facts</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.supply_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>using</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"augment goal facts"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>facts</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.using_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>unfolding</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"unfold definitions in goal and facts"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>facts</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.unfolding_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Proof context</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>structured_statement</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Parse_Spec.statement</span></span><span> </span><span>--</span><span> </span><span class="entity"><span>Parse_Spec.if_statement'</span></span><span> </span><span>--</span><span> </span><span>Parse.for_fixes</span><span>
    </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>shows</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>assumes</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>fixes</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>fixes</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>assumes</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>shows</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>fix</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"fix local variables (Skolem constants)"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.vars</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.fix_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>assume</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"assume propositions"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>structured_statement</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Proof.assume_cmd</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>presume</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"assume propositions, to be established later"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>structured_statement</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Proof.presume_cmd</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>define</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"local definition (non-polymorphic)"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Parse.vars</span><span> </span><span>--|</span><span> </span><span>Parse.where_</span><span class="main"><span>)</span></span><span> </span><span>--</span><span> </span><span class="entity"><span>Parse_Spec.statement</span></span><span> </span><span>--</span><span> </span><span>Parse.for_fixes</span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Proof.define_cmd</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>consider</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"state cases rule"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.obtains</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof'</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Obtain.consider_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>obtain</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"generalized elimination"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.parbinding</span><span> </span><span>--</span><span> </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span>Parse.vars</span><span> </span><span>--|</span><span> </span><span>Parse.where_</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span>--</span><span> </span><span class="entity"><span>structured_statement</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>e</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.proof'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Obtain.obtain_cmd</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>d</span></span><span> </span><span class="entity"><span>e</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>let</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"bind text variables"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.and_list1</span><span> </span><span class="main"><span>(</span></span><span>Parse.and_list1</span><span> </span><span>Parse.term</span><span> </span><span>--</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>=</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.term</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.let_bind_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>write</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"add concrete syntax for constants / fixed variables"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.syntax_mode</span><span> </span><span>--</span><span> </span><span>Parse.and_list1</span><span> </span><span class="main"><span>(</span></span><span>Parse.const</span><span> </span><span>--</span><span> </span><span>Parse.mixfix</span><span class="main"><span>)</span></span><span>
    </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>mode</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Proof.write_cmd</span></span><span> </span><span class="entity"><span>mode</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>case</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"invoke local context"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.opt_thm_name</span></span><span> </span><span class="inner_quoted"><span>":"</span></span><span> </span><span>--</span><span>
      </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span>Parse.name_position</span><span> </span><span>--</span><span> </span><span>Scan.repeat</span><span> </span><span class="main"><span>(</span></span><span>Parse.maybe</span><span> </span><span>Parse.binding</span><span class="main"><span>)</span></span><span>
          </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span>||</span><span>
        </span><span>Parse.name_position</span><span> </span><span>&gt;&gt;</span><span> </span><span>rpair</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.case_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Proof structure</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>{</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"begin explicit proof block"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="entity"><span>Proof.begin_block</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>}</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"end explicit proof block"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="entity"><span>Proof.end_block</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>next</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"enter next proof block"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="entity"><span>Proof.next_block</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>End proof</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>qed</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"conclude proof"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.option</span><span> </span><span class="entity"><span>Method.parse</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
     </span><span class="main"><span>(</span></span><span>Option.map</span><span> </span><span class="entity"><span>Method.report</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>;</span></span><span>
      </span><span class="entity"><span>Isar_Cmd.qed</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>by</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"terminal backward proof"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Method.parse</span></span><span> </span><span>--</span><span> </span><span>Scan.option</span><span> </span><span class="entity"><span>Method.parse</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>m1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>m2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
     </span><span class="main"><span>(</span></span><span class="entity"><span>Method.report</span></span><span> </span><span class="entity"><span>m1</span></span><span class="main"><span>;</span></span><span>
      </span><span>Option.map</span><span> </span><span class="entity"><span>Method.report</span></span><span> </span><span class="entity"><span>m2</span></span><span class="main"><span>;</span></span><span>
      </span><span class="entity"><span>Isar_Cmd.terminal_proof</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>m1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>m2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>..</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"default proof"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="entity"><span>Isar_Cmd.default_proof</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>.</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"immediate proof"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="entity"><span>Isar_Cmd.immediate_proof</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>done</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"done proof"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="entity"><span>Isar_Cmd.done_proof</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>sorry</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"skip proof (quick-and-dirty mode only!)"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="entity"><span>Isar_Cmd.skip_proof</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>\&lt;proof&gt;</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"dummy proof (quick-and-dirty mode only!)"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="entity"><span>Isar_Cmd.skip_proof</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>oops</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"forget proof"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="entity"><span>Toplevel.forget_proof</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Proof steps</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>defer</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"shuffle internal proof state"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.optional</span><span> </span><span>Parse.nat</span><span> </span><span class="inner_numeral"><span>1</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.defer</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>prefer</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"shuffle internal proof state"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.nat</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof.prefer</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>apply</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"initial goal refinement step (unstructured)"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Method.parse</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Method.report</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>;</span></span><span> </span><span class="entity"><span>Toplevel.proofs</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Proof.apply</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>apply_end</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"terminal goal refinement step (unstructured)"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Method.parse</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Method.report</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>;</span></span><span> </span><span class="entity"><span>Toplevel.proofs</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Proof.apply_end</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>proof</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"backward proof step"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.option</span><span> </span><span class="entity"><span>Method.parse</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="main"><span>(</span></span><span>Option.map</span><span> </span><span class="entity"><span>Method.report</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>;</span></span><span>
       </span><span class="entity"><span>Toplevel.proof</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
         </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>state'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span>|&gt;</span><span> </span><span class="entity"><span>Proof.proof</span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span>|&gt;</span><span> </span><span>Seq.the_result</span><span> </span><span class="inner_quoted"><span>""</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
            </span><span>Output.information</span><span>
              </span><span class="main"><span>(</span></span><span>Proof_Context.print_cases_proof</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Proof.context_of</span></span><span> </span><span class="entity"><span>state</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Proof.context_of</span></span><span> </span><span class="entity"><span>state'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="entity"><span>state'</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Subgoal focus</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>opt_fact_binding</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span>Parse.binding</span><span> </span><span>--</span><span> </span><span>Parse.opt_attribs</span><span> </span><span>||</span><span> </span><span>Parse.attribs</span><span> </span><span>&gt;&gt;</span><span> </span><span>pair</span><span> </span><span>Binding.empty</span><span class="main"><span>)</span></span><span>
    </span><span>Binding.empty_atts</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>for_params</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Scan.optional</span><span>
    </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>for</span></span><span>›</span></span></span><span> </span><span>|--</span><span>
      </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Scan.option</span><span> </span><span>Parse.dots</span><span> </span><span>&gt;&gt;</span><span> </span><span>is_some</span><span class="main"><span>)</span></span><span> </span><span>--</span><span>
        </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span class="main"><span>(</span></span><span>Parse.maybe_position</span><span> </span><span>Parse.name_position</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>subgoal</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"focus on first subgoal within backward refinement"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>opt_fact_binding</span></span><span> </span><span>--</span><span> </span><span class="main"><span>(</span></span><span>Scan.option</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>premises</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="entity"><span>opt_fact_binding</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>--</span><span>
      </span><span class="entity"><span>for_params</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Toplevel.proofs</span></span><span> </span><span class="main"><span>(</span></span><span>Seq.make_results</span><span> </span><span>o</span><span> </span><span>Seq.single</span><span> </span><span>o</span><span> </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Subgoal.subgoal_cmd</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Calculation</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>calculation_args</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Scan.option</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Parse.thms1</span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>also</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"combine calculation and current facts"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>calculation_args</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proofs'</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Calculation.also_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>finally</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"combine calculation and current facts, exhibit result"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>calculation_args</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proofs'</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Calculation.finally_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>moreover</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"augment calculation by current facts"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof'</span></span><span> </span><span class="entity"><span>Calculation.moreover</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>ultimately</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"augment calculation by current facts, exhibit result"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.proof'</span></span><span> </span><span class="entity"><span>Calculation.ultimately</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_trans_rules</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print transitivity rules"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Calculation.print_rules</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Proof navigation</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>report_back</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Output.report</span><span> </span><span class="main"><span>[</span></span><span>Markup.markup</span><span> </span><span class="main"><span>(</span></span><span>Markup.bad</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="inner_quoted"><span>"Explicit backtracking"</span></span><span class="main"><span>]</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>back</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"explicit backtracking of proof command"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span>
     </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.actual_proof</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>prf</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>report_back</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="entity"><span>Proof_Node.back</span></span><span> </span><span class="entity"><span>prf</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>o</span><span>
      </span><span class="entity"><span>Toplevel.skip_proof</span></span><span> </span><span class="entity"><span>report_back</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Diagnostic commands (for interactive mode only)</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>opt_modes</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span>Parse.name</span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>help</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"retrieve outer syntax commands according to name patterns"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat</span><span> </span><span>Parse.name</span><span> </span><span>&gt;&gt;</span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>pats</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Outer_Syntax.help</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>pats</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_commands</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print outer syntax commands"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Outer_Syntax.print_commands</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.theory_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_options</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print configuration options"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Attrib.print_options</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_context</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print context of local theory target"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Pretty.writeln_chunks</span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.pretty_context</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_theory</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print logical theory contents"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Pretty.writeln</span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof_Display.pretty_theory</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_definitions</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print dependencies of definitional theory content"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Pretty.writeln</span><span> </span><span>o</span><span> </span><span class="entity"><span>Proof_Display.pretty_definitions</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_syntax</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print inner syntax of context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Proof_Context.print_syntax</span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_defn_rules</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print definitional rewrite rules of context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Local_Defs.print_rules</span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_abbrevs</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print constant abbreviations of context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Proof_Context.print_abbrevs</span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_theorems</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print theorems of local theory or proof context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Pretty.writeln</span><span> </span><span>o</span><span> </span><span>Pretty.chunks</span><span> </span><span>o</span><span> </span><span class="entity"><span>Isar_Cmd.pretty_theorems</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_locales</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print locales of this theory"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>verbose</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.theory_of</span></span><span> </span><span class="entity"><span>state</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>Pretty.writeln</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Locale.pretty_locales</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>verbose</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_classes</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print classes of this theory"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Class.print_classes</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_locale</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print locale of this theory"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>--</span><span> </span><span>Parse.name_position</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>show_facts</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>raw_name</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.theory_of</span></span><span> </span><span class="entity"><span>state</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Locale.check</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>raw_name</span></span><span class="main"><span>;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>Pretty.writeln</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Locale.pretty_locale</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>show_facts</span></span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_interps</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print interpretations of locale for this theory or proof context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.name_position</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>raw_name</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>state</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.theory_of</span></span><span> </span><span class="entity"><span>state</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Locale.check</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>raw_name</span></span><span class="main"><span>;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>Pretty.writeln</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Locale.pretty_registrations</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_attributes</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print attributes of this theory"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Attrib.print_attributes</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_simpset</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print context of Simplifier"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Pretty.writeln</span><span> </span><span>o</span><span> </span><span class="entity"><span>Simplifier.pretty_simpset</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_rules</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print intro/elim rules"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Context_Rules.print_rules</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_methods</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print methods of this theory"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Method.print_methods</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_antiquotations</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print document antiquotations"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Document_Antiquotation.print_antiquotations</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_ML_antiquotations</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print ML antiquotations"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>ML_Context.print_antiquotations</span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>locale_deps</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"visualize locale dependencies"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory_of</span></span><span> </span><span>#&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Locale.pretty_locale_deps</span></span><span> </span><span class="entity"><span>thy</span></span><span>
        </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>{</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>parents</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>body</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Graph_Display.content_node</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Locale.extern</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>body</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>parents</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
        </span><span>|&gt;</span><span> </span><span class="entity"><span>Graph_Display.display_graph_old</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_term_bindings</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print term bindings of proof context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span>
        </span><span class="main"><span>(</span></span><span>Pretty.writeln_chunks</span><span> </span><span>o</span><span> </span><span>Proof_Context.pretty_term_bindings</span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_facts</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print facts of proof context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Proof_Context.print_local_facts</span><span> </span><span class="entity"><span>b</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_cases</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print cases of proof context"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Pretty.writeln_chunks</span><span> </span><span>o</span><span> </span><span>Proof_Context.pretty_cases</span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_statement</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print theorems as long statements"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>opt_modes</span></span><span> </span><span>--</span><span> </span><span>Parse.thms1</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Isar_Cmd.print_stmts</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>thm</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print theorems"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>opt_modes</span></span><span> </span><span>--</span><span> </span><span>Parse.thms1</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Isar_Cmd.print_thms</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>prf</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print proof terms of theorems"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>opt_modes</span></span><span> </span><span>--</span><span> </span><span>Scan.option</span><span> </span><span>Parse.thms1</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Isar_Cmd.print_prfs</span></span><span> </span><span>false</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>full_prf</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print full proof terms of theorems"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>opt_modes</span></span><span> </span><span>--</span><span> </span><span>Scan.option</span><span> </span><span>Parse.thms1</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Isar_Cmd.print_prfs</span></span><span> </span><span>true</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>prop</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"read and print proposition"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>opt_modes</span></span><span> </span><span>--</span><span> </span><span>Parse.term</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Isar_Cmd.print_prop</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>term</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"read and print term"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>opt_modes</span></span><span> </span><span>--</span><span> </span><span>Parse.term</span><span> </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Isar_Cmd.print_term</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>typ</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"read and print type"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>opt_modes</span></span><span> </span><span>--</span><span> </span><span class="main"><span>(</span></span><span>Parse.typ</span><span> </span><span>--</span><span> </span><span>Scan.option</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>::</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.!!!</span><span> </span><span>Parse.sort</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>Isar_Cmd.print_type</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_codesetup</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print code generator setup"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Code.print_codesetup</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.theory_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_state</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print current proof state (if present)"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>opt_modes</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>modes</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span>Print_Mode.with_modes</span><span> </span><span class="entity"><span>modes</span></span><span> </span><span class="main"><span>(</span></span><span>Output.writeln</span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.string_of_state</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>welcome</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"print welcome message"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>writeln</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Session.welcome</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Dependencies</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>theory_bounds</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Parse.theory_name</span><span> </span><span>&gt;&gt;</span><span> </span><span>single</span><span> </span><span>||</span><span>
  </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.enum</span><span> </span><span class="inner_quoted"><span>"|"</span></span><span> </span><span>Parse.theory_name</span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>thy_deps</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"visualize theory dependencies"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.option</span><span> </span><span class="entity"><span>theory_bounds</span></span><span> </span><span>--</span><span> </span><span>Scan.option</span><span> </span><span class="entity"><span>theory_bounds</span></span><span> </span><span>&gt;&gt;</span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Thy_Deps.thy_deps_cmd</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>


</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>class_bounds</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Parse.sort</span><span> </span><span>&gt;&gt;</span><span> </span><span>single</span><span> </span><span>||</span><span>
  </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>(</span></span><span>›</span></span></span><span> </span><span>|--</span><span> </span><span>Parse.enum</span><span> </span><span class="inner_quoted"><span>"|"</span></span><span> </span><span>Parse.sort</span><span> </span><span>--|</span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword2"><span>)</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>class_deps</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"visualize class dependencies"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.option</span><span> </span><span class="entity"><span>class_bounds</span></span><span> </span><span>--</span><span> </span><span>Scan.option</span><span> </span><span class="entity"><span>class_bounds</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Class_Deps.class_deps_cmd</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>


</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>thm_deps</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print theorem dependencies (immediate non-transitive)"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.thms1</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.theory_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>Pretty.writeln</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Thm_Deps.pretty_thm_deps</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Attrib.eval_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>thm_oracles</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print all oracles used in theorems (full graph of transitive dependencies)"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.thms1</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Attrib.eval_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>;</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>Pretty.writeln</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Thm_Deps.pretty_thm_oracles</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy_names</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Scan.repeat1</span><span> </span><span class="main"><span>(</span></span><span>Scan.unless</span><span> </span><span>Parse.minus</span><span> </span><span>Parse.theory_name</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>unused_thms</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"find unused theorems"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.option</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>thy_names</span></span><span> </span><span>--|</span><span> </span><span>Parse.minus</span><span class="main"><span>)</span></span><span> </span><span>--</span><span> </span><span>Scan.option</span><span> </span><span class="entity"><span>thy_names</span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>opt_range</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.theory_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>;</span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>;</span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>pretty_thm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>th</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Proof_Context.pretty_fact</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>th</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>check</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Theory.check</span><span> </span><span class="main"><span>{</span></span><span>long</span><span> </span><span class="main"><span>=</span></span><span> </span><span>false</span><span class="main"><span>}</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
            </span><span class="entity"><span>Thm_Deps.unused_thms_cmd</span></span><span>
              </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>opt_range</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
                </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span>Theory.parents_of</span><span> </span><span class="entity"><span>thy</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thy</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
              </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><span>NONE</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="entity"><span>check</span></span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thy</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
              </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>ys</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="entity"><span>check</span></span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><span>map</span><span> </span><span class="entity"><span>check</span></span><span> </span><span class="entity"><span>ys</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
            </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="entity"><span>pretty_thm</span></span><span> </span><span>|&gt;</span><span> </span><span>Pretty.writeln_chunks</span><span>
          </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Find consts and theorems</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>find_consts</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"find constants by name / type patterns"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Find_Consts.query_parser</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>spec</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span>Pretty.writeln</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Find_Consts.pretty_consts</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>spec</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>options</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>Scan.optional</span><span>
    </span><span class="main"><span>(</span></span><span>Parse.$$$</span><span> </span><span class="inner_quoted"><span>"("</span></span><span> </span><span>|--</span><span>
      </span><span>Parse.!!!</span><span> </span><span class="main"><span>(</span></span><span>Scan.option</span><span> </span><span>Parse.nat</span><span> </span><span>--</span><span>
        </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span>Parse.reserved</span><span> </span><span class="inner_quoted"><span>"with_dups"</span></span><span> </span><span>&gt;&gt;</span><span> </span><span>K</span><span> </span><span>false</span><span class="main"><span>)</span></span><span> </span><span>true</span><span> </span><span>--|</span><span> </span><span>Parse.$$$</span><span> </span><span class="inner_quoted"><span>")"</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span>NONE</span><span class="main"><span>,</span></span><span> </span><span>true</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>find_theorems</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"find theorems meeting specified criteria"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>options</span></span><span> </span><span>--</span><span> </span><span class="entity"><span>Find_Theorems.query_parser</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>opt_lim</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>rem_dups</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>spec</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span>Pretty.writeln</span><span>
          </span><span class="main"><span>(</span></span><span class="entity"><span>Find_Theorems.pretty_theorems</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Find_Theorems.proof_state</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>opt_lim</span></span><span> </span><span class="entity"><span>rem_dups</span></span><span> </span><span class="entity"><span>spec</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Code generation</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>code_datatype</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"define set of code datatype constructors"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span>Parse.term</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Code.declare_datatype_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Extraction of programs from proofs</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>parse_vars</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Scan.optional</span><span> </span><span class="main"><span>(</span></span><span>Parse.$$$</span><span> </span><span class="inner_quoted"><span>"("</span></span><span> </span><span>|--</span><span> </span><span>Parse.list1</span><span> </span><span>Parse.name</span><span> </span><span>--|</span><span> </span><span>Parse.$$$</span><span> </span><span class="inner_quoted"><span>")"</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>realizers</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"specify realizers for primitive axioms / theorems, together with correctness proof"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span class="main"><span>(</span></span><span>Parse.name</span><span> </span><span>--</span><span> </span><span class="entity"><span>parse_vars</span></span><span> </span><span>--|</span><span> </span><span>Parse.$$$</span><span> </span><span class="inner_quoted"><span>":"</span></span><span> </span><span>--</span><span> </span><span>Parse.string</span><span> </span><span>--</span><span> </span><span>Parse.string</span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span>
     </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>xs</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Extraction.add_realizers</span></span><span>
       </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vs</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span>Global_Theory.get_thm</span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vs</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thy</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>realizability</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"add equations characterizing realizability"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span>Parse.string</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Extraction.add_realizes_eqns</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>extract_type</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"add equations characterizing type of extracted program"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span>Parse.string</span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Extraction.add_typeof_eqns</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>extract</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"extract terms from proofs"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Scan.repeat1</span><span> </span><span class="main"><span>(</span></span><span>Parse.name</span><span> </span><span>--</span><span> </span><span class="entity"><span>parse_vars</span></span><span class="main"><span>)</span></span><span> </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>xs</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>Extraction.extract</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>apfst</span><span> </span><span class="main"><span>(</span></span><span>Global_Theory.get_thm</span><span> </span><span class="entity"><span>thy</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thy</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Auxiliary lemmas</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Meta-level connectives in assumptions</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Pure.meta_mp|fact"><span class="entity_def" id="Pure.meta_mp|thm"><span>meta_mp</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>Q</span></span><span>›</span></span></span><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span>›</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Pure.meta_impE|fact"><span class="entity_def" id="Pure.meta_impE|thm"><span>meta_impE</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Pure.html#Pure.meta_mp|fact"><span>meta_mp</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>elim_format</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Pure.meta_spec|fact"><span class="entity_def" id="Pure.meta_spec|thm"><span>meta_spec</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Pure.meta_allE|fact"><span class="entity_def" id="Pure.meta_allE|thm"><span>meta_allE</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Pure.html#Pure.meta_spec|fact"><span>meta_spec</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>elim_format</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Pure.swap_params|fact"><span class="entity_def" id="Pure.swap_params|thm"><span>swap_params</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_49910..49915">lemma</span></span></span><span> </span><span class="entity_def" id="Pure.equal_allI|fact"><span class="entity_def" id="Pure.equal_allI|thm"><span>equal_allI</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Pure.html#offset_49910..49915"><span>that</span></a><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Meta-level conjunction</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Pure.all_conjunction|fact"><span class="entity_def" id="Pure.all_conjunction|thm"><span>all_conjunction</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_50163..50167">conj</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Pure.html#offset_50163..50167"><span>conj</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>conjunctionD1</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Pure.html#offset_50163..50167"><span>conj</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>conjunctionD2</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_50388..50392">conj</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Pure.html#offset_50388..50392"><span>conj</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><span>conjunctionD1</span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>rule_format</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Pure.html#offset_50388..50392"><span>conj</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><span>conjunctionD2</span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>rule_format</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Pure.imp_conjunction|fact"><span class="entity_def" id="Pure.imp_conjunction|thm"><span>imp_conjunction</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_50743..50747">conj</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Pure.html#offset_50743..50747"><span>conj</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span>›</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>conjunctionD1</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Pure.html#offset_50743..50747"><span>conj</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span>›</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>conjunctionD2</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_51009..51013">conj</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span>›</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Pure.html#offset_51009..51013"><span>conj</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><span>conjunctionD1</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span>›</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Pure.html#offset_51009..51013"><span>conj</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><span>conjunctionD2</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Pure.conjunction_imp|fact"><span class="entity_def" id="Pure.conjunction_imp|thm"><span>conjunction_imp</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_51359..51360">r</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_51400..51402">ab</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Pure.html#offset_51359..51360"><span>r</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Pure.html#offset_51400..51402"><span>ab</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_51514..51515">r</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_51553..51557">conj</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>&amp;&amp;&amp;</span></span><span> </span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>C</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Pure.html#offset_51514..51515"><span>r</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Pure.html#offset_51553..51557"><span>conj</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>conjunctionD1</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Pure.html#offset_51553..51557"><span>conj</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>PROP</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>conjunctionD2</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><span class="operator"><span>ML_write_global</span></span><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> </span><span class="quasi_keyword"><span>false</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>