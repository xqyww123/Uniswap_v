<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Uniswap_Pool</title>
</head>


<body>
<div class="head">
<h1>Theory Uniswap_Pool</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Uniswap_Pool.html"><span>Uniswap_Pool</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Uniswap_SwapMath.html"><span>Uniswap_SwapMath</span></a><span> </span><a href="Uniswap_Tick_Math.html"><span>Uniswap_Tick_Math</span></a><span> </span><a href="Uniswap_TickBitmap.html"><span>Uniswap_TickBitmap</span></a><span> </span><a href="Uniswap_Tick.html"><span>Uniswap_Tick</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>type_synonym</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.fee_protocol|type"><span>fee_protocol</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.arity_full_exhaustive_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.full_exhaustive_pool.simps|fact"><span class="entity_def" id="Uniswap_Pool.full_exhaustive_pool_inst.full_exhaustive_pool|fact"><span class="entity_def" id="Uniswap_Pool.arity_narrowing_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.narrowing_pool.simps|fact"><span class="entity_def" id="Uniswap_Pool.narrowing_pool_inst.narrowing_pool|fact"><span class="entity_def" id="Uniswap_Pool.arity_random_pool|fact"><span class="entity_def" id="Uniswap_Pool.random_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.random_pool_inst.random_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.random_aux.simps|fact"><span class="entity_def" id="Uniswap_Pool.random_aux_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.size_gen|fact"><span class="entity_def" id="Uniswap_Pool.pool.size|fact"><span class="entity_def" id="Uniswap_Pool.arity_size_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.size_pool_overloaded_def|fact"><span class="entity_def" id="Uniswap_Pool.size_pool_inst.size_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.size_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.simps|fact"><span class="entity_def" id="Uniswap_Pool.pool.rec_transfer|fact"><span class="entity_def" id="Uniswap_Pool.pool.rec|fact"><span class="entity_def" id="Uniswap_Pool.pool.induct|fact"><span class="entity_def" id="Uniswap_Pool.pool.case_transfer|fact"><span class="entity_def" id="Uniswap_Pool.pool.splits|fact"><span class="entity_def" id="Uniswap_Pool.pool.split_sels|fact"><span class="entity_def" id="Uniswap_Pool.pool.split_sel_asm|fact"><span class="entity_def" id="Uniswap_Pool.pool.split_sel|fact"><span class="entity_def" id="Uniswap_Pool.pool.split_asm|fact"><span class="entity_def" id="Uniswap_Pool.pool.split|fact"><span class="entity_def" id="Uniswap_Pool.pool.sel|fact"><span class="entity_def" id="Uniswap_Pool.pool.nchotomy|fact"><span class="entity_def" id="Uniswap_Pool.pool.inject|fact"><span class="entity_def" id="Uniswap_Pool.pool.expand|fact"><span class="entity_def" id="Uniswap_Pool.pool.exhaust_sel|fact"><span class="entity_def" id="Uniswap_Pool.pool.exhaust_disc|fact"><span class="entity_def" id="Uniswap_Pool.pool.exhaust|fact"><span class="entity_def" id="Uniswap_Pool.pool.disc_eq_case|fact"><span class="entity_def" id="Uniswap_Pool.pool.collapse|fact"><span class="entity_def" id="Uniswap_Pool.pool.case_eq_if|fact"><span class="entity_def" id="Uniswap_Pool.pool.case_distrib|fact"><span class="entity_def" id="Uniswap_Pool.pool.case_cong_weak|fact"><span class="entity_def" id="Uniswap_Pool.pool.case_cong|fact"><span class="entity_def" id="Uniswap_Pool.pool.case|fact"><span class="entity_def" id="Uniswap_Pool.pool.eq.simps|fact"><span class="entity_def" id="Uniswap_Pool.pool.eq.refl|fact"><span class="entity_def" id="Uniswap_Pool.arity_equal_pool|fact"><span class="entity_def" id="Uniswap_Pool.equal_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.equal_pool_inst.equal_pool|fact"><span class="entity_def" id="Uniswap_Pool.arity_partial_term_of_pool|fact"><span class="entity_def" id="Uniswap_Pool.partial_term_of_pool_triv|fact"><span class="entity_def" id="Uniswap_Pool.partial_term_of_pool_inst.partial_term_of_pool|fact"><span class="entity_def" id="Uniswap_Pool.arity_term_of_pool|fact"><span class="entity_def" id="Uniswap_Pool.term_of_pool_triv|fact"><span class="entity_def" id="Uniswap_Pool.term_of_pool_inst.term_of_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.protocol_fees_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.fee_protocol_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.growth_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.liquidity_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.unlocked_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.tick_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.price_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.case_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.ctor_rec_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.dtor_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.ctor_fold_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.ctor_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.arity_typerep_pool|fact"><span class="entity_def" id="Uniswap_Pool.typerep_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.typerep_pool_inst.typerep_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.Abs_pool_induct|fact"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool_induct|fact"><span class="entity_def" id="Uniswap_Pool.pool.Abs_pool_cases|fact"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool_cases|fact"><span class="entity_def" id="Uniswap_Pool.pool.Abs_pool_inject|fact"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool_inject|fact"><span class="entity_def" id="Uniswap_Pool.pool.Abs_pool_inverse|fact"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool_inverse|fact"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.type_definition_pool|fact"><span class="entity_def" id="Uniswap_Pool.arity_type_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.str_init_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.arity_typerep_pool_IITN_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_IITN_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_IITN_pool_inst.typerep_pool_IITN_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Abs_pool_IITN_pool_induct|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool_induct|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Abs_pool_IITN_pool_cases|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool_cases|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Abs_pool_IITN_pool_inject|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool_inject|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Abs_pool_IITN_pool_inverse|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool_inverse|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.type_definition_pool_IITN_pool|fact"><span class="entity_def" id="Uniswap_Pool.arity_type_pool_IITN_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.min_alg_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.mor_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.alg_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.set_pre_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.rel_pre_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.map_pre_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.arity_typerep_pool_pre_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_pre_pool_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_pre_pool_inst.typerep_pool_pre_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Abs_pool_pre_pool_induct|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool_induct|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Abs_pool_pre_pool_cases|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool_cases|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Abs_pool_pre_pool_inject|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool_inject|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Abs_pool_pre_pool_inverse|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool_inverse|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool|fact"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.type_definition_pool_pre_pool|fact"><span class="entity_def" id="Uniswap_Pool.arity_type_pool_pre_pool|fact"><span class="entity_def" id="Uniswap_Pool.arity_full_exhaustive_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.full_exhaustive_pool.simps|thm"><span class="entity_def" id="Uniswap_Pool.full_exhaustive_pool_inst.full_exhaustive_pool|thm"><span class="entity_def" id="Uniswap_Pool.arity_narrowing_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.narrowing_pool.simps|thm"><span class="entity_def" id="Uniswap_Pool.narrowing_pool_inst.narrowing_pool|thm"><span class="entity_def" id="Uniswap_Pool.arity_random_pool|thm"><span class="entity_def" id="Uniswap_Pool.random_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.random_pool_inst.random_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.random_aux.simps|thm"><span class="entity_def" id="Uniswap_Pool.random_aux_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.size_gen|thm"><span class="entity_def" id="Uniswap_Pool.pool.size(2)|thm"><span class="entity_def" id="Uniswap_Pool.pool.size(1)|thm"><span class="entity_def" id="Uniswap_Pool.arity_size_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.size_pool_overloaded_def|thm"><span class="entity_def" id="Uniswap_Pool.size_pool_inst.size_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.size_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.simps(3)|thm"><span class="entity_def" id="Uniswap_Pool.pool.simps(2)|thm"><span class="entity_def" id="Uniswap_Pool.pool.simps(1)|thm"><span class="entity_def" id="Uniswap_Pool.pool.rec_transfer|thm"><span class="entity_def" id="Uniswap_Pool.pool.rec|thm"><span class="entity_def" id="Uniswap_Pool.pool.induct|thm"><span class="entity_def" id="Uniswap_Pool.pool.case_transfer|thm"><span class="entity_def" id="Uniswap_Pool.pool.splits(2)|thm"><span class="entity_def" id="Uniswap_Pool.pool.splits(1)|thm"><span class="entity_def" id="Uniswap_Pool.pool.split_sels(2)|thm"><span class="entity_def" id="Uniswap_Pool.pool.split_sels(1)|thm"><span class="entity_def" id="Uniswap_Pool.pool.split_sel_asm|thm"><span class="entity_def" id="Uniswap_Pool.pool.split_sel|thm"><span class="entity_def" id="Uniswap_Pool.pool.split_asm|thm"><span class="entity_def" id="Uniswap_Pool.pool.split|thm"><span class="entity_def" id="Uniswap_Pool.pool.sel(7)|thm"><span class="entity_def" id="Uniswap_Pool.pool.sel(6)|thm"><span class="entity_def" id="Uniswap_Pool.pool.sel(5)|thm"><span class="entity_def" id="Uniswap_Pool.pool.sel(4)|thm"><span class="entity_def" id="Uniswap_Pool.pool.sel(3)|thm"><span class="entity_def" id="Uniswap_Pool.pool.sel(2)|thm"><span class="entity_def" id="Uniswap_Pool.pool.sel(1)|thm"><span class="entity_def" id="Uniswap_Pool.pool.nchotomy|thm"><span class="entity_def" id="Uniswap_Pool.pool.inject|thm"><span class="entity_def" id="Uniswap_Pool.pool.expand|thm"><span class="entity_def" id="Uniswap_Pool.pool.exhaust_sel|thm"><span class="entity_def" id="Uniswap_Pool.pool.exhaust_disc|thm"><span class="entity_def" id="Uniswap_Pool.pool.exhaust|thm"><span class="entity_def" id="Uniswap_Pool.pool.disc_eq_case|thm"><span class="entity_def" id="Uniswap_Pool.pool.collapse|thm"><span class="entity_def" id="Uniswap_Pool.pool.case_eq_if|thm"><span class="entity_def" id="Uniswap_Pool.pool.case_distrib|thm"><span class="entity_def" id="Uniswap_Pool.pool.case_cong_weak|thm"><span class="entity_def" id="Uniswap_Pool.pool.case_cong|thm"><span class="entity_def" id="Uniswap_Pool.pool.case|thm"><span class="entity_def" id="Uniswap_Pool.pool.eq.simps|thm"><span class="entity_def" id="Uniswap_Pool.pool.eq.refl|thm"><span class="entity_def" id="Uniswap_Pool.arity_equal_pool|thm"><span class="entity_def" id="Uniswap_Pool.equal_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.equal_pool_inst.equal_pool|thm"><span class="entity_def" id="Uniswap_Pool.arity_partial_term_of_pool|thm"><span class="entity_def" id="Uniswap_Pool.partial_term_of_pool_triv|thm"><span class="entity_def" id="Uniswap_Pool.partial_term_of_pool_inst.partial_term_of_pool|thm"><span class="entity_def" id="Uniswap_Pool.arity_term_of_pool|thm"><span class="entity_def" id="Uniswap_Pool.term_of_pool_triv|thm"><span class="entity_def" id="Uniswap_Pool.term_of_pool_inst.term_of_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.protocol_fees_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.fee_protocol_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.growth_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.liquidity_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.unlocked_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.tick_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.price_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.case_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.ctor_rec_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.dtor_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.ctor_fold_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.ctor_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.arity_typerep_pool|thm"><span class="entity_def" id="Uniswap_Pool.typerep_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.typerep_pool_inst.typerep_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.Abs_pool_induct|thm"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool_induct|thm"><span class="entity_def" id="Uniswap_Pool.pool.Abs_pool_cases|thm"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool_cases|thm"><span class="entity_def" id="Uniswap_Pool.pool.Abs_pool_inject|thm"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool_inject|thm"><span class="entity_def" id="Uniswap_Pool.pool.Abs_pool_inverse|thm"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool_inverse|thm"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.type_definition_pool|thm"><span class="entity_def" id="Uniswap_Pool.arity_type_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.str_init_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.arity_typerep_pool_IITN_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_IITN_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_IITN_pool_inst.typerep_pool_IITN_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Abs_pool_IITN_pool_induct|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool_induct|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Abs_pool_IITN_pool_cases|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool_cases|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Abs_pool_IITN_pool_inject|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool_inject|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Abs_pool_IITN_pool_inverse|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool_inverse|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.type_definition_pool_IITN_pool|thm"><span class="entity_def" id="Uniswap_Pool.arity_type_pool_IITN_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.min_alg_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.mor_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.alg_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.set_pre_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.rel_pre_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.map_pre_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.arity_typerep_pool_pre_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_pre_pool_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_pre_pool_inst.typerep_pool_pre_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Abs_pool_pre_pool_induct|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool_induct|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Abs_pool_pre_pool_cases|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool_cases|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Abs_pool_pre_pool_inject|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool_inject|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Abs_pool_pre_pool_inverse|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool_inverse|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool|thm"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.type_definition_pool_pre_pool|thm"><span class="entity_def" id="Uniswap_Pool.arity_type_pool_pre_pool|thm"><span class="entity_def" id="Uniswap_Pool.full_exhaustive_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.full_exhaustive_pool_inst.full_exhaustive_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.narrowing_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.narrowing_pool_inst.narrowing_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.random_pool_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.random_pool_inst.random_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.random_aux_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.size_pool_overloaded_def|axiom"><span class="entity_def" id="Uniswap_Pool.size_pool_inst.size_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.size_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.rec_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.equal_pool_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.equal_pool_inst.equal_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.partial_term_of_pool_triv_raw|axiom"><span class="entity_def" id="Uniswap_Pool.partial_term_of_pool_inst.partial_term_of_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.term_of_pool_triv_raw|axiom"><span class="entity_def" id="Uniswap_Pool.term_of_pool_inst.term_of_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.protocol_fees_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.pool.fee_protocol_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.pool.growth_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.pool.liquidity_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.pool.unlocked_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.pool.tick_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.pool.price_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.pool.case_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.ctor_rec_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.dtor_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.ctor_fold_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.ctor_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.typerep_pool_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.typerep_pool_inst.typerep_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.type_definition_pool|axiom"><span class="entity_def" id="Uniswap_Pool.arity_type_pool|axiom"><span class="entity_def" id="Uniswap_Pool.pool.str_init_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_IITN_pool_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_IITN_pool_inst.typerep_pool_IITN_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.type_definition_pool_IITN_pool|axiom"><span class="entity_def" id="Uniswap_Pool.arity_type_pool_IITN_pool|axiom"><span class="entity_def" id="Uniswap_Pool.pool.min_alg_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.mor_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.alg_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.wit_pre_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.pred_pre_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.rel_pre_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.set_pre_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.map_pre_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_pre_pool_def_raw|axiom"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_pre_pool_inst.typerep_pool_pre_pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.type_definition_pool_pre_pool|axiom"><span class="entity_def" id="Uniswap_Pool.arity_type_pool_pre_pool|axiom"><span class="entity_def" id="Uniswap_Pool.full_exhaustive_pool_inst.full_exhaustive_pool|const"><span class="entity_def" id="Uniswap_Pool.narrowing_pool_inst.narrowing_pool|const"><span class="entity_def" id="Uniswap_Pool.random_pool_inst.random_pool|const"><span class="entity_def" id="Uniswap_Pool.random_aux_pool|const"><span class="entity_def" id="Uniswap_Pool.size_pool_inst.size_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.size_pool|const"><span class="entity_def" id="Uniswap_Pool.equal_pool_inst.equal_pool|const"><span class="entity_def" id="Uniswap_Pool.partial_term_of_pool_inst.partial_term_of_pool|const"><span class="entity_def" id="Uniswap_Pool.term_of_pool_inst.term_of_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.case_pool|const"><span class="entity_def" id="Uniswap_Pool.typerep_pool_inst.typerep_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.Abs_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.Rep_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_IITN_pool_inst.typerep_pool_IITN_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Abs_pool_IITN_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool.Rep_pool_IITN_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.mor_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.alg_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.typerep_pool_pre_pool_inst.typerep_pool_pre_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Abs_pool_pre_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool.Rep_pool_pre_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.pool_IITN_pool|type"><span>datatype</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.pool.rec_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.ctor_rec_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.dtor_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.ctor_fold_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.ctor_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.str_init_pool|const"><span class="entity_def" id="Uniswap_Pool.pool.min_alg_pool|const"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.wit_pre_pool|const"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.pred_pre_pool|const"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.rel_pre_pool|const"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.set_pre_pool|const"><span class="entity_def" id="Uniswap_Pool.pre_pool.pool.map_pre_pool|const"><span class="entity_def" id="Uniswap_Pool.pool|type"><span class="entity_def" id="Uniswap_Pool.pool.pool_pre_pool|type"><span>pool</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity_def" id="Uniswap_Pool.pool.pool|const"><span>pool</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="entity"><span class="entity_def" id="Uniswap_Pool.pool.price|const"><span>price</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="entity"><span class="entity_def" id="Uniswap_Pool.pool.tick|const"><span>tick</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|type"><span>int</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="entity"><span class="entity_def" id="Uniswap_Pool.pool.unlocked|const"><span>unlocked</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="entity"><span class="entity_def" id="Uniswap_Pool.pool.liquidity|const"><span>liquidity</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span class="main"><span>)</span></span><span>
                     </span><span class="main"><span>(</span></span><span class="free"><span class="entity"><span class="entity_def" id="Uniswap_Pool.pool.growth|const"><span>growth</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth|type"><span>growth</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="entity"><span class="entity_def" id="Uniswap_Pool.pool.fee_protocol|const"><span>fee_protocol</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.fee_protocol|type"><span>fee_protocol</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="entity"><span class="entity_def" id="Uniswap_Pool.pool.protocol_fees|const"><span>protocol_fees</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.fee|type"><span>fee</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.fee|type"><span>fee</span></a><span>›</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>hide_const</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>open</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.price|const"><span>price</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.tick|const"><span>tick</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.unlocked|const"><span>unlocked</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.liquidity|const"><span>liquidity</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.growth|const"><span>growth</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.fee_protocol|const"><span>fee_protocol</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.protocol_fees|const"><span>protocol_fees</span></a><span>

</span><span class="keyword1"><span class="command"><span>setup</span></span></span><span> </span><span class="quoted"><span>‹</span><span>Sign.mandatory_path</span><span> </span><span class="inner_quoted"><span>"pool"</span></span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.pool.map_price_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_price_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.map_price_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span class="entity_def" id="Uniswap_Pool.pool.map_price|const"><span>map_price</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><span>of</span></span><span> pool </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.pool.map_price|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_price|thm"><span>map_price</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_price|const"><span>pool.map_price</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_price_def|fact"><span>pool.map_price_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.pool.map_tick_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_tick_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.map_tick_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span class="entity_def" id="Uniswap_Pool.pool.map_tick|const"><span>map_tick</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><span>of</span></span><span> pool </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.pool.map_tick|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_tick|thm"><span>map_tick</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_tick|const"><span>pool.map_tick</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_tick_def|fact"><span>pool.map_tick_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.pool.map_unlock_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_unlock_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.map_unlock_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span class="entity_def" id="Uniswap_Pool.pool.map_unlock|const"><span>map_unlock</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><span>of</span></span><span> pool </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.pool.map_unlock|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_unlock|thm"><span>map_unlock</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_unlock|const"><span>pool.map_unlock</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_unlock_def|fact"><span>pool.map_unlock_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.pool.map_liquidity_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_liquidity_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.map_liquidity_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span class="entity_def" id="Uniswap_Pool.pool.map_liquidity|const"><span>map_liquidity</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><span>of</span></span><span> pool </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.pool.map_liquidity|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_liquidity|thm"><span>map_liquidity</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_liquidity|const"><span>pool.map_liquidity</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_liquidity_def|fact"><span>pool.map_liquidity_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.pool.map_growth_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_growth_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.map_growth_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span class="entity_def" id="Uniswap_Pool.pool.map_growth|const"><span>map_growth</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><span>of</span></span><span> pool </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>gr</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.pool.map_growth|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_growth|thm"><span>map_growth</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_growth|const"><span>pool.map_growth</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>gr</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_growth_def|fact"><span>pool.map_growth_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.pool.map_fee_protocol_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_fee_protocol_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.map_fee_protocol_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span class="entity_def" id="Uniswap_Pool.pool.map_fee_protocol|const"><span>map_fee_protocol</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><span>of</span></span><span> pool </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>fp</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>pf</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.pool.map_fee_protocol|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_fee_protocol|thm"><span>map_fee_protocol</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_fee_protocol|const"><span>pool.map_fee_protocol</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>fp</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>pf</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_fee_protocol_def|fact"><span>pool.map_fee_protocol_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.pool.map_protocal_fees_def|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_protocal_fees_def|thm"><span class="entity_def" id="Uniswap_Pool.pool.map_protocal_fees_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span class="entity_def" id="Uniswap_Pool.pool.map_protocal_fees|const"><span>map_protocal_fees</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><span>of</span></span><span> pool </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="bound"><span>pf</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="bound"><span>fp</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>pf</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.pool.map_protocal_fees|fact"><span class="entity_def" id="Uniswap_Pool.pool.map_protocal_fees|thm"><span>map_protocal_fees</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_protocal_fees|const"><span>pool.map_protocal_fees</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="free"><span>pf</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>gr</span></span><span> </span><span class="free"><span>fp</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>pf</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_protocal_fees_def|fact"><span>pool.map_protocal_fees_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>setup</span></span></span><span> </span><span class="quoted"><span>‹</span><span>Sign.parent_path</span><span>›</span></span><span>

  

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/USER_HOME/Current/phi-system/Phi_Logic_Programming_Reasoner/library/reasoner.ML.html#Phi_Logic_Programming_Reasoner.\&lt;phi&gt;reason|attribute"><span class="operator"><span>φreason</span></span></a><span> 1000</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.Is_Literal|const"><span>Is_Literal</span></a><span> </span><span class="free"><span>fee</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.Is_Literal_def|fact"><span>Is_Literal_def</span></a><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>proc</span></span></span><span> </span><span class="main"><span>(</span></span><span>nodef</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Uniswap_Pool.fee_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.fee_\&lt;phi&gt;app|thm"><span>fee</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.\&lt;phi&gt;synthesis|attribute"><span class="operator"><span>φsynthesis</span></span></a><span> 1100</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>input</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Void|const"><span>Void</span></a><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>output</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.op_const_areal_\&lt;phi&gt;app|fact"><span>op_const_areal</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.Pool.axioms|fact"><span class="entity_def" id="Uniswap_Pool.Pool.intro|fact"><span class="entity_def" id="Uniswap_Pool.Pool_def|fact"><span class="entity_def" id="Uniswap_Pool.Pool_axioms.intro|fact"><span class="entity_def" id="Uniswap_Pool.Pool_axioms_def|fact"><span class="entity_def" id="Uniswap_Pool.Pool.axioms(3)|thm"><span class="entity_def" id="Uniswap_Pool.Pool.axioms(2)|thm"><span class="entity_def" id="Uniswap_Pool.Pool.axioms(1)|thm"><span class="entity_def" id="Uniswap_Pool.Pool.intro|thm"><span class="entity_def" id="Uniswap_Pool.Pool_def|thm"><span class="entity_def" id="Uniswap_Pool.Pool_axioms.intro|thm"><span class="entity_def" id="Uniswap_Pool.Pool_axioms_def|thm"><span class="entity_def" id="Uniswap_Pool.Pool_def|axiom"><span class="entity_def" id="Uniswap_Pool.Pool_axioms_def|axiom"><span>locale</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool|locale"><span class="entity_def" id="Uniswap_Pool.Pool|const"><span class="entity_def" id="Uniswap_Pool.Pool_axioms|const"><span>Pool</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Uniswap_TickBitmap.html#Uniswap_TickBitmap.Tickmap_spec|locale"><span>Tickmap_spec</span></a><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.Tick_spec|locale"><span>Tick_spec</span></a><span> </span><span class="main"><span>+</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.fiction|type"><span>fiction</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool|type"><span>pool</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;|type"><span>φ</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_get_pool_price</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc|type"><span>proc</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_set_pool_price</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc&apos;|type"><span>proc'</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_get_pool_tick</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc|type"><span>proc</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_set_pool_tick</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc&apos;|type"><span>proc'</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_get_pool_unlock</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc|type"><span>proc</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_set_pool_unlock</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc&apos;|type"><span>proc'</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_get_liquidity</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc|type"><span>proc</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_set_liquidity</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc&apos;|type"><span>proc'</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_get_fee_growth_0</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc|type"><span>proc</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_set_fee_growth_0</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc&apos;|type"><span>proc'</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_get_fee_growth_1</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc|type"><span>proc</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_set_fee_growth_1</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc&apos;|type"><span>proc'</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_get_fee_protocol_0</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc|type"><span>proc</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_get_fee_protocol_1</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc|type"><span>proc</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_get_protocal_fee_0</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc|type"><span>proc</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_set_protocal_fee_0</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc&apos;|type"><span>proc'</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_get_protocal_fee_1</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc|type"><span>proc</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>op_set_protocal_fee_1</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.proc&apos;|type"><span>proc'</span></a><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/USER_HOME/Current/phi-system/Phi_System/library/tools/inhabited_rule.ML.html#Phi_Preliminary.\&lt;phi&gt;inhabitance_rule|attribute"><span class="operator"><span>φinhabitance_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Imply|const"><span>𝗂𝗆𝗉𝗅𝗂𝖾𝗌</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Imply|const"><span>𝖺𝗇𝖽</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.price|const"><span>pool.price</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.tick|const"><span>pool.tick</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MIN_TICK|const"><span>MIN_TICK</span></a><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MAX_TICK|const"><span>MAX_TICK</span></a><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>
                           </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.price|const"><span>pool.price</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MIN_PRICE|const"><span>MIN_PRICE</span></a><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MAX_PRICE|const"><span>MAX_PRICE</span></a><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_price_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_price_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_3417..3436">get_pool_price_φapp</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.\&lt;phi&gt;synthesis|attribute"><span class="operator"><span>φsynthesis</span></span></a><span> 1000</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_get_pool_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.price|const"><span>pool.price</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_price_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_price_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_3538..3557">set_pool_price_φapp</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_set_pool_price</span></span><span> </span><span class="free"><span>rv</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>p'</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>𝗏𝖺𝗅[</span></a></span><span class="free"><span>rv</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_price|const"><span>pool.map_price</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_tick_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_tick_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_3663..3681">get_pool_tick_φapp</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.\&lt;phi&gt;synthesis|attribute"><span class="operator"><span>φsynthesis</span></span></a><span> 1000</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_get_pool_tick</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.tick|const"><span>pool.tick</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.Tick|const"><span>Tick</span></a><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_tick_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_tick_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_3784..3802">set_pool_tick_φapp</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_set_pool_tick</span></span><span> </span><span class="free"><span>ri</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>t'</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>𝗏𝖺𝗅[</span></a></span><span class="free"><span>ri</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>]</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.Tick|const"><span>Tick</span></a><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_tick|const"><span>pool.map_tick</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>t'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_unlock_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_unlock_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_3909..3929">get_pool_unlock_φapp</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_get_pool_unlock</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.unlocked|const"><span>pool.unlocked</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Generic_Boolean.html#PhiSem_Generic_Boolean.\&lt;phi&gt;Bool|const"><span>𝔹</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_unlock_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_unlock_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_4018..4038">set_pool_unlock_φapp</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_set_pool_unlock</span></span><span> </span><span class="free"><span>rb</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>𝗏𝖺𝗅[</span></a></span><span class="free"><span>rb</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Generic_Boolean.html#PhiSem_Generic_Boolean.\&lt;phi&gt;Bool|const"><span>𝔹</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_unlock|const"><span>pool.map_unlock</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>b'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_liquidity_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_liquidity_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_4146..4169">get_pool_liquidity_φapp</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.\&lt;phi&gt;synthesis|attribute"><span class="operator"><span>φsynthesis</span></span></a><span> 1000</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_get_liquidity</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.liquidity|const"><span>pool.liquidity</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_liquidity_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_liquidity_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_4274..4297">set_pool_liquidity_φapp</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_set_liquidity</span></span><span> </span><span class="free"><span>rv</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>l'</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>𝗏𝖺𝗅[</span></a></span><span class="free"><span>rv</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_liquidity|const"><span>pool.map_liquidity</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>l'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_fee_growth_0_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_fee_growth_0_\&lt;phi&gt;app|thm"><span>get_pool_fee_growth_0_φapp</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.\&lt;phi&gt;synthesis|attribute"><span class="operator"><span>φsynthesis</span></span></a><span> 1000</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_get_fee_growth_0</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee0|const"><span>growth.fee0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.growth|const"><span>pool.growth</span></a><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_fee_growth_0_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_fee_growth_0_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_4551..4577">set_pool_fee_growth_0_φapp</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_set_fee_growth_0</span></span><span> </span><span class="free"><span>rv</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>𝗏𝖺𝗅[</span></a></span><span class="free"><span>rv</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_growth|const"><span>pool.map_growth</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.map_fee0|const"><span>growth.map_fee0</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>c'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_fee_growth_1_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_fee_growth_1_\&lt;phi&gt;app|thm"><span>get_pool_fee_growth_1_φapp</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.\&lt;phi&gt;synthesis|attribute"><span class="operator"><span>φsynthesis</span></span></a><span> 1000</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_get_fee_growth_1</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee1|const"><span>growth.fee1</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.growth|const"><span>pool.growth</span></a><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_fee_growth_1_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_fee_growth_1_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_4849..4875">set_pool_fee_growth_1_φapp</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_set_fee_growth_1</span></span><span> </span><span class="free"><span>rv</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>𝗏𝖺𝗅[</span></a></span><span class="free"><span>rv</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_growth|const"><span>pool.map_growth</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.map_fee1|const"><span>growth.map_fee1</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>c'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.get_fee_protocol_0_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.get_fee_protocol_0_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_5002..5025">get_fee_protocol_0_φapp</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.\&lt;phi&gt;synthesis|attribute"><span class="operator"><span>φsynthesis</span></span></a><span> 1000</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_get_fee_protocol_0</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.fee_protocol|const"><span>pool.fee_protocol</span></a><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Int_ArbiPrec.html#PhiSem_Int_ArbiPrec.\&lt;phi&gt;ANat|const"><span>ℕ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.get_fee_protocol_1_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.get_fee_protocol_1_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_5144..5167">get_fee_protocol_1_φapp</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.\&lt;phi&gt;synthesis|attribute"><span class="operator"><span>φsynthesis</span></span></a><span> 1000</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_get_fee_protocol_1</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.fee_protocol|const"><span>pool.fee_protocol</span></a><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Int_ArbiPrec.html#PhiSem_Int_ArbiPrec.\&lt;phi&gt;ANat|const"><span>ℕ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_protocal_fee_0_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_protocal_fee_0_\&lt;phi&gt;app|thm"><span>get_pool_protocal_fee_0_φapp</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.\&lt;phi&gt;synthesis|attribute"><span class="operator"><span>φsynthesis</span></span></a><span> 1000</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_get_protocal_fee_0</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.protocol_fees|const"><span>pool.protocol_fees</span></a><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_protocal_fee_0_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_protocal_fee_0_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_5434..5462">set_pool_protocal_fee_0_φapp</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_set_protocal_fee_0</span></span><span> </span><span class="free"><span>rv</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>𝗏𝖺𝗅[</span></a></span><span class="free"><span>rv</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_protocal_fees|const"><span>pool.map_protocal_fees</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.apfst|const"><span>apfst</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>c'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_protocal_fee_1_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.get_pool_protocal_fee_1_\&lt;phi&gt;app|thm"><span>get_pool_protocal_fee_1_φapp</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning3.html#IDE_CP_Reasoning3.\&lt;phi&gt;synthesis|attribute"><span class="operator"><span>φsynthesis</span></span></a><span> 1000</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_get_protocal_fee_1</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.protocol_fees|const"><span>pool.protocol_fees</span></a><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_protocal_fee_1_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.set_pool_protocal_fee_1_\&lt;phi&gt;app|thm"><span class="entity_def" id="offset_5736..5764">set_pool_protocal_fee_1_φapp</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>op_set_protocal_fee_1</span></span><span> </span><span class="free"><span>rv</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>𝗏𝖺𝗅[</span></a></span><span class="free"><span>rv</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Val|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.map_protocal_fees|const"><span>pool.map_protocal_fees</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.apsnd|const"><span>apsnd</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>c'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> </span><span>›</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.Pool.Uniswap_Pool_def|fact"><span class="entity_def" id="Uniswap_Pool.Pool.Uniswap_Pool_def|thm"><span class="entity_def" id="Uniswap_Pool.Pool.Uniswap_Pool_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Uniswap_Pool.Pool.Uniswap_Pool.cong|fact"><span class="entity_def" id="Uniswap_Pool.Pool.Uniswap_Pool.cong|thm"><span class="entity_def" id="Uniswap_Pool.Pool.Uniswap_Pool|const"><span class="entity_def" id="offset_5904..5916">Uniswap_Pool</span></span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.fiction|type"><span>fiction</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.price|type"><span>price</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.tick|type"><span>tick</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.liquiditys|type"><span>liquiditys</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.liquiditys|type"><span>liquiditys</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growths|type"><span>growths</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.opt_growths|type"><span>opt_growths</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.fee_protocol|type"><span>fee_protocol</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.fee|type"><span>fee</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.fee|type"><span>fee</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;|type"><span>φ</span></a><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.\&lt;phi&gt;defs|attribute"><span class="operator"><span>φdefs</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>Uniswap_Pool</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span>
    </span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="keyword1"><span>of</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>price</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>unlocked</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>L</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>growth</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>δ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>fee_proto</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>protocol_fees</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span>
        </span><span class="comment1"><span>― ‹</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>growth›</span></span></span><span> is the abstract growth happened on every tick</span><span>›</span></span><span>
      </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="bound"><span>price</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>unlocked</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>L</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.gSum|const"><span>gSum</span></a><span> </span><span class="bound"><span>growth</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>fee_proto</span></span><span> </span><span class="bound"><span>protocol_fees</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
        </span><span class="comment1"><span>― ‹</span><span>so the global fee growth is the sum of the </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>growth›</span></span></span><span> over every tick</span><span>›</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>Lg</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Tickmap</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
        </span><span class="comment1"><span>― ‹</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>k ∈ dom δ›</span></span></span><span> means the tick </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>k›</span></span></span><span> is initialized</span><span>›</span></span><span>
      </span><span class="main"><span>(</span></span><span class="bound"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>L</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>growth</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>δ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>Ticks</span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Subjection|const"><span>𝗌𝗎𝖻𝗃</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="bound"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="bound"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.price_of|const"><span>price_of</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>)</span></span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/USER_HOME/Current/phi-system/Phi_Logic_Programming_Reasoner/library/reasoner.ML.html#Phi_Logic_Programming_Reasoner.\&lt;phi&gt;trace_reasoning|attribute"><span class="operator"><span>φtrace_reasoning</span></span></a><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> 1</span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/USER_HOME/Current/phi-system/Phi_Logic_Programming_Reasoner/library/reasoner.ML.html#Phi_Logic_Programming_Reasoner.\&lt;phi&gt;reason|attribute"><span class="operator"><span>φreason</span></span></a><span> 1200</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>price</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>unlocked</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>L</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>growth</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>δ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>fee_proto</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>protocol_fees</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_5904..5916"><span>Uniswap_Pool</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Imply|const"><span>𝗂𝗆𝗉𝗅𝗂𝖾𝗌</span></a></span><span>
   </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>price</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>unlocked</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>L</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.gSum|const"><span>gSum</span></a><span> </span><span class="free"><span>growth</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>fee_proto</span></span><span> </span><span class="free"><span>protocol_fees</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
   </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Lg</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Tickmap</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
   </span><span class="main"><span>(</span></span><span class="free"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>L</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>growth</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>δ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>Ticks</span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Imply|const"><span>𝖺𝗇𝖽</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="free"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.price_of|const"><span>price_of</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.Phi_Logic_Programming_Reasoner.html#Phi_Logic_Programming_Reasoner.Action_Tag|const"><span>@action</span></a></span><span> </span><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.to|const"><span>to</span></a><span> </span><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.RAW|const"><span>RAW</span></a><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.destruct\&lt;phi&gt;_\&lt;phi&gt;app|fact"><span>destructφ</span></a><span> </span><span class="quoted"><span class="main"><span>_</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/USER_HOME/Current/phi-system/Phi_Logic_Programming_Reasoner/library/reasoner.ML.html#Phi_Logic_Programming_Reasoner.\&lt;phi&gt;reason|attribute"><span class="operator"><span>φreason</span></span></a><span> 100</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.Phi_Logic_Programming_Reasoner.html#Phi_Logic_Programming_Reasoner.Normal_Premise|const"><span>𝗉𝗋𝖾𝗆𝗂𝗌𝖾</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="free"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.price_of|const"><span>price_of</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Imply|const"><span>𝗂𝗆𝗉𝗅𝗂𝖾𝗌</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="free"><span>price</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>unlocked</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>L</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.gSum|const"><span>gSum</span></a><span> </span><span class="free"><span>growth</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>fee_proto</span></span><span> </span><span class="free"><span>protocol_fees</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Pool</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
        </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Lg</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="free"><span>Tickmap</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
        </span><span class="main"><span>(</span></span><span class="free"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>L</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>growth</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>δ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>Ticks</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Remains|const"><span>𝗋𝖾𝗆𝖺𝗂𝗇𝗌</span></a></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Imply|const"><span>𝖺𝗇𝖽</span></a></span><span> </span><span class="free"><span>P</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Imply|const"><span>𝗂𝗆𝗉𝗅𝗂𝖾𝗌</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>price</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>unlocked</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>L</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>growth</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>δ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>fee_proto</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>protocol_fees</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_5904..5916"><span>Uniswap_Pool</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Remains|const"><span>𝗋𝖾𝗆𝖺𝗂𝗇𝗌</span></a></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Imply|const"><span>𝖺𝗇𝖽</span></a></span><span> </span><span class="free"><span>P</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.FOCUS_TAG_def|fact"><span>FOCUS_TAG_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> _ </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_7370..7371">I</span><span>
    </span><a class="entity_ref" href="Uniswap_Pool.html#offset_7370..7371"><span>I</span></a><span> 
    </span><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.construct\&lt;phi&gt;_\&lt;phi&gt;app|fact"><span>constructφ</span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>price</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>unlocked</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>L</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>growth</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>δ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>fee_proto</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>protocol_fees</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_5904..5916"><span>Uniswap_Pool</span></a><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.Invt_Ticks_def|fact"><span>Invt_Ticks_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.Invt_A_Tick_def|fact"><span>Invt_A_Tick_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Uniswap_Pool.Pool.\&lt;Delta&gt;protocal_fees_def|fact"><span class="entity_def" id="Uniswap_Pool.Pool.\&lt;Delta&gt;protocal_fees_def|thm"><span class="entity_def" id="Uniswap_Pool.Pool.\&lt;Delta&gt;protocal_fees_def_raw|axiom"><span class="entity_def" id="offset_7536..7546">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span class="entity_def" id="Uniswap_Pool.Pool.\&lt;Delta&gt;protocal_fees|const"><span>Δprotocal_fees</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>fee_proto</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>zeroForOne</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>L</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>price</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>price'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>γ</span></span></span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>zeroForOne</span></span></span></span><span>
       </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>fee_proto</span></span></span></span><span>
            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change|const"><span>reserve_change</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>zeroForOne</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>L</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>price</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>price'</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>fee_proto</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>
       </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>fee_proto</span></span></span></span><span>
            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change|const"><span>reserve_change</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>zeroForOne</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>L</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>price</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>price'</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>fee_proto</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>proc</span></span></span><span> </span><span class="entity_def" id="Uniswap_Pool.Pool.swap_\&lt;phi&gt;app|fact"><span class="entity_def" id="Uniswap_Pool.Pool.swap_def|fact"><span class="entity_def" id="Uniswap_Pool.Pool.swap.cong|fact"><span class="entity_def" id="Uniswap_Pool.Pool.swap_\&lt;phi&gt;app|thm"><span class="entity_def" id="Uniswap_Pool.Pool.swap_def|thm"><span class="entity_def" id="Uniswap_Pool.Pool.swap.cong|thm"><span class="entity_def" id="Uniswap_Pool.Pool.swap_def|axiom"><span class="entity_def" id="Uniswap_Pool.Pool.swap|const"><span>swap</span></span></span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>input</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>price</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>unlocked</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>L</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>growth</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>δ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>fee_protocol</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>protocol_fees</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_5904..5916"><span>Uniswap_Pool</span></a><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
         </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Generic_Boolean.html#PhiSem_Generic_Boolean.\&lt;phi&gt;Bool|const"><span>𝔹</span></a></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>amount_specified</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="free"><span>amount_specified</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>unlocked</span></span><span>›</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MIN_PRICE|const"><span>MIN_PRICE</span></a><span>
                         </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MAX_PRICE|const"><span>MAX_PRICE</span></a><span>›</span></span></span><span>
    </span><span class="comment1"><span>(</span><span>*</span><span>soon we will not need to declare these pre-conditions but verify that
        a revert will happen once they are violated</span><span>*</span><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>output</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="bound"><span>price'</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>i'</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>unlocked</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>L</span></span><span class="main"><span>,</span></span><span>
            </span><span class="free"><span>growth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth|const"><span>fee_growth</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="bound"><span>price'</span></span><span class="main"><span>,</span></span><span>
            </span><span class="free"><span>δ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>fee_protocol</span></span><span class="main"><span>,</span></span><span>
            </span><span class="free"><span>protocol_fees</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.Pool.\&lt;Delta&gt;protocal_fees|const"><span>Δprotocal_fees</span></a><span> </span><span class="free"><span>fee_protocol</span></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="bound"><span>price'</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_5904..5916"><span>Uniswap_Pool</span></a><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
          </span><span class="bound"><span>transfer_out</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="bound"><span>transfer_in</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗅</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span>
    </span><span class="keyword1"><span>𝗌𝗎𝖻𝗃</span></span><span> </span><span class="bound"><span>price'</span></span><span> </span><span class="bound"><span>i'</span></span><span> </span><span class="bound"><span>transfer_out</span></span><span> </span><span class="bound"><span>transfer_in</span></span><span class="main"><span>.</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>price'</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="bound"><span>price'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="bound"><span>price'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><span>(</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>amount_specified</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>amount_specified</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change|const"><span>reserve_change</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="bound"><span>price'</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span> </span><span class="free"><span>amount_specified</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change|const"><span>reserve_change</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="bound"><span>price'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="comment1"><span>― ‹</span><span>The resulted price either reaches the price limit, or, is the one having a reserve change
</span><span>             meeting the specified amount.
</span><span>          </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>reserve_change zeroForOne L price price'›</span></span></span><span> is the reserve change of token0 and token1
</span><span>             when the price is moving from </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>price›</span></span></span><span> to </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>price'›</span></span></span><span>›</span></span><span>
      </span><span class="comment1"><span>― ‹</span><span>The tick </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>i'›</span></span></span><span> is the one satisfying the global invariant encoded in </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#offset_5904..5916"><span>Uniswap_Pool</span></a><span>›</span></span><span>,
</span><span>          which is, </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>i'›</span></span></span><span> is the tick of the </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>price'›</span></span></span><span>, </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>price_of i' ≤ price ≤ price_of (i' + 1)›</span></span></span><span>›</span></span><span>
      </span><span class="comment1"><span>― ‹</span><span>Gross liquidity </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>Lg›</span></span></span><span>, actual liquidity </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>L›</span></span></span><span>, the absolute difference </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>δ›</span></span></span><span> in recorded fee growth,
</span><span>          and the proportion </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>fee_protocol›</span></span></span><span> of the protocol fee, are not changed</span><span>›</span></span><span>
      </span><span class="comment1"><span>― ‹</span><span>The fee growth </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>growth + fee_growth zeroForOne fee_rate' L price price'›</span></span></span><span>
</span><span>          and the </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>protocol_fees›</span></span></span><span> are increased accordingly.</span><span>›</span></span><span>
   </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>transfer_out</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change|const"><span>reserve_change</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="bound"><span>price'</span></span><span class="main"><span>)</span></span><span>
   </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>transfer_in</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change|const"><span>reserve_change</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="bound"><span>price'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>― ‹</span><span>As φ-system hasn't formalized transfer and external call, we cannot verify the last transfer operation
</span><span>      in the swap function, but only verify the amount of transfer-out and that of transfer-in.</span><span> ›</span></span><span>
</span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Routine.html#PhiSem_CF_Routine.routine|attribute"><span class="operator"><span>routine</span></span></a><span class="main"><span>]</span></span><span>
  </span><span class="comment1"><span>(</span><span>*</span><span> is [noDelegateCall]  Currently no modifier is supported, but is planned </span><span>*</span><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.D_\&lt;phi&gt;app|fact"><span>D</span></a><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
    </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Solidity.html#PhiSem_CF_Solidity.require_\&lt;phi&gt;app|fact"><span>require</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount_specified </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
    </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Solidity.html#PhiSem_CF_Solidity.require_\&lt;phi&gt;app|fact"><span>require</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#offset_3909..3929"><span>get_pool_unlock</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
    </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Solidity.html#PhiSem_CF_Solidity.require_\&lt;phi&gt;app|fact"><span>require</span></a><span> </span><span class="main"><span>(</span></span><span>
      </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.sel_\&lt;phi&gt;app|fact"><span>sel</span></a><span> </span><span class="main"><span>(</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>price_limit </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.price|const"><span>pool.price</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>$</span></span><span>price_limit </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MIN_PRICE|const"><span>MIN_PRICE</span></a><span>›</span></span></span><span class="main"><span>,</span></span><span>
            </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>price_limit </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.price|const"><span>pool.price</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>$</span></span><span>price_limit </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MAX_PRICE|const"><span>MAX_PRICE</span></a><span>›</span></span></span><span class="main"><span>,</span></span><span>
            </span><span class="main"><span>$</span></span><span>zeroForOne</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
    </span><a class="entity_ref" href="Uniswap_Pool.html#offset_4018..4038"><span>set_pool_unlock</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span>›</span></span></span><span class="main"><span>)</span></span><span>  </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_10841..10847">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>fee_proto</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>fee_proto</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span>fee_protocol</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="free"><span>fee_protocol</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
 
    </span><a class="entity_ref" href="Uniswap_Pool.html#offset_4146..4169"><span>get_pool_liquidity</span></a><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>liquidityStart</span></span><span>
    </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.sel_\&lt;phi&gt;app|fact"><span>sel</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#offset_5002..5025"><span>get_fee_protocol_0</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_5144..5167"><span>get_fee_protocol_1</span></a><span class="main"><span>,</span></span><span> </span><span class="main"><span>$</span></span><span>zeroForOne</span><span class="main"><span>)</span></span><span>
        </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="skolem"><span>fee_proto</span></span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>feeProtocol</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>secondsPerLiquidityCumulative</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>tickCumulative</span></span><span>

    </span><span class="comment1"><span>(</span><span>*</span><span> no blockTimestamp because we don't cover observation </span><span>*</span><span>)</span></span><span>

    </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount_specified </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>exactInput</span></span><span>

    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_11284..11290">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>I_fee_growth_global</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
      </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>⋀</span></span><span class="bound"><span>gr</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>I_fee_growth_global</span></span><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.global_fee0_growth|const"><span>global_fee0_growth</span></a><span> </span><span class="bound"><span>gr</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.global_fee1_growth|const"><span>global_fee1_growth</span></a><span> </span><span class="bound"><span>gr</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

    </span><span class="main"><span>$</span></span><span>amount_specified </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>var</span></span></span><span> </span><span class="skolem"><span>amount_remaining</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>var</span></span></span><span> </span><span class="skolem"><span>amount_calculated</span></span><span>
    </span><a class="entity_ref" href="Uniswap_Pool.html#offset_3417..3436"><span>get_pool_price</span></a><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>var</span></span></span><span> </span><span class="skolem"><span>price</span></span><span>
    </span><a class="entity_ref" href="Uniswap_Pool.html#offset_3663..3681"><span>get_pool_tick</span></a><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>var</span></span></span><span> </span><span class="skolem"><span>tick</span></span><span>
    </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.sel_\&lt;phi&gt;app|fact"><span>sel</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee0|const"><span>growth.fee0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.growth|const"><span>pool.growth</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee1|const"><span>growth.fee1</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.growth|const"><span>pool.growth</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="main"><span>$</span></span><span>zeroForOne</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>I_fee_growth_global</span></span><span> </span><span class="free"><span>growth</span></span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>var</span></span></span><span> </span><span class="skolem"><span>fee_growth_global</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>var</span></span></span><span> </span><span class="skolem"><span>protocolFee</span></span><span>
    </span><span class="main"><span>$</span></span><span>liquidityStart </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>var</span></span></span><span> </span><span class="skolem"><span>liquidity</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

    </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.while_\&lt;phi&gt;app|fact"><span>while</span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="bound"><span>ar</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>amount_remaining</span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
           </span><span class="bound"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>price</span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
           </span><span class="bound"><span>ac</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>amount_calculated</span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
           </span><span class="bound"><span>pf</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>protocolFee</span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
            </span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>tick</span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.Tick|const"><span>Tick</span></a><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
           </span><span class="free"><span>L</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>liquidity</span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
          </span><span class="skolem"><span>I_fee_growth_global</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>growth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth|const"><span>fee_growth</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="bound"><span>pr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>fee_growth_global</span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span>
          </span><span class="main"><span>(</span></span><span class="free"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>L</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>growth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth|const"><span>fee_growth</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="bound"><span>pr</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>δ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>Ticks</span><span>

        </span><span class="keyword1"><span>𝗌𝗎𝖻𝗃</span></span><span> </span><span class="bound"><span>ar</span></span><span> </span><span class="bound"><span>pr</span></span><span> </span><span class="bound"><span>ac</span></span><span> </span><span class="bound"><span>pf</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span>
          </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.Invariant|const"><span>Inv:</span></a></span><span> </span><span class="main"><span>(</span></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MIN_PRICE|const"><span>MIN_PRICE</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MAX_PRICE|const"><span>MAX_PRICE</span></a><span>
               </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MAX_TICK|const"><span>MAX_TICK</span></a><span>
               </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="bound"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="bound"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.price_of|const"><span>price_of</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
               </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span class="main"><span>)</span></span><span>
               </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Δreserve0</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Δreserve1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change|const"><span>reserve_change</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="bound"><span>pr</span></span><span class="main"><span>;</span></span><span>
                      </span><span class="bound"><span>amountIn</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="bound"><span>Δreserve0</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="bound"><span>Δreserve1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>;</span></span><span>
                      </span><span class="bound"><span>amountOut</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="bound"><span>Δreserve1</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="bound"><span>Δreserve0</span></span><span class="main"><span>)</span></span><span>
                   </span><span class="keyword1"><span>in</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>$</span></span><span>exactInput </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>amount_specified</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>amountIn</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>amount_specified</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>amountOut</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>ar</span></span><span>
                    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>$</span></span><span>exactInput </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span> </span><span class="bound"><span>amountOut</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="bound"><span>amountIn</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>ac</span></span><span>
                    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>fee_proto</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="bound"><span>amountIn</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="skolem"><span>fee_proto</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>pf</span></span><span>
               </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.Guard|const"><span>Guard:</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>ar</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount_remaining </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>$</span></span><span>price </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><span>$</span></span><span>price_limit</span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
      </span><span class="main"><span>$</span></span><span>price </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>step_price_start</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
      </span><span>nextInitializedTickWithinOneWord</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>tick</span><span class="main"><span>,</span></span><span> </span><span class="main"><span>$</span></span><span>zeroForOne</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∃</span></span><span class="skolem"><span>tick_next'</span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>var</span></span></span><span> </span><span class="skolem"><span>tick_next</span></span><span class="main"><span>,</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>initialized</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

      </span><span class="keyword3"><span class="command"><span>define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>tick_next</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.max|const"><span>max</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MIN_TICK|const"><span>MIN_TICK</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.min|const"><span>min</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MAX_TICK|const"><span>MAX_TICK</span></a><span> </span><span class="skolem"><span>tick_next'</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
 
      </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>tick_next </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MIN_TICK|const"><span>MIN_TICK</span></a><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
        </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MIN_TICK|const"><span>MIN_TICK</span></a><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> tick_next</span><span>
      </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>tick_next </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MAX_TICK|const"><span>MAX_TICK</span></a><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MAX_TICK|const"><span>MAX_TICK</span></a><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> tick_next</span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.as_\&lt;phi&gt;app|fact"><span>as</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.Tick|const"><span>Tick</span></a><span>›</span></span></span><span>
 
      </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?growth'</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>growth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth|const"><span>fee_growth</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>pr</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13651..13653">;;</span></span></span><span>

      </span><span class="main"><span>pure-fact</span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/USER_HOME/Current/phi-system/Phi_System/library/system/Phi_Envir.ML.html#IDE_CP_Core.useful|attribute"><span class="operator"><span>useful</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>pr</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_13706..13719">tick_next_dom</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MIN_TICK|const"><span>MIN_TICK</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>tick_next</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MAX_TICK|const"><span>MAX_TICK</span></a><span>›</span></span></span><span>
      
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>y0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>tick_next'</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.next_initialized|const"><span>next_initialized</span></a><span> </span><span class="free"><span>Lg</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="skolem"><span>tick_next'</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.next_initialized|const"><span>next_initialized</span></a><span> </span><span class="free"><span>Lg</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>tick_next'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan_iff|fact"><span>greaterThanLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.not_less_iff_gr_or_eq|fact"><span>not_less_iff_gr_or_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_less_le_trans|fact"><span>order_less_le_trans</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_13651..13653"><span>the_φ</span></a><span class="main"><span class="main"><span>(</span></span></span><span>15</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_13651..13653"><span>the_φlemmata</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
                  </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.dual_order.strict_trans1|fact"><span>dual_order.strict_trans1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost_iff|fact"><span>greaterThanAtMost_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_less_le|fact"><span>order_less_le</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_13651..13653"><span>the_φ</span></a><span class="main"><span class="main"><span>(</span></span></span><span>15</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_13651..13653"><span>the_φlemmata</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14120..14122">;;</span></span></span><span>

      </span><span class="main"><span>pure-fact</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.next_initialized|const"><span>next_initialized</span></a><span> </span><span class="free"><span>Lg</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.next_initialized|const"><span>next_initialized</span></a><span> </span><span class="free"><span>Lg</span></span><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>x1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>j</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>tick_next</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_14349..14351">t8</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>Lg</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_14421..14424">t8'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>Lg</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span>

      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>t7</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>⋀</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span>›</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_14580..14582">Ps</span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> k</span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_14349..14351"><span>t8</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_14580..14582"><span>Ps</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int_le_induct|fact"><span>int_le_induct</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> k</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>j</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> i</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>k</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_14580..14582"><span>Ps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_14580..14582"><span>Ps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_14120..14122"><span>the_φ</span></a><span class="main"><span class="main"><span>(</span></span></span><span>14</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>t11</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>⋀</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span>›</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_14820..14822">Ps</span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> k</span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_14421..14424"><span>t8'</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_14820..14822"><span>Ps</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int_ge_induct|fact"><span>int_ge_induct</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> k</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>j</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> i</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>k</span></span><span>›</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_14820..14822"><span>Ps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_14820..14822"><span>Ps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_14120..14122"><span>the_φ</span></a><span class="main"><span>(</span></span><span>14</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

      </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.getSqrtRatioAtTick_\&lt;phi&gt;app|fact"><span>getSqrtRatioAtTick</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>tick_next</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>step_price_next</span></span><span>

      </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.computeSwapStep_\&lt;phi&gt;app|fact"><span>computeSwapStep</span></a><span> </span><span class="main"><span>(</span></span><span>
        </span><span class="main"><span>$</span></span><span>price</span><span class="main"><span>,</span></span><span>
        </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.sel_\&lt;phi&gt;app|fact"><span>sel</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>price_limit</span><span class="main"><span>,</span></span><span> </span><span class="main"><span>$</span></span><span>step_price_next</span><span class="main"><span>,</span></span><span>
                </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.sel_\&lt;phi&gt;app|fact"><span>sel</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>step_price_next </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>$</span></span><span>price_limit</span><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>step_price_next </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><span>$</span></span><span>price_limit</span><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>$</span></span><span>zeroForOne</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
         </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.max|const"><span>max</span></a><span> </span><span class="main"><span>$</span></span><span>step_price_next </span><span class="free"><span>price_limit</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.min|const"><span>min</span></a><span> </span><span class="main"><span>$</span></span><span>step_price_next </span><span class="free"><span>price_limit</span></span><span>›</span></span></span><span class="main"><span>,</span></span><span>
        </span><span class="main"><span>$</span></span><span>liquidity</span><span class="main"><span>,</span></span><span>
        </span><span class="main"><span>$</span></span><span>amount_remaining</span><span class="main"><span>,</span></span><span>
        </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.fee_\&lt;phi&gt;app|fact"><span>fee</span></a><span>
      </span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∃</span></span><span class="skolem"><span>next_price</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>amountIn</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>amountOut</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>fee_amount</span></span><span>
      </span><span class="main"><span>→</span></span><span> price</span><span class="main"><span>,</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>amountIn</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>amountOut</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>feeAmount</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

      </span><span class="main"><span>pure-fact</span></span><span> </span><span class="entity_def" id="offset_15516..15518">d2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>fee_amount</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>amountIn</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span>›</span></span></span><span>

      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>d1</span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>amountIn</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>fee_amount</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>amountIn</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_threshold</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult_ac|fact"><span>ab_semigroup_mult_class.mult_ac</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_add_class.add.commute|fact"><span>add.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_ab_semigroup_add_class.add_diff_cancel_left&apos;|fact"><span>add_diff_cancel_left'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_comm_monoid_add_class.diff_cancel|fact"><span>cancel_comm_monoid_add_class.diff_cancel</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.comm_semiring_class.distrib|fact"><span>comm_semiring_class.distrib</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_15516..15518"><span>d2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_group_add_class.diff_add_eq|fact"><span>diff_add_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.group_add_class.diff_diff_eq2|fact"><span>diff_diff_eq2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_comm_monoid_add_class.diff_zero|fact"><span>diff_zero</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.semidom_divide_class.div_by_1|fact"><span>div_by_1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.field_class.divide_cancel_right|fact"><span>divide_cancel_right</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.field_class.divide_divide_eq_left|fact"><span>divide_divide_eq_left</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.division_ring_class.divide_divide_eq_left&apos;|fact"><span>divide_divide_eq_left'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.field_class.divide_divide_eq_right|fact"><span>divide_divide_eq_right</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.field_class.divide_eq_0_iff|fact"><span>divide_eq_0_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.divide_real_def|fact"><span>divide_real_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.division_ring_class.eq_divide_imp|fact"><span>eq_divide_imp</span></a><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate_range|fact"><span>fee_rate_range</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_not_le|fact"><span>linorder_not_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.group_add_class.minus_diff_eq|fact"><span>minus_diff_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.left_commute|fact"><span>mult.left_commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.monoid_mult_class.mult.right_neutral|fact"><span>mult.right_neutral</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.mult_1|fact"><span>mult_1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ring_1_no_zero_divisors_class.mult_cancel_left2|fact"><span>mult_cancel_left2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.semiring_no_zero_divisors_class.mult_eq_0_iff|fact"><span>mult_eq_0_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.mult_zero_class.mult_zero_left|fact"><span>mult_zero_left</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.mult_zero_class.mult_zero_right|fact"><span>mult_zero_right</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.nle_le|fact"><span>nle_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.field_class.nonzero_divide_mult_cancel_left|fact"><span>nonzero_divide_mult_cancel_left</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.semidom_divide_class.nonzero_mult_div_cancel_left|fact"><span>nonzero_mult_div_cancel_left</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_refl|fact"><span>order_refl</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/NthRoot.html#NthRoot.real_divide_square_eq|fact"><span>real_divide_square_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.comm_semiring_1_cancel_class.right_diff_distrib&apos;|fact"><span>right_diff_distrib'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ring_class.ring_distribs|fact"><span>ring_class.ring_distribs</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.field_class.times_divide_eq_left|fact"><span>times_divide_eq_left</span></a><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;_def|fact"><span>fee_rate'_def</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
  
      </span><span class="main"><span>pure-fact</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MIN_PRICE|const"><span>MIN_PRICE</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.max|const"><span>max</span></a><span> </span><span class="main"><span>$</span></span><span>step_price_next </span><span class="free"><span>price_limit</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.min|const"><span>min</span></a><span> </span><span class="main"><span>$</span></span><span>step_price_next </span><span class="free"><span>price_limit</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MIN_PRICE|const"><span>MIN_PRICE</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MAX_PRICE|const"><span>MAX_PRICE</span></a><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>pr</span></span><span>›</span></span></span><span> 
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.price_of|const"><span>price_of</span></a><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span> 
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.price_of|const"><span>price_of</span></a><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="skolem"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_17029..17031">p1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_17099..17101">p2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>amountIn</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>amountOut</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change_in_a_step|const"><span>reserve_change_in_a_step</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>L</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="skolem"><span>pr</span></span><span>
                               </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>amountOut</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>amountIn</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change_in_a_step|const"><span>reserve_change_in_a_step</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>L</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>pr</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>pr</span></span><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>pp2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>amountIn</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>pr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span>›</span></span></span><span> 
        
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>pp1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>amountIn</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="skolem"><span>pr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span>›</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.comm_monoid_mult_class.mult_1|fact"><span>comm_monoid_mult_class.mult_1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.divide_real_def|fact"><span>divide_real_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee0|fact"><span>growth.fee0</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_17029..17031"><span>p1</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_17099..17101"><span>p2</span></a><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change_in_a_step_def|fact"><span>reserve_change_in_a_step_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.comm_semiring_1_cancel_class.right_diff_distrib&apos;|fact"><span>right_diff_distrib'</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
        
      </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="main"><span>$</span></span><span>exactInput</span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
          </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount_remaining </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>amountIn </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>$</span></span><span>feeAmount</span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> amount_remaining
          </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount_calculated </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>$</span></span><span>amountOut</span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> amount_calculated</span><span>
      </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
          </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount_remaining </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>$</span></span><span>amountOut</span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> amount_remaining
          </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount_calculated </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>amountIn </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>$</span></span><span>feeAmount</span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> amount_calculated</span><span>
      </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>

      </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>feeProtocol </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
        </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>feeAmount </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>$</span></span><span>feeProtocol</span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>delta</span></span><span>
        </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>feeAmount </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>$</span></span><span>delta</span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> feeAmount
        </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>protocolFee </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>$</span></span><span>delta</span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> protocolFee</span><span>
      </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>

      </span><span class="keyword3"><span class="command"><span>define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>step_growth</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>step_growth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="skolem"><span>fee_amount</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Δgrowth</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>Δgrowth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth|const"><span>fee_growth</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>pr</span></span><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

      </span><span class="main"><span>pure-fact</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.global_fee0_growth|const"><span>global_fee0_growth</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth&apos;|const"><span>fee_growth'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="skolem"><span>pr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="skolem"><span>pr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.global_fee1_growth|const"><span>global_fee1_growth</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth&apos;|const"><span>fee_growth'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>pr</span></span><span> </span><span class="skolem"><span>next_price</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>pr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

      </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>liquidity </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
        </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>fee_growth_global </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>feeAmount </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>$</span></span><span>liquidity</span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> fee_growth_global</span><span>
      </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>I_fee_growth_global</span></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?growth'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>Δgrowth</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

      </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_18810..18816">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>real_next_tick</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>real_next_tick</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="skolem"><span>tick_next</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> 

      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>real_next_tick_dom</span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>real_next_tick</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>{</span></a></span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MIN_TICK|const"><span>MIN_TICK</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>..</span></a></span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MAX_TICK|const"><span>MAX_TICK</span></a><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>}</span></a></span><span>›</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_18810..18816"><span>real_next_tick_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_13706..13719"><span>tick_next_dom</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_13706..13719"><span>tick_next_dom</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

      </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>price </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>$</span></span><span>step_price_next</span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>

        </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="main"><span>$</span></span><span>initialized</span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>

          </span><span>tick_cross</span><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> Δ</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="skolem"><span>Δgrowth</span></span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>(</span></span><span>

            </span><span class="main"><span>$</span></span><span>tick_next</span><span class="main"><span>,</span></span><span>

            </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.sel_\&lt;phi&gt;app|fact"><span>sel</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>fee_growth_global</span><span class="main"><span>,</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee0|const"><span>growth.fee0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.growth|const"><span>pool.growth</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>$</span></span><span>zeroForOne</span><span class="main"><span>)</span></span><span>
              </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.global_fee0_growth|const"><span>global_fee0_growth</span></a><span> </span><span class="main"><span>(</span></span><span class="var"><span>?growth'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>Δgrowth</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>

            </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.sel_\&lt;phi&gt;app|fact"><span>sel</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee1|const"><span>growth.fee1</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.growth|const"><span>pool.growth</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>$</span></span><span>fee_growth_global</span><span class="main"><span>,</span></span><span> </span><span class="main"><span>$</span></span><span>zeroForOne</span><span class="main"><span>)</span></span><span>
              </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.global_fee1_growth|const"><span>global_fee1_growth</span></a><span> </span><span class="main"><span>(</span></span><span class="var"><span>?growth'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>Δgrowth</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
           </span><span class="main"><span>)</span></span><span>
           </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>var</span></span></span><span> </span><span class="skolem"><span>liquidityNet</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
            
            </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>_</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>Ticks</span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="var"><span>?growth'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>Δgrowth</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>real_next_tick</span></span><span class="main"><span>,</span></span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>

            </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="main"><span>$</span></span><span>zeroForOne</span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span> </span><span class="main"><span>$</span></span><span>liquidityNet</span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> liquidityNet</span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
              
              </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>liquidity </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>$</span></span><span>liquidityNet</span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="main"><span>$</span></span><span>liquidity </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>real_next_tick</span></span><span>›</span></span></span><span>

            </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>

              </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>liquidity</span><span class="main"><span>]</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>real_next_tick</span></span><span>›</span></span></span><span>

              </span><span>shift_current_tick_Δ</span><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> j</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>real_next_tick</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> Δ</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="skolem"><span>Δgrowth</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>

        </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.sel_\&lt;phi&gt;app|fact"><span>sel</span></a><span> </span><span class="main"><span>(</span></span><span>
          </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>tick_next </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>›</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.to_\&lt;phi&gt;app|fact"><span>to</span></a><span> </span><span class="quoted"><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.Tick|const"><span>Tick</span></a></span><span class="main"><span>,</span></span><span>
          </span><span class="main"><span>$</span></span><span>tick_next</span><span class="main"><span>,</span></span><span>
          </span><span class="main"><span>$</span></span><span>zeroForOne
        </span><span class="main"><span>)</span></span><span>
        </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>real_next_tick</span></span><span>›</span></span></span><span> </span><span class="main"><span>→</span></span><span> tick

        </span><span class="main"><span>pure-fact</span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>real_next_tick</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MAX_TICK|const"><span>MAX_TICK</span></a><span>›</span></span></span><span>

      </span><span class="keyword1"><span class="command"><span>❵</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>_</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Subjection|const"><span>𝗌𝗎𝖻𝗃</span></a></span><span> </span><span class="skolem"><span>real_next_tick</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MAX_TICK|const"><span>MAX_TICK</span></a><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
        </span><span class="main"><span>pure-fact</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>  </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>j</span></span><span>›</span></span></span><span> 
              </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span>
              </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>  </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span>
              </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>tick_next</span></span><span>›</span></span></span><span>
              </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

        </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>price </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><span>$</span></span><span>step_price_start</span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
          </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.getTickAtSqrtRatio_\&lt;phi&gt;app|fact"><span>getTickAtSqrtRatio</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>price</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>→</span></span><span> tick</span><span>
        </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

        </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>liquidity</span><span class="main"><span>]</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>L</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

        </span><span>shift_current_tick_Δ</span><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> j</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> Δ</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="skolem"><span>Δgrowth</span></span></span><span class="main"><span>]</span></span><span>
        
      </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>

      </span><span class="keyword3"><span class="command"><span>define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>real2_next_tick</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
        </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>real2_next_tick</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.price_of|const"><span>price_of</span></a><span> </span><span class="skolem"><span>tick_next</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="skolem"><span>real_next_tick</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

      </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>tick</span><span class="main"><span>]</span></span><span>›</span></span></span><span>      </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span>  </span><span class="quoted"><span class="skolem"><span>real2_next_tick</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
      </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>𝗏𝖺𝗋[</span></span><span>liquidity</span><span class="main"><span>]</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>real2_next_tick</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
      </span><span class="quoted"><span class="quoted"><span>‹</span><span>Ticks</span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>Lg</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>L</span></span><span class="main"><span>,</span></span><span> </span><span class="var"><span>?growth'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>Δgrowth</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>real2_next_tick</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>δ</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

      </span><span class="main"><span>pure-fact</span></span><span> </span><span class="entity_def" id="offset_21163..21166">Iv1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>real2_next_tick</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.MAX_TICK|const"><span>MAX_TICK</span></a><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_21213..21216">Iv2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MIN_PRICE|const"><span>MIN_PRICE</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.MAX_PRICE|const"><span>MAX_PRICE</span></a><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_21284..21287">Iv3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>real2_next_tick</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.price_of|const"><span>price_of</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>real2_next_tick</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_21396..21399">Iv4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>price</span></span><span>
                                    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>price_limit</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>      </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.Const_Interval|const"><span>Const_Interval</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>L</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="skolem"><span>pr</span></span><span>
                              </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.Const_Interval|const"><span>Const_Interval</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>L</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Tick_Math.html#Uniswap_Tick_Math.tick_of_price|const"><span>tick_of_price</span></a><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>pr</span></span><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_21746..21749">Iv6</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>amountIn</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>amountOut</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>pr</span></span><span> </span><span class="free"><span>price</span></span><span>
                                    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>next_price</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>pr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>amountOut</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>amountIn</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_22005..22008">Iv5</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="var"><span>?growth'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>Δgrowth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>growth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth|const"><span>fee_growth</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>next_price</span></span><span>›</span></span></span><span>
            

  </span><span class="keyword1"><span class="command"><span>❵</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><span>let</span></span><span> </span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="main"><span>_</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_21163..21166"><span>Iv1</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_21213..21216"><span>Iv2</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_21284..21287"><span>Iv3</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_21396..21399"><span>Iv4</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22005..22008"><span>Iv5</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_21746..21749"><span>Iv6</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_15516..15518"><span>d2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.division_ring_class.add_divide_distrib|fact"><span>add_divide_distrib</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.semiring_class.distrib_right|fact"><span>distrib_right</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>
    
    </span><span class="main"><span>∃</span></span><span class="skolem"><span>amount_remaining'</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>price'</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>amount_calculated'</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>proto_fee'</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i'</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

  </span><a class="entity_ref" href="Uniswap_Pool.html#offset_3784..3802"><span>set_pool_tick</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>tick</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="Uniswap_Pool.html#offset_3538..3557"><span>set_pool_price</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>price</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

  </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>liquidityStart </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><span>$</span></span><span>liquidity</span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_4274..4297"><span>set_pool_liquidity</span></a><span> </span><span class="main"><span>(</span></span><span> </span><span class="main"><span>$</span></span><span>liquidity </span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>i'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span>›</span></span></span><span>

  </span><span class="main"><span>pure-fact</span></span><span> </span><span class="entity_def" id="offset_22475..22485">proto_fee'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>proto_fee'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>fee_proto</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change|const"><span>reserve_change</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>price'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="skolem"><span>fee_proto</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_22655..22669">proto_fee'_LE0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>proto_fee'</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

  </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="main"><span>$</span></span><span>zeroForOne</span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_22709..22710">❴</span></span></span><span>

    </span><a class="entity_ref" href="Uniswap_Pool.html#offset_4551..4577"><span>set_pool_fee_growth_0</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>fee_growth_global</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.gSum|const"><span>gSum</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>growth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth|const"><span>fee_growth</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>price'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>certified</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod_eq_iff|fact"><span>prod_eq_iff</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.map_fee0_def|fact"><span>growth.map_fee0_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_11284..11290"><span>I_fee_growth_global_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee0_def|fact"><span>growth.fee0_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee1_def|fact"><span>growth.fee1_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22709..22710"><span>the_φ</span></a><span class="main"><span class="main"><span>(</span></span></span><span>15</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth_is_0_when_zeroForOne|fact"><span>fee_growth_is_0_when_zeroForOne</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee1_def|fact"><span>growth.fee1_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22709..22710"><span>the_φ</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22709..22710"><span>the_φ</span></a><span class="main"><span class="main"><span>(</span></span></span><span>15</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22709..22710"><span>the_φ</span></a><span class="main"><span class="main"><span>(</span></span></span><span>18</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

    </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>protocolFee </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_5434..5462"><span>set_pool_protocal_fee_0</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.protocol_fees|const"><span>pool.protocol_fees</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>$</span></span><span>protocolFee</span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>

   </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_23184..23185">❴</span></span></span><span>

    </span><a class="entity_ref" href="Uniswap_Pool.html#offset_4849..4875"><span>set_pool_fee_growth_1</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>$</span></span><span>fee_growth_global</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="skolem"><span>price'</span></span><span> </span><span class="skolem"><span>i'</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>i'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.gSum|const"><span>gSum</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>growth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth|const"><span>fee_growth</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>price'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>fee_protocol</span></span><span> </span><span class="free"><span>protocol_fees</span></span><span>›</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>certified</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod_eq_iff|fact"><span>prod_eq_iff</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.map_fee1_def|fact"><span>growth.map_fee1_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_11284..11290"><span>I_fee_growth_global_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee0_def|fact"><span>growth.fee0_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee1_def|fact"><span>growth.fee1_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_23184..23185"><span>the_φ</span></a><span class="main"><span class="main"><span>(</span></span></span><span>15</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>price</span></span><span>›</span></span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth_is_0_when_not_zeroForOne|fact"><span>fee_growth_is_0_when_not_zeroForOne</span></a><span> </span><a class="entity_ref" href="Uniswap_Common.html#Uniswap_Common.growth.fee0_def|fact"><span>growth.fee0_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_23184..23185"><span>the_φ</span></a><span class="main"><span class="main"><span>(</span></span></span><span>15</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_23184..23185"><span>the_φ</span></a><span class="main"><span class="main"><span>(</span></span></span><span>18</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>  </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

    </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>protocolFee </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_5736..5764"><span>set_pool_protocal_fee_1</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.protocol_fees|const"><span>pool.protocol_fees</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>$</span></span><span>protocolFee</span><span>›</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.pool.pool|const"><span>pool</span></a><span> </span><span class="skolem"><span>price'</span></span><span> </span><span class="skolem"><span>i'</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>i'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_Tick.html#Uniswap_Tick.gSum|const"><span>gSum</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>growth</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_growth|const"><span>fee_growth</span></a><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>price'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>fee_protocol</span></span><span>
           </span><span class="main"><span>(</span></span><span class="free"><span>protocol_fees</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#Uniswap_Pool.Pool.\&lt;Delta&gt;protocal_fees|const"><span>Δprotocal_fees</span></a><span> </span><span class="free"><span>fee_protocol</span></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>price'</span></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate&apos;|const"><span>fee_rate'</span></a><span class="main"><span>)</span></span><span>›</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>certified</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>protocol_fees</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_7536..7546"><span>Δprotocal_fees_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_10841..10847"><span>fee_proto_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22475..22485"><span>proto_fee'</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/HOL-Library.Product_Plus.html#Product_Plus.zero_prod_def|fact"><span>zero_prod_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_10841..10847"><span>fee_proto_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22475..22485"><span>proto_fee'</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22655..22669"><span>proto_fee'_LE0</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/HOL-Library.Product_Plus.html#Product_Plus.zero_prod_def|fact"><span>zero_prod_def</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_10841..10847"><span>fee_proto_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22475..22485"><span>proto_fee'</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22655..22669"><span>proto_fee'_LE0</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/HOL-Library.Product_Plus.html#Product_Plus.zero_prod_def|fact"><span>zero_prod_def</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_10841..10847"><span>fee_proto_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22475..22485"><span>proto_fee'</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22655..22669"><span>proto_fee'_LE0</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_10841..10847"><span>fee_proto_def</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22475..22485"><span>proto_fee'</span></a><span> </span><a class="entity_ref" href="Uniswap_Pool.html#offset_22655..22669"><span>proto_fee'_LE0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span class="keyword1"><span class="command"><span>;;</span></span></span><span>

  </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>zeroForOne </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>$</span></span><span>exactInput</span><span>›</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount_specified </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>$</span></span><span>amount_remaining</span><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>$</span></span><span>amount_calculated</span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="main"><span>$</span></span><span>amount_calculated</span><span class="main"><span>,</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount_specified </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>$</span></span><span>amount_remaining</span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> </span><span class="skolem"><span>amount0</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>amount1</span></span><span>
  
  </span><span class="main"><span>$</span></span><span>amount0 </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>price'</span></span><span> </span><span class="free"><span>price</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a><span class="main"><span>)</span></span><span>
                             </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>price'</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
           </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> amount0

  </span><span class="main"><span>$</span></span><span>amount1 </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>zeroForOne</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>price'</span></span><span> </span><span class="free"><span>price</span></span><span class="main"><span>)</span></span><span>
                             </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>price'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a><span class="main"><span>)</span></span><span>›</span></span></span><span>
           </span><span class="main"><span>→</span></span><span> </span><span class="keyword2"><span class="keyword"><span>val</span></span></span><span> amount1

  </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="main"><span>$</span></span><span>zeroForOne</span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount1 </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span class="main"><span>$</span></span><span>amount1</span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>price'</span></span><span> </span><span class="free"><span>price</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>

    </span><span class="main"><span>$</span></span><span>amount0 </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="skolem"><span>price'</span></span><span> </span><span class="free"><span>price</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics/PhiSem_CF_Basic.html#PhiSem_CF_Basic.if_\&lt;phi&gt;app|fact"><span>if</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>$</span></span><span>amount0 </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span class="main"><span>$</span></span><span>amount0</span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics/PhiSem_Real_Abst.html#PhiSem_Real_Abst.\&lt;phi&gt;AReal|const"><span>ℝ</span></a></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>price'</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>

    </span><span class="main"><span>$</span></span><span>amount1 </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/IDE_CP_Applications1.html#IDE_CP_Applications1.is_\&lt;phi&gt;app|fact"><span>is</span></a></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.reserve_change&apos;|const"><span>reserve_change'</span></a><span> </span><span class="free"><span>L</span></span><span> </span><span class="free"><span>price</span></span><span> </span><span class="skolem"><span>price'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="Uniswap_SwapMath.html#Uniswap_SwapMath.fee_rate|const"><span>fee_rate</span></a><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span>

  </span><a class="entity_ref" href="Uniswap_Pool.html#offset_4018..4038"><span>set_pool_unlock</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Generic_Boolean.html#PhiSem_Generic_Boolean.True_\&lt;phi&gt;app|fact"><span>True</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>❵.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre>
</body>

</html>